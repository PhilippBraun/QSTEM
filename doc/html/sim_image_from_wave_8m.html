<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>qstem: GUI_Matlab/simImageFromWave.m File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">qstem
   </div>
   <div id="projectbrief">multislice simulation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sim_image_from_wave_8m.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">simImageFromWave.m File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="sim_image_from_wave_8m_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4c8e7c568925ce5dd2b928882005e08d"><td class="memItemLeft" align="right" valign="top">objective <a class="el" href="sim_image_from_wave_8m.html#a3b69f23425e7c4d37f9381a15da540ee">aperture</a> <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a> <a class="el" href="virtual_goniometer_8m.html#a6b11865bcca154f476b9d05d1ac7a75b">set</a> very&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a4c8e7c568925ce5dd2b928882005e08d">large</a> (0.1A) Cs=0.6e7</td></tr>
<tr class="separator:a4c8e7c568925ce5dd2b928882005e08d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74335ae40bc4ffab9fc80d95fee97208"><td class="memItemLeft" align="right" valign="top"><a class="el" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a> <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a> (1mm=1e7A) 1.2mm SESAM Cc</td></tr>
<tr class="separator:a74335ae40bc4ffab9fc80d95fee97208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38bcf55414b93eac67018aee91bed97c"><td class="memItemLeft" align="right" valign="top">relative energy&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a38bcf55414b93eac67018aee91bed97c">spread</a> (0.4eV at 200kV) alpha=0.1e-3</td></tr>
<tr class="separator:a38bcf55414b93eac67018aee91bed97c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e567a6e32240aa0eaf37486cbd9a311"><td class="memItemLeft" align="right" valign="top">id&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a0e567a6e32240aa0eaf37486cbd9a311">Astig</a> ()</td></tr>
<tr class="separator:a0e567a6e32240aa0eaf37486cbd9a311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dc8886bf0ca02f39e3d5a76c0ebcaa4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a7dc8886bf0ca02f39e3d5a76c0ebcaa4">fprintf</a> ('Focal spread:%g A\n', <a class="el" href="sim_image_from_wave_8m.html#a38ade178ddc6a845e495916d25738bf2">Df</a>)</td></tr>
<tr class="separator:a7dc8886bf0ca02f39e3d5a76c0ebcaa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a656d5e61939acabefd422775c5d110f1"><td class="memItemLeft" align="right" valign="top">basis of&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a> (Scherzer) <a class="el" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a></td></tr>
<tr class="separator:a656d5e61939acabefd422775c5d110f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab711138fbc8d64d69b5316d62ba220f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ab711138fbc8d64d69b5316d62ba220f0">fprintf</a> ('dx:%g, dy:%g, thickness:%g\n', dX, dY, <a class="el" href="showimage_8m.html#ad941f6ef920fbfb3d75b60ddbedbdd39">t</a>)</td></tr>
<tr class="separator:ab711138fbc8d64d69b5316d62ba220f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97348fbfc3835d034b18d2a3ed5fe6ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a97348fbfc3835d034b18d2a3ed5fe6ee">if</a> (0)</td></tr>
<tr class="separator:a97348fbfc3835d034b18d2a3ed5fe6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa83fd3c6e35fb2262f9ed2134a4bfd41"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aa83fd3c6e35fb2262f9ed2134a4bfd41">imagesc</a> (dY *[0:<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1], dX *[0:<a class="el" href="showimage_8m.html#a5c7e4f16622600cb52580b191565e2dd">Nx</a>-1], <a class="el" href="fftw__allocator_8hpp.html#a3265f53b67af1612bd5c314cdce95c32">abs</a>(<a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a>))</td></tr>
<tr class="separator:aa83fd3c6e35fb2262f9ed2134a4bfd41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b69f23425e7c4d37f9381a15da540ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a3b69f23425e7c4d37f9381a15da540ee">aperture</a> (<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>&lt; kmax *kmax)</td></tr>
<tr class="separator:a3b69f23425e7c4d37f9381a15da540ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935ac73cb7bc7883eb826f6f1d5400a8"><td class="memItemLeft" align="right" valign="top">Save <a class="el" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a935ac73cb7bc7883eb826f6f1d5400a8">if</a> (1) <a class="el" href="qmb_8m.html#a7a230f02bdffebd1357e3c0b49e01271">fileName</a></td></tr>
<tr class="separator:a935ac73cb7bc7883eb826f6f1d5400a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf371cc06f10c0f6b7f9b77c506ca183"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#abf371cc06f10c0f6b7f9b77c506ca183">fprintf</a> ('Image%<a class="el" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>(<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>=%gnm): ', <a class="el" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a>, <a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>/10)</td></tr>
<tr class="separator:abf371cc06f10c0f6b7f9b77c506ca183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0fbb0f36386dc50c313aebc4694c81c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ad0fbb0f36386dc50c313aebc4694c81c">binwrite2D</a> (<a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a>, <a class="el" href="qmb_8m.html#a7a230f02bdffebd1357e3c0b49e01271">fileName</a>, 0, <a class="el" href="showimage_8m.html#ad941f6ef920fbfb3d75b60ddbedbdd39">t</a>)</td></tr>
<tr class="separator:ad0fbb0f36386dc50c313aebc4694c81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dded133f3736d53ec1c57e9ea9cc767"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qmb_8m.html#a2d9568f50e74214c48513c91bf8f143a">else</a> <a class="el" href="qmb_8m.html#ad589399858397b7c05877f34c359ed55">Display</a> <a class="el" href="image_sim_8m.html#aa9c57d86c53f86ed6afc6339a0476363">a</a> few&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a9dded133f3736d53ec1c57e9ea9cc767">imagesc</a> (dY *[0:<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1], dX *[0:<a class="el" href="showimage_8m.html#a5c7e4f16622600cb52580b191565e2dd">Nx</a>-1], <a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a>)</td></tr>
<tr class="separator:a9dded133f3736d53ec1c57e9ea9cc767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af56c95f61621bf9779137b38fcb3e0fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#af56c95f61621bf9779137b38fcb3e0fd">colormap</a> ('gray')</td></tr>
<tr class="separator:af56c95f61621bf9779137b38fcb3e0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3549364daae0112d3a892a326b72d359"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a3549364daae0112d3a892a326b72d359">title</a> (<a class="el" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>('<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>=%gnm', <a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>/10))</td></tr>
<tr class="separator:a3549364daae0112d3a892a326b72d359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa6eb6a7a4c5af057b011e096237df7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aaaa6eb6a7a4c5af057b011e096237df7">subplot</a> (2, 2, 2) <a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a></td></tr>
<tr class="separator:aaaa6eb6a7a4c5af057b011e096237df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a158106813601030227d9d5f4a634da7f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a> (1, 1)=0</td></tr>
<tr class="separator:a158106813601030227d9d5f4a634da7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a874549a590291be0eebb879a12b9ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a7a874549a590291be0eebb879a12b9ea">imagesc</a> (<a class="el" href="sim_image_from_wave_8m.html#a59650fdddef08cde1605e75fa4181c5e">dky</a> *[-<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1], <a class="el" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a> *[-<a class="el" href="showimage_8m.html#a5c7e4f16622600cb52580b191565e2dd">Nx</a>/2:<a class="el" href="showimage_8m.html#a5c7e4f16622600cb52580b191565e2dd">Nx</a>/2-1], log(1+<a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a>)))</td></tr>
<tr class="separator:a7a874549a590291be0eebb879a12b9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60baf35af99b5bbeefda8d670599dc61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a60baf35af99b5bbeefda8d670599dc61">title</a> ('Diffractogram')</td></tr>
<tr class="separator:a60baf35af99b5bbeefda8d670599dc61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5490bd91d39e9238e37ab49385f108d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ac5490bd91d39e9238e37ab49385f108d">xlim</a> ([-1.5 1.5]) <a class="el" href="qmb_8m.html#a3852c71c2302cdad168740b91d542b3a">ylim</a>([-1.5 1.5]) <a class="el" href="sim_image_from_wave_8m.html#aaaa6eb6a7a4c5af057b011e096237df7">subplot</a>(2</td></tr>
<tr class="separator:ac5490bd91d39e9238e37ab49385f108d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3341a2f8b0a2b23e6ee1c562cf5a0cc1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a3341a2f8b0a2b23e6ee1c562cf5a0cc1">plot</a> (<a class="el" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a> *[-<a class="el" href="showimage_8m.html#a5c7e4f16622600cb52580b191565e2dd">Nx</a>/2:<a class="el" href="showimage_8m.html#a5c7e4f16622600cb52580b191565e2dd">Nx</a>/2-1],[<a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="el" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:, 1)) <a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="el" href="image_sim_8m.html#ac6ccae1666df2c1024de02dcc9cc833e">Espat</a>(:, 1))...<a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(-<a class="el" href="fftw__allocator_8hpp.html#a4b67f0883b07b3e879fc8c8481e3d393">imag</a>(<a class="el" href="sim_image_from_wave_8m.html#a4805df3f93d2fd44d85d536abab5b7a8">chi</a>(:, 1))).*<a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="el" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:, 1)).*<a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="el" href="image_sim_8m.html#ac6ccae1666df2c1024de02dcc9cc833e">Espat</a>(:, 1))])</td></tr>
<tr class="separator:a3341a2f8b0a2b23e6ee1c562cf5a0cc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1726e1f9cd2d2130d723ffa5bab5eacf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a1726e1f9cd2d2130d723ffa5bab5eacf">legend</a> ('temporal coherence','spatial coherence', '<a class="el" href="image_sim_8m.html#a0bbe3bce7888733cdeb0db41e5b1dc36">CTF</a>') <a class="el" href="sim_image_from_wave_8m.html#ac5490bd91d39e9238e37ab49385f108d">xlim</a>([0 2])</td></tr>
<tr class="separator:a1726e1f9cd2d2130d723ffa5bab5eacf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44bef1002aae03ce551200278fa06223"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sim_image_from_wave_8m.html#aaaa6eb6a7a4c5af057b011e096237df7">subplot</a>(2, 2, 4) <a class="el" href="sim_image_from_wave_8m.html#a7a874549a590291be0eebb879a12b9ea">imagesc</a>(<a class="el" href="sim_image_from_wave_8m.html#a59650fdddef08cde1605e75fa4181c5e">dky</a> <br class="typebreak"/>
*[-<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a44bef1002aae03ce551200278fa06223">title</a> ('2D transfer function(Im[chi(q)])')</td></tr>
<tr class="separator:a44bef1002aae03ce551200278fa06223"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5afac14ac860987466647e55f28eca33"><td class="memItemLeft" align="right" valign="top">Through focus series <br class="typebreak"/>
reconstruction <a class="el" href="write_fields2_file_8m.html#a75658b9c899229893bf0bc9d90e97d93">file</a> <br class="typebreak"/>
throughFocus <a class="el" href="_read_d_m3___matlab_8m.html#a690da4f71682a3ad61fd1af8024eb5d3">m</a> format&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a5afac14ac860987466647e55f28eca33">compact</a></td></tr>
<tr class="separator:a5afac14ac860987466647e55f28eca33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa329f2975fbe76cfdf70a27f88bfc0ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aa329f2975fbe76cfdf70a27f88bfc0ef">saveMemory</a> = 2</td></tr>
<tr class="separator:aa329f2975fbe76cfdf70a27f88bfc0ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf03b9517092eee7dae1588bbc00e19"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aedf03b9517092eee7dae1588bbc00e19">directory</a> = 'sphere1'</td></tr>
<tr class="separator:aedf03b9517092eee7dae1588bbc00e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca36b09d6e71a60cfa3837d7e24c07ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a> = wavelength(300)</td></tr>
<tr class="separator:aca36b09d6e71a60cfa3837d7e24c07ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6d7970e73c00effe1d16e23142f11d"><td class="memItemLeft" align="right" valign="top">electron wavelength for beam <br class="typebreak"/>
energy Microscope&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#acb6d7970e73c00effe1d16e23142f11d">parameters</a></td></tr>
<tr class="separator:acb6d7970e73c00effe1d16e23142f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d779e6c55dd0a8494a4ca9ed8714204"><td class="memItemLeft" align="right" valign="top">Cc <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a2d779e6c55dd0a8494a4ca9ed8714204">A</a></td></tr>
<tr class="separator:a2d779e6c55dd0a8494a4ca9ed8714204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2e4fbe5e7c5462dea38bed93169e5b"><td class="memItemLeft" align="right" valign="top">astigmatism <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a6a2e4fbe5e7c5462dea38bed93169e5b">AstigPhi</a> = 30*pi/180</td></tr>
<tr class="separator:a6a2e4fbe5e7c5462dea38bed93169e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ade178ddc6a845e495916d25738bf2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="image_sim_8m.html#a0a2c0e3061e6dfed2bb93e1d6a220939">angle</a> of astigmatism&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a38ade178ddc6a845e495916d25738bf2">Df</a> = Cc*deltaE_E</td></tr>
<tr class="separator:a38ade178ddc6a845e495916d25738bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14a938158345bed28242803677a8212"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a></td></tr>
<tr class="separator:ac14a938158345bed28242803677a8212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6982f38ee9865914f2fb8226037bd3c8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a6982f38ee9865914f2fb8226037bd3c8">Nimg</a> = 20</td></tr>
<tr class="separator:a6982f38ee9865914f2fb8226037bd3c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a893e87b43fb9e0ad1de60d41fb3e338b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a893e87b43fb9e0ad1de60d41fb3e338b">plotFlag</a> = 1</td></tr>
<tr class="separator:a893e87b43fb9e0ad1de60d41fb3e338b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc3031161d6f3c3fa0a16037c4cfe71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a4fc3031161d6f3c3fa0a16037c4cfe71">waveName</a> = <a class="el" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>('%<a class="el" href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a>/<a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">wave.img</a>',<a class="el" href="sim_image_from_wave_8m.html#aedf03b9517092eee7dae1588bbc00e19">directory</a>)</td></tr>
<tr class="separator:a4fc3031161d6f3c3fa0a16037c4cfe71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa092e314c697a00facfe496a7779b61b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="scale_s_t_e_m_image_8m.html#a201589b538fc56729422d4773c8b0cfe">end</a> Add some carbon to the specimen&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aa092e314c697a00facfe496a7779b61b">surface</a></td></tr>
<tr class="separator:aa092e314c697a00facfe496a7779b61b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb3ac767ec1048cf315487da2b577ca4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a> = fft2(wave.*carbon)</td></tr>
<tr class="separator:acb3ac767ec1048cf315487da2b577ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae16de8b25c906d11f01b9f4d0b81a70b"><td class="memItemLeft" align="right" valign="top">define the reciprocal space&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ae16de8b25c906d11f01b9f4d0b81a70b">sampling</a></td></tr>
<tr class="separator:ae16de8b25c906d11f01b9f4d0b81a70b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59650fdddef08cde1605e75fa4181c5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a59650fdddef08cde1605e75fa4181c5e">dky</a> = 1/(<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*dY)</td></tr>
<tr class="separator:a59650fdddef08cde1605e75fa4181c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcbf6818ca1a5f06faf47e9f23063dc5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a> = <a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(kx.^2+ky.^2)</td></tr>
<tr class="separator:adcbf6818ca1a5f06faf47e9f23063dc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf40c223796354fb6b79c9ed047c513a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aaf40c223796354fb6b79c9ed047c513a">phi</a> = atan2(<a class="el" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a>,<a class="el" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a>)</td></tr>
<tr class="separator:aaf40c223796354fb6b79c9ed047c513a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac11faa037dc9050b7db352519f8f8440"><td class="memItemLeft" align="right" valign="top">clear <a class="el" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a> <a class="el" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ac11faa037dc9050b7db352519f8f8440">aperture</a> = <a class="el" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(<a class="el" href="qmb_8m.html#a34efcbeb95e7c3e7e0050034d30c01cd">size</a>(<a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a>))</td></tr>
<tr class="separator:ac11faa037dc9050b7db352519f8f8440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3d6bf79802fda5452b60a07bc8fc03"><td class="memItemLeft" align="right" valign="top">temporal coherence&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#acd3d6bf79802fda5452b60a07bc8fc03">envelope</a></td></tr>
<tr class="separator:acd3d6bf79802fda5452b60a07bc8fc03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b6b8e83430abf007f20aeae4dc2f74"><td class="memItemLeft" align="right" valign="top">all units <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a> = <a class="el" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a>+(<a class="el" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a>-1)*<a class="el" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a></td></tr>
<tr class="separator:a72b6b8e83430abf007f20aeae4dc2f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3d24876579c14d6de1789dcf8748b8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ab3d24876579c14d6de1789dcf8748b8e">defArray</a> = <a class="el" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a> + <a class="el" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a>*[0:<a class="el" href="sim_image_from_wave_8m.html#a6982f38ee9865914f2fb8226037bd3c8">Nimg</a>-1]</td></tr>
<tr class="separator:ab3d24876579c14d6de1789dcf8748b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedd72202f5fa11b5b301b347617895bb"><td class="memItemLeft" align="right" valign="top">additional images fro alignment for&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a></td></tr>
<tr class="separator:aedd72202f5fa11b5b301b347617895bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12a8932e3a6c30507e8db1e5f119806a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a12a8932e3a6c30507e8db1e5f119806a">Espat</a> = exp(-(pi*<a class="el" href="virtual_goniometer_8m.html#a62197192f0fbf4e0675eb37be1c4c175">alpha</a>*<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>+pi*<a class="el" href="virtual_goniometer_8m.html#a62197192f0fbf4e0675eb37be1c4c175">alpha</a>*<a class="el" href="wavelength_8m.html#ac74dc040fa5d0c030c0d25905d271f51">lambda</a>^2*Cs.*<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>).^2.*<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>)</td></tr>
<tr class="separator:a12a8932e3a6c30507e8db1e5f119806a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4805df3f93d2fd44d85d536abab5b7a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a4805df3f93d2fd44d85d536abab5b7a8">chi</a> = exp(-<a class="el" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi*(<a class="el" href="wavelength_8m.html#ac74dc040fa5d0c030c0d25905d271f51">lambda</a>*(<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>+Astig.*cos(2*(<a class="el" href="image_sim_8m.html#a06cb4ec95553375c06ca596fe1352937">phi</a>-<a class="el" href="sim_image_from_wave_8m.html#a6a2e4fbe5e7c5462dea38bed93169e5b">AstigPhi</a>))).*<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>+0.5*<a class="el" href="wavelength_8m.html#ac74dc040fa5d0c030c0d25905d271f51">lambda</a>^3*Cs.*k2.^2))</td></tr>
<tr class="separator:a4805df3f93d2fd44d85d536abab5b7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d0d51ceb4bc3bd26707520f257a5a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a86d0d51ceb4bc3bd26707520f257a5a4">img</a> = <a class="el" href="fftw__allocator_8hpp.html#a3265f53b67af1612bd5c314cdce95c32">abs</a>(ifft2(aperture.*wave.*chi.*Etemp.*<a class="el" href="image_sim_8m.html#ac6ccae1666df2c1024de02dcc9cc833e">Espat</a>)).^2+0.02*randn(<a class="el" href="qmb_8m.html#a34efcbeb95e7c3e7e0050034d30c01cd">size</a>(<a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a>))</td></tr>
<tr class="separator:a86d0d51ceb4bc3bd26707520f257a5a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96dd82fe30390e15166c14e3cb1e777"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qmb_8m.html#a2d9568f50e74214c48513c91bf8f143a">else</a> <a class="el" href="qmb_8m.html#ad589399858397b7c05877f34c359ed55">Display</a> <a class="el" href="image_sim_8m.html#aa9c57d86c53f86ed6afc6339a0476363">a</a> few&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#ae96dd82fe30390e15166c14e3cb1e777">figures</a></td></tr>
<tr class="separator:ae96dd82fe30390e15166c14e3cb1e777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeaa7ecdd726aa1950ba61dc659eb561"><td class="memItemLeft" align="right" valign="top">axis&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a></td></tr>
<tr class="separator:afeaa7ecdd726aa1950ba61dc659eb561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a71f5e406b211ed616173276484b78b"><td class="memItemLeft" align="right" valign="top">axis&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sim_image_from_wave_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a></td></tr>
<tr class="separator:a1a71f5e406b211ed616173276484b78b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a74335ae40bc4ffab9fc80d95fee97208"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a> <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> A </td>
          <td>(</td>
          <td class="paramtype">1mm&#160;</td>
          <td class="paramname"> = <code>1e7A</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3b69f23425e7c4d37f9381a15da540ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">aperture </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0e567a6e32240aa0eaf37486cbd9a311"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">id Astig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad0fbb0f36386dc50c313aebc4694c81c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">binwrite2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="qmb_8m.html#a7a230f02bdffebd1357e3c0b49e01271">fileName</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="showimage_8m.html#ad941f6ef920fbfb3d75b60ddbedbdd39">t</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af56c95f61621bf9779137b38fcb3e0fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">colormap </td>
          <td>(</td>
          <td class="paramtype">'gray'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a656d5e61939acabefd422775c5d110f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">basis of defocus </td>
          <td>(</td>
          <td class="paramtype">Scherzer&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7dc8886bf0ca02f39e3d5a76c0ebcaa4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fprintf </td>
          <td>(</td>
          <td class="paramtype">'Focal spread:%g A\n'&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sim_image_from_wave_8m.html#a38ade178ddc6a845e495916d25738bf2">Df</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab711138fbc8d64d69b5316d62ba220f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fprintf </td>
          <td>(</td>
          <td class="paramtype">'dx:%&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dy:%&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">thickness:%g\n'&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dX&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dY&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="showimage_8m.html#ad941f6ef920fbfb3d75b60ddbedbdd39">t</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abf371cc06f10c0f6b7f9b77c506ca183"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fprintf </td>
          <td>(</td>
          <td class="paramtype">'Image%<a class="el" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>(<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>=%gnm): '&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>/&#160;</td>
          <td class="paramname"><em>10</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a97348fbfc3835d034b18d2a3ed5fe6ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">if </td>
          <td>(</td>
          <td class="paramtype">0&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a935ac73cb7bc7883eb826f6f1d5400a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Save <a class="el" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a> if </td>
          <td>(</td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa83fd3c6e35fb2262f9ed2134a4bfd41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">imagesc </td>
          <td>(</td>
          <td class="paramtype">dY *&#160;</td>
          <td class="paramname">[0:Ny-1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dX *&#160;</td>
          <td class="paramname">[0:Nx-1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fftw__allocator_8hpp.html#a3265f53b67af1612bd5c314cdce95c32">abs</a>(<a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a>)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9dded133f3736d53ec1c57e9ea9cc767"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qmb_8m.html#a2d9568f50e74214c48513c91bf8f143a">else</a> <a class="el" href="qmb_8m.html#ad589399858397b7c05877f34c359ed55">Display</a> <a class="el" href="image_sim_8m.html#aa9c57d86c53f86ed6afc6339a0476363">a</a> few imagesc </td>
          <td>(</td>
          <td class="paramtype">dY *&#160;</td>
          <td class="paramname">[0:Ny-1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dX *&#160;</td>
          <td class="paramname">[0:Nx-1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7a874549a590291be0eebb879a12b9ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">imagesc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sim_image_from_wave_8m.html#a59650fdddef08cde1605e75fa4181c5e">dky</a> *&#160;</td>
          <td class="paramname">[-Ny/2:Ny/2-1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a> *&#160;</td>
          <td class="paramname">[-Nx/2:Nx/2-1], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">log(1+<a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">img</a>))&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a158106813601030227d9d5f4a634da7f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">img </td>
          <td>(</td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4c8e7c568925ce5dd2b928882005e08d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">objective <a class="el" href="sim_image_from_wave_8m.html#a3b69f23425e7c4d37f9381a15da540ee">aperture</a> <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a> <a class="el" href="virtual_goniometer_8m.html#a6b11865bcca154f476b9d05d1ac7a75b">set</a> very large </td>
          <td>(</td>
          <td class="paramtype">0.&#160;</td>
          <td class="paramname"><em>1A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1726e1f9cd2d2130d723ffa5bab5eacf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">legend </td>
          <td>(</td>
          <td class="paramtype">'temporal coherence'&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'spatial coherence'&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'<a class="el" href="image_sim_8m.html#a0bbe3bce7888733cdeb0db41e5b1dc36">CTF</a>'&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3341a2f8b0a2b23e6ee1c562cf5a0cc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a> *&#160;</td>
          <td class="paramname">[-Nx/2:Nx/2-1]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a38bcf55414b93eac67018aee91bed97c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">relative energy spread </td>
          <td>(</td>
          <td class="paramtype">0.4eV at&#160;</td>
          <td class="paramname"><em>200kV</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aaaa6eb6a7a4c5af057b011e096237df7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subplot </td>
          <td>(</td>
          <td class="paramtype">2&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">2&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">2&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3549364daae0112d3a892a326b72d359"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">title </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>('<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>=%gnm', <a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>/10)&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a60baf35af99b5bbeefda8d670599dc61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">title </td>
          <td>(</td>
          <td class="paramtype">'Diffractogram'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a44bef1002aae03ce551200278fa06223"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sim_image_from_wave_8m.html#aaaa6eb6a7a4c5af057b011e096237df7">subplot</a> (2,2,4) <a class="el" href="sim_image_from_wave_8m.html#a7a874549a590291be0eebb879a12b9ea">imagesc</a>(<a class="el" href="sim_image_from_wave_8m.html#a59650fdddef08cde1605e75fa4181c5e">dky</a>*[-<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2 title </td>
          <td>(</td>
          <td class="paramtype">'2D transfer function(Im[chi(q)])'&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac5490bd91d39e9238e37ab49385f108d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">xlim </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a2d779e6c55dd0a8494a4ca9ed8714204"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Cc <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> A</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= 1e7A</div>
<div class="line">deltaE_E = 0.8/300<a class="code" href="qmb_8m.html#ada985816ea79ac4451f0f552d48090e5">e3</a></div>
<div class="ttc" id="qmb_8m_html_ada985816ea79ac4451f0f552d48090e5"><div class="ttname"><a href="qmb_8m.html#ada985816ea79ac4451f0f552d48090e5">e3</a></div><div class="ttdeci">hObject, eventdata, handles e3()</div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00016">16</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="ac11faa037dc9050b7db352519f8f8440"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">clear <a class="el" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a> <a class="el" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a> aperture = <a class="el" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(<a class="el" href="qmb_8m.html#a34efcbeb95e7c3e7e0050034d30c01cd">size</a>(<a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00057">57</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a6a2e4fbe5e7c5462dea38bed93169e5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">astigmatism <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a> AstigPhi = 30*pi/180</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00020">20</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a4805df3f93d2fd44d85d536abab5b7a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">chi = exp(-<a class="el" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi*(<a class="el" href="wavelength_8m.html#ac74dc040fa5d0c030c0d25905d271f51">lambda</a>*(<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>+Astig.*cos(2*(<a class="el" href="image_sim_8m.html#a06cb4ec95553375c06ca596fe1352937">phi</a>-<a class="el" href="sim_image_from_wave_8m.html#a6a2e4fbe5e7c5462dea38bed93169e5b">AstigPhi</a>))).*<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>+0.5*<a class="el" href="wavelength_8m.html#ac74dc040fa5d0c030c0d25905d271f51">lambda</a>^3*Cs.*k2.^2))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00070">70</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a5afac14ac860987466647e55f28eca33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Through focus series reconstruction <a class="el" href="write_fields2_file_8m.html#a75658b9c899229893bf0bc9d90e97d93">file</a> throughFocus <a class="el" href="_read_d_m3___matlab_8m.html#a690da4f71682a3ad61fd1af8024eb5d3">m</a> format compact</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00004">4</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a72b6b8e83430abf007f20aeae4dc2f74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">all units <a class="el" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="el" href="sim_image_from_wave_8m.html#a74335ae40bc4ffab9fc80d95fee97208">A</a> def = <a class="el" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a>+(<a class="el" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a>-1)*<a class="el" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00064">64</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="ac14a938158345bed28242803677a8212"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def0</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= -sqrt(1.5*<a class="code" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a>*<a class="code" href="sim_image_from_wave_8m.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>)       % basis of <a class="code" href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a> (extended Scherzer)</div>
<div class="line">% <a class="code" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a> = -sqrt(<a class="code" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a>*<a class="code" href="sim_image_from_wave_8m.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a>)       % basis of <a class="code" href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a> (Scherzer)</div>
<div class="line"><a class="code" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a> = 200</div>
<div class="ttc" id="sim_image_from_wave_8m_html_aca36b09d6e71a60cfa3837d7e24c07ca"><div class="ttname"><a href="sim_image_from_wave_8m.html#aca36b09d6e71a60cfa3837d7e24c07ca">lambda</a></div><div class="ttdeci">lambda</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00010">simImageFromWave.m:10</a></div></div>
<div class="ttc" id="image_sim_8m_html_a6e1ec50d40620688cd6376e335851fa5"><div class="ttname"><a href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a></div><div class="ttdeci">handles Cs</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00422">imageSim.m:422</a></div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_a656d5e61939acabefd422775c5d110f1"><div class="ttname"><a href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a></div><div class="ttdeci">basis of defocus(Scherzer) defStep</div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_ac14a938158345bed28242803677a8212"><div class="ttname"><a href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a></div><div class="ttdeci">def0</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00026">simImageFromWave.m:26</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00026">26</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="ab3d24876579c14d6de1789dcf8748b8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">regular <a class="el" href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a> <a class="el" href="xyz2cfg_8m.html#a7cec22fd326288e5df0dadf886d5d919">array</a> defArray = <a class="el" href="sim_image_from_wave_8m.html#ac14a938158345bed28242803677a8212">def0</a> + <a class="el" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a>*[0:<a class="el" href="sim_image_from_wave_8m.html#a6982f38ee9865914f2fb8226037bd3c8">Nimg</a>-1]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00065">65</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a38ade178ddc6a845e495916d25738bf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="image_sim_8m.html#a0a2c0e3061e6dfed2bb93e1d6a220939">angle</a> of astigmatism Df = Cc*deltaE_E</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00023">23</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="aedf03b9517092eee7dae1588bbc00e19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">directory = 'sphere1'</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00007">7</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a59650fdddef08cde1605e75fa4181c5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dky = 1/(<a class="el" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*dY)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00049">49</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="acd3d6bf79802fda5452b60a07bc8fc03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">temporal coherence envelope</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00062">62</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="afeaa7ecdd726aa1950ba61dc659eb561"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">axis equal</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00088">88</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a12a8932e3a6c30507e8db1e5f119806a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Espat = exp(-(pi*<a class="el" href="virtual_goniometer_8m.html#a62197192f0fbf4e0675eb37be1c4c175">alpha</a>*<a class="el" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a>+pi*<a class="el" href="virtual_goniometer_8m.html#a62197192f0fbf4e0675eb37be1c4c175">alpha</a>*<a class="el" href="wavelength_8m.html#ac74dc040fa5d0c030c0d25905d271f51">lambda</a>^2*Cs.*<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>).^2.*<a class="el" href="sim_image_from_wave_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00069">69</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="ae96dd82fe30390e15166c14e3cb1e777"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qmb_8m.html#a2d9568f50e74214c48513c91bf8f143a">else</a> <a class="el" href="qmb_8m.html#ad589399858397b7c05877f34c359ed55">Display</a> <a class="el" href="image_sim_8m.html#aa9c57d86c53f86ed6afc6339a0476363">a</a> few figures</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00086">86</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="aedd72202f5fa11b5b301b347617895bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">additional images fro alignment for idf</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=1:<a class="code" href="convert2cfg_8m.html#aabbdf768a12d7ff279a05a15db19fa61">length</a>(<a class="code" href="sim_image_from_wave_8m.html#ab3d24876579c14d6de1789dcf8748b8e">defArray</a>)</div>
<div class="line">    <a class="code" href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a> = <a class="code" href="sim_image_from_wave_8m.html#ab3d24876579c14d6de1789dcf8748b8e">defArray</a>(<a class="code" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a>)</div>
<div class="ttc" id="sim_image_from_wave_8m_html_aedd72202f5fa11b5b301b347617895bb"><div class="ttname"><a href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a></div><div class="ttdeci">additional images fro alignment for idf</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00067">simImageFromWave.m:67</a></div></div>
<div class="ttc" id="convert2cfg_8m_html_aabbdf768a12d7ff279a05a15db19fa61"><div class="ttname"><a href="convert2cfg_8m.html#aabbdf768a12d7ff279a05a15db19fa61">length</a></div><div class="ttdeci">end if length(sv) &gt; 1</div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_a72b6b8e83430abf007f20aeae4dc2f74"><div class="ttname"><a href="sim_image_from_wave_8m.html#a72b6b8e83430abf007f20aeae4dc2f74">def</a></div><div class="ttdeci">all units in A def</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00064">simImageFromWave.m:64</a></div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_ab3d24876579c14d6de1789dcf8748b8e"><div class="ttname"><a href="sim_image_from_wave_8m.html#ab3d24876579c14d6de1789dcf8748b8e">defArray</a></div><div class="ttdeci">defArray</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00065">simImageFromWave.m:65</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00067">67</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a86d0d51ceb4bc3bd26707520f257a5a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">img = <a class="el" href="fftw__allocator_8hpp.html#a3265f53b67af1612bd5c314cdce95c32">abs</a>(ifft2(aperture.*wave.*chi.*Etemp.*<a class="el" href="image_sim_8m.html#ac6ccae1666df2c1024de02dcc9cc833e">Espat</a>)).^2+0.02*randn(<a class="el" href="qmb_8m.html#a34efcbeb95e7c3e7e0050034d30c01cd">size</a>(<a class="el" href="sim_image_from_wave_8m.html#acb3ac767ec1048cf315487da2b577ca4">wave</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00073">73</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="adcbf6818ca1a5f06faf47e9f23063dc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">k2 = <a class="el" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(kx.^2+ky.^2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00052">52</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="aca36b09d6e71a60cfa3837d7e24c07ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lambda = wavelength(300)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00010">10</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a6982f38ee9865914f2fb8226037bd3c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Nimg = 20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00030">30</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="acb6d7970e73c00effe1d16e23142f11d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">electron wavelength for beam energy Microscope parameters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00014">14</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="aaf40c223796354fb6b79c9ed047c513a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">phi = atan2(<a class="el" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a>,<a class="el" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00053">53</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a893e87b43fb9e0ad1de60d41fb3e338b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">plotFlag = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00032">32</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="ae16de8b25c906d11f01b9f4d0b81a70b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">define the reciprocal space sampling</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00048">48</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="aa329f2975fbe76cfdf70a27f88bfc0ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">saveMemory = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00005">5</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="aa092e314c697a00facfe496a7779b61b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="scale_s_t_e_m_image_8m.html#a201589b538fc56729422d4773c8b0cfe">end</a> Add some carbon to the specimen surface</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00043">43</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a1a71f5e406b211ed616173276484b78b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">axis tight</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00088">88</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="acb3ac767ec1048cf315487da2b577ca4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wave = fft2(wave.*carbon)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00044">44</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
<a class="anchor" id="a4fc3031161d6f3c3fa0a16037c4cfe71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">waveName = <a class="el" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>('%<a class="el" href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a>/<a class="el" href="sim_image_from_wave_8m.html#a158106813601030227d9d5f4a634da7f">wave.img</a>',<a class="el" href="sim_image_from_wave_8m.html#aedf03b9517092eee7dae1588bbc00e19">directory</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sim_image_from_wave_8m_source.html#l00034">34</a> of file <a class="el" href="sim_image_from_wave_8m_source.html">simImageFromWave.m</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e82970921ac3c6c3e512b9c67e4ee58d.html">GUI_Matlab</a></li><li class="navelem"><a class="el" href="sim_image_from_wave_8m.html">simImageFromWave.m</a></li>
    <li class="footer">Generated on Fri Jul 4 2014 10:51:38 for qstem by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
