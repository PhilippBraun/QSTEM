<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>qstem: GUI_Matlab/imageSim.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">qstem
   </div>
   <div id="projectbrief">multislice simulation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('image_sim_8m_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">imageSim.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="image_sim_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="image_sim_8m.html#acc89f64219ddae53243030f2c645fc06">    1</a></span>&#160;<span class="keyword">function</span> <a class="code" href="image_sim_8m.html#acc89f64219ddae53243030f2c645fc06">varargout</a> = imageSim(varargin)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;% IMAGESIM <a class="code" href="_displacement_params_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a>-<a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a> for imageSim.fig</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;%      IMAGESIM, by <a class="code" href="image_sim_8m.html#a831a3e1133c41b364b824dcb52ee0f9a">itself</a>, creates <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> new IMAGESIM or raises the existing</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;%      singleton*.</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;%</div>
<div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a7139acdd1e5da82d23644880b419a172">    6</a></span>&#160;%      <a class="code" href="image_sim_8m.html#a7139acdd1e5da82d23644880b419a172">H</a> = IMAGESIM returns the handle to <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> new IMAGESIM or the handle to</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;%      the existing singleton*.</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;%</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;%      IMAGESIM(&#39;CALLBACK&#39;,<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>,eventData,<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>,...) calls the local</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;%      <a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> named CALLBACK <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> IMAGESIM.<a class="code" href="_displacement_params_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a> with the given input arguments.</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;%      IMAGESIM(&#39;Property&#39;,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;,...) creates <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> new IMAGESIM or raises</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;%      the</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;%      existing singleton*.  Starting from the left, property <a class="code" href="qstem_8m.html#aeee9d3c55cddc06149a5f9799cd5232d">value</a> pairs are</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;%      applied to the GUI before imageSim_OpeningFunction gets called.  An</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;%      unrecognized property <a class="code" href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151">name</a> or invalid <a class="code" href="qstem_8m.html#aeee9d3c55cddc06149a5f9799cd5232d">value</a> makes property</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;%      application</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;%      stop.  All inputs are passed to imageSim_OpeningFcn via varargin.</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;%</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;%      *See GUI Options <a class="code" href="image_sim_8m.html#a454532bd4d96c4531eb16b4052fefbe4">on</a> GUIDE&#39;<a class="code" href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a> Tools menu.  Choose &quot;GUI allows only one</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;%      instance to run (singleton)&quot;.</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;%</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;% See also: GUIDE, GUIDATA, GUIHANDLES</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;% Edit the above text to modify the response to help imageSim</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;% Last Modified by GUIDE v2.5 09-Mar-2012 21:11:32</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;% Begin initialization code - DO NOT EDIT</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;gui_Singleton = 1;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a81818e83613dec074856ab22e695b67f">   31</a></span>&#160;<a class="code" href="image_sim_8m.html#a81818e83613dec074856ab22e695b67f">gui_State</a> = <span class="keyword">struct</span>(<span class="stringliteral">&#39;gui_Name&#39;</span>,       mfilename, ...</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                   <span class="stringliteral">&#39;gui_Singleton&#39;</span>,  gui_Singleton, ...</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                   <span class="stringliteral">&#39;gui_OpeningFcn&#39;</span>, @imageSim_OpeningFcn, ...</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                   <span class="stringliteral">&#39;gui_OutputFcn&#39;</span>,  @imageSim_OutputFcn, ...</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                   <span class="stringliteral">&#39;gui_LayoutFcn&#39;</span>,  [] , ...</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                   <span class="stringliteral">&#39;gui_Callback&#39;</span>,   []);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keywordflow">if</span> <a class="code" href="convert2cfg_8m.html#a7f9b12e953d2678415a3d421f36ae4d6">nargin</a> &amp;&amp; <a class="code" href="image_sim_8m.html#aae1d1bec0e9c36c2fddc5cd87d8c4eee">ischar</a>(varargin{1})</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="image_sim_8m.html#a81818e83613dec074856ab22e695b67f">gui_State</a>.gui_Callback = str2func(varargin{1});</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a9b07119da70fc4a54e0d1cb5751d69aa">nargout</a></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a9b07119da70fc4a54e0d1cb5751d69aa">   42</a></span>&#160;    [varargout{1:nargout}] = <a class="code" href="image_sim_8m.html#a58f7f5bb8af524fdfac53ec31e329e3f">gui_mainfcn</a>(<a class="code" href="image_sim_8m.html#a81818e83613dec074856ab22e695b67f">gui_State</a>, varargin{:});</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="image_sim_8m.html#a58f7f5bb8af524fdfac53ec31e329e3f">gui_mainfcn</a>(<a class="code" href="image_sim_8m.html#a81818e83613dec074856ab22e695b67f">gui_State</a>, varargin{:});</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;% End initialization code - DO NOT EDIT</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;% --- Executes just before imageSim is made visible.</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> imageSim_OpeningFcn(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>, <a class="code" href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a>, <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>, varargin)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;% This <a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> has no <a class="code" href="qstem_8m.html#a48673c39259e21125ccdd489d990c78e">output</a> <a class="code" href="image_sim_8m.html#aa75144726b375b93ecfc08810e5b5f09">args</a>, <a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> OutputFcn.</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;% <a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>    handle to <a class="code" href="image_sim_8m.html#a391e34f2de441d79152a7b3d6e4c9c86">figure</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;% <a class="code" href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a>  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;% <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>    structure with <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> and user data (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GUIDATA)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;% varargin   command line arguments to imageSim (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> VARARGIN)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;% Choose default command line <a class="code" href="qstem_8m.html#a48673c39259e21125ccdd489d990c78e">output</a> for imageSim</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="qstem_8m.html#a48673c39259e21125ccdd489d990c78e">output</a> = <a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a589b13a90e011e72db96b891b65da911">   59</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.initialized = 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="image_sim_8m.html#abff58742c346a246952566cf5aa5fbb0">   60</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.diffractogramMode = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aea926c42f75577fdf775d6ceda9624bd">   61</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.applyVibration = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a617e69bc47c08413dff023b0d0d9d5c6">   62</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.vibration_Axis1 = 0;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a489e6c7c5e937f378873d423394fa972">   63</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.vibration_Axis2 = 0;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="image_sim_8m.html#af86ea2576d700f75de9452170bb57912">   64</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.vibration_Angle = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">   65</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.c = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(6,1);</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">   66</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.a = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(6);</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">   67</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.phi = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(6);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;% Read the <a class="code" href="image_sim_8m.html#a20dc037394f2773f476c77746b20881b">wave</a> <span class="keyword">function</span> from disk</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">   70</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> = readWave(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;% initialize <a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a> distance.</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a0f78069bbc8a49dd82779a5f3c6abba2">   72</a></span>&#160;% <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.dx = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.editSampling,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> = updateKArrays(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>, <a class="code" href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a>, <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;% <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> = updateImages(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;% Update <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> structure</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>, <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;% UIWAIT makes imageSim wait <span class="keywordflow">for</span> user <a class="code" href="image_sim_8m.html#aea744f16da952a9326dc0cfb579ea16c">response</a> (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> UIRESUME)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;% uiwait(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.figure1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;% --- Outputs from this <a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> are returned to the command line.</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#acc89f64219ddae53243030f2c645fc06">varargout</a> = imageSim_OutputFcn(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>, <a class="code" href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a>, <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>) </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;% <a class="code" href="image_sim_8m.html#acc89f64219ddae53243030f2c645fc06">varargout</a>  <a class="code" href="_read_d_m3___matlab_8m.html#a788f12e84a4147fbec966d469221fb80">cell</a> <a class="code" href="convert2cfg_8m.html#a7cec22fd326288e5df0dadf886d5d919">array</a> for returning <a class="code" href="qstem_8m.html#a48673c39259e21125ccdd489d990c78e">output</a> <a class="code" href="image_sim_8m.html#aa75144726b375b93ecfc08810e5b5f09">args</a> (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> VARARGOUT);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;% <a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>    handle to <a class="code" href="image_sim_8m.html#a391e34f2de441d79152a7b3d6e4c9c86">figure</a></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a7c1ef7386988a8ccd4761d8428895842">   88</a></span>&#160;% <a class="code" href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a>  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;% <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>    structure with <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> and user data (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GUIDATA)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;% Get default command line <a class="code" href="qstem_8m.html#a48673c39259e21125ccdd489d990c78e">output</a> from <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> structure</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">   92</a></span>&#160;<a class="code" href="image_sim_8m.html#acc89f64219ddae53243030f2c645fc06">varargout</a>{1} = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.output;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;%%</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;%% Main drawing <span class="keyword">function</span>:</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;%% This is the most relevant <span class="keyword">function</span>.  It contains all the maths</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">function</span> <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a> = updateImages(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>)</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">  101</a></span>&#160;[Ny,Nx] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.wave0);</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aea0f936671f7f4f8fdb0dd293e4d6489">  102</a></span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Amorph   = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.editAmorph,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;% Construct the <a class="code" href="image_sim_8m.html#a20dc037394f2773f476c77746b20881b">wave</a> <span class="keyword">function</span> from the different weightings and amorphous</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;% <a class="code" href="image_sim_8m.html#a79f291e6d46f2b83a62e43c884a7e952">signal</a>:</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordflow">if</span> (0)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.MinAmplitude &lt; 1</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a79f291e6d46f2b83a62e43c884a7e952">  109</a></span>&#160;        <a class="code" href="image_sim_8m.html#ae86f2475cbf92be6cf5f5c266451d828">ampl</a> = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.MinAmplitude+<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a2eb1b2c41b2c60683d5d4f9a45893d00">wave0</a>)*(1-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.MinAmplitude);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ae86f2475cbf92be6cf5f5c266451d828">  111</a></span>&#160;        <a class="code" href="image_sim_8m.html#ae86f2475cbf92be6cf5f5c266451d828">ampl</a> = <a class="code" href="_displacement_params_8m.html#aae9af2e7ae27ed31a08ec6a73ee7c424">ones</a>(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.wave0));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a27fb1250ca117b18cc017488b7e8a127">  113</a></span>&#160;    <a class="code" href="image_sim_8m.html#a27fb1250ca117b18cc017488b7e8a127">phase</a> = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.MaxPhase*<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.wave0);</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a82c07d7e6b41700d9b12774e3f7b7e1a">  114</a></span>&#160;    <a class="code" href="image_sim_8m.html#a82c07d7e6b41700d9b12774e3f7b7e1a">amorph</a> = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Amorph*(rand(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>)-0.5);</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a20dc037394f2773f476c77746b20881b">  115</a></span>&#160;    <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.wave = <a class="code" href="image_sim_8m.html#ae86f2475cbf92be6cf5f5c266451d828">ampl</a>.*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*(<a class="code" href="image_sim_8m.html#a27fb1250ca117b18cc017488b7e8a127">phase</a>+<a class="code" href="image_sim_8m.html#a82c07d7e6b41700d9b12774e3f7b7e1a">amorph</a>));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="image_sim_8m.html#a82c07d7e6b41700d9b12774e3f7b7e1a">amorph</a> = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Amorph*(rand(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>)-0.5);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.wave = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.wave0+<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#a82c07d7e6b41700d9b12774e3f7b7e1a">amorph</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;% Compute the <a class="code" href="image_sim_8m.html#a0bbe3bce7888733cdeb0db41e5b1dc36">CTF</a> (<span class="keyword">this</span> is where the Math is):</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;% apply the beam tilt as an <a class="code" href="qmb_8m.html#a4dd6f73f98b7876577fd0d041b94d968">offset</a> to the optic axis:</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<a class="code" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a> = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">  126</a></span>&#160;<a class="code" href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">ky2</a> = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.ky2;</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">  127</a></span>&#160;<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>  = (<a class="code" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a>.^2+<a class="code" href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">ky2</a>.^2);</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">  128</a></span>&#160;<a class="code" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a>  = <a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>*(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.lambda.^2);</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">  129</a></span>&#160;<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>   = sqrt(<a class="code" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>     = atan2(<a class="code" href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">ky2</a>,<a class="code" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a0ad7769f602705d0703a3685f5768c7b">  132</a></span>&#160;<a class="code" href="image_sim_8m.html#a0ad7769f602705d0703a3685f5768c7b">pl</a>      = pi*<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.lambda;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="image_sim_8m.html#af14d03723ec22be0994af92b83f1d134">  133</a></span>&#160;<a class="code" href="image_sim_8m.html#af14d03723ec22be0994af92b83f1d134">p_l</a>     = pi/<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.lambda;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a05d251ea28c5be9426611a121db0c92a">  134</a></span>&#160;<a class="code" href="image_sim_8m.html#a05d251ea28c5be9426611a121db0c92a">fa</a>      = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Defocus+<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#aa86513d9e6380d2aa6e86ed5fa4bd86a">Astig</a>)*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#aa86513d9e6380d2aa6e86ed5fa4bd86a">Astig</a>)));</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a853e5b0b247b39e9e25c549e4963311a">  135</a></span>&#160;<a class="code" href="image_sim_8m.html#a853e5b0b247b39e9e25c549e4963311a">coma3a</a>  = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Coma)*cos((<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Coma)))+...</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#ad1e3f2cce958f10b9f27e568964658f2">Astig3</a>)*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#ad1e3f2cce958f10b9f27e568964658f2">Astig3</a>)));</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">  137</a></span>&#160;% <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a> =   (<a class="code" href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a>+astigmatism) + spherical <a class="code" href="aberrations_8m.html#add6b7c5f8447a629106b3fae4a009eb8">aberration</a> + coma)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(2)     = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a095451ad095fab975004df8fa1925cb8">Defocus</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.c(4)     = <a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Cs;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.phi(2,2) = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Astig);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.a(2,2)   = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Astig);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.a(3,1)   = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Coma);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.phi(3,1) = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Coma);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.a(3,3)   = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Astig3);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.phi(3,3) = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.Astig3);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">if</span> <span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.checkbox_IncludeHigherOrders,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="image_sim_8m.html#af1b232e0b8fff58d7cb6ab24987002b4">chi</a>=2*<a class="code" href="image_sim_8m.html#af14d03723ec22be0994af92b83f1d134">p_l</a>*(1/2*(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.a(2,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.phi(2,2)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(2)).*<a class="code" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a>+...</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;               1/3*(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,3).*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,3)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,1).*cos(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,1)))).*<a class="code" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a>.*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>+...</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;               1/4*(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(4,4).*cos(4*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(4,4)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(4,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(4,2)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(4)).*(<a class="code" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a>.^2)+...</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;               1/5*(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,5).*cos(5*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,5)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,3).*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,3)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,1).*cos(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,1)))).*(<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>.^5)+...</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;               1/6*(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,6).*cos(6*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,6)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,4).*cos(4*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,4)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,2)))+<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(6)).*(<a class="code" href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a>.^3));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>     = exp(-<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#af1b232e0b8fff58d7cb6ab24987002b4">chi</a>);    </div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">  154</a></span>&#160;    <a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>    = <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.checkboxConvAngle,<span class="stringliteral">&#39;Value&#39;</span>))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        % I will <a class="code" href="showimage_8m.html#ac1b7f512a0fa5c0b7d1d056a07969aa2">use</a>: [dchi(q)/dq]^2 = [dchi/d|q|]^2+[dchi/|<a class="code" href="qstem_8m.html#a94410fa84a6efa7c64c1f760371d51d1">q</a>|dphi]^2</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        % first let&#39;<a class="code" href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a> compute the <a class="code" href="qstem_8m.html#a94410fa84a6efa7c64c1f760371d51d1">q</a>-derivative (the division by <a class="code" href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">lambda</a> is removed <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> both cases):</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        dchi_dq = ((<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(2,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-<a class="code" href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a>.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(2,2)))+handles.c(2)).*theta+...</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                   (handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,3).*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,3)))+handles.a(3,1).*cos(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,1)))).*theta2+...</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                   (handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(4,4).*cos(4*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(4,4)))+handles.a(4,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(4,2)))+handles.c(4)).*theta.^3+...</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                   (handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,5).*cos(5*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,5)))+handles.a(5,3).*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,3)))+handles.a(5,1).*cos(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,1)))).*theta2.^2+...</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                   (handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,6).*cos(6*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,6)))+handles.a(6,4).*cos(4*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,4)))+handles.a(6,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,2)))+handles.c(6)).*theta.^5)*2*pi;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a491b666333e689144e868595f1fdee9b">  163</a></span>&#160;        <a class="code" href="image_sim_8m.html#a491b666333e689144e868595f1fdee9b">dchi_dphi</a>=(1/2*(2*handles.a(2,2).*sin(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.phi(2,2)))).*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>+...</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                   1/3*(3*handles.a(3,3).*sin(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.phi(3,3)))+1*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,1).*sin(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,1)))).*theta2+...</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                   1/4*(4*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(4,4).*sin(4*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(4,4)))+2*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(4,2).*sin(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(4,2)))).*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>.^3+...</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                   1/5*(5*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,5).*sin(5*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,5)))+3*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,3).*sin(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,3)))+1*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(5,1).*sin(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(5,1)))).*theta2.^2+...</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                   1/6*(6*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,6).*sin(6*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,6)))+4*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,4).*sin(4*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,4)))+2*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(6,2).*sin(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(6,2)))).*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>.^5)*(-2*pi);</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">  168</a></span>&#160;        <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a> = exp(-sign(handles.Convergence)*(handles.Convergence/(2*handles.lambda)).^2.*(dchi_dq.^2+<a class="code" href="image_sim_8m.html#a491b666333e689144e868595f1fdee9b">dchi_dphi</a>.^2));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a> &gt; 5)) = 5;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a> = <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>.*<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="image_sim_8m.html#af1b232e0b8fff58d7cb6ab24987002b4">  173</a></span>&#160;    <a class="code" href="image_sim_8m.html#af1b232e0b8fff58d7cb6ab24987002b4">chi</a>=2*<a class="code" href="image_sim_8m.html#af14d03723ec22be0994af92b83f1d134">p_l</a>*(1/2*(handles.a(2,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.phi(2,2)))+handles.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(2)).*theta2+...</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;               1/3*(handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,3).*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,3)))+handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,1).*cos(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,1)))).*theta2.*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>+...</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;               1/4*(handles.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(4)).*(theta2.^2));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>     = exp(-<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#af1b232e0b8fff58d7cb6ab24987002b4">chi</a>);    </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>    = <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    % <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a> = exp(-<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*2*<a class="code" href="image_sim_8m.html#af14d03723ec22be0994af92b83f1d134">p_l</a>*theta2.*(1/2*<a class="code" href="image_sim_8m.html#a05d251ea28c5be9426611a121db0c92a">fa</a>+1/3*<a class="code" href="image_sim_8m.html#a853e5b0b247b39e9e25c549e4963311a">coma3a</a>.*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>+1/4*handles.Cs*theta2));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">get</span>(handles.checkboxConvAngle,<span class="stringliteral">&#39;Value&#39;</span>))</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;       dchi_dq = ((handles.a(2,2).*cos(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.phi(2,2)))+handles.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(2)).*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>+...</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                   (handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,3).*cos(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,3)))+handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,1).*cos(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,1)))).*theta2+...</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                   (handles.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(4)).*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>.^3)*2*pi;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="image_sim_8m.html#a491b666333e689144e868595f1fdee9b">dchi_dphi</a>=(1/2*(2*handles.a(2,2).*sin(2*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.phi(2,2)))).*<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>+...</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                   1/3*(3*handles.a(3,3).*sin(3*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.phi(3,3)))+1*handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(3,1).*sin(1*(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(3,1)))).*theta2)*(-2*pi);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a> = exp(-sign(handles.Convergence)*(handles.Convergence/(2*handles.lambda)).^2.*(dchi_dq.^2+<a class="code" href="image_sim_8m.html#a491b666333e689144e868595f1fdee9b">dchi_dphi</a>.^2));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        % <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a> = exp(-sign(handles.Convergence)*(pi*handles.Convergence*(<a class="code" href="image_sim_8m.html#a05d251ea28c5be9426611a121db0c92a">fa</a>+handles.lambda^2*handles.Cs.*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>)).^2.*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a> &gt; 5)) = 5;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a> = <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>.*<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordflow">if</span> (handles.ObjApertureTheta &gt; 0)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    handles.ObjApertureEdge = 1e-3*<a class="code" href="image_sim_8m.html#a07be7620fe0b9f26017a975773b41995">str2num</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit_ObjApertureEdge,&#39;<a class="code" href="image_sim_8m.html#a75871acd33bd071349a6f2d6cd0aa6b8">String</a>&#39;));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a> &gt;= (handles.ObjApertureTheta+handles.ObjApertureEdge))) = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a> &gt;= (handles.ObjApertureTheta+handles.ObjApertureEdge))) = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">  197</a></span>&#160;    <a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a> = <a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>((<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a> &lt; (handles.ObjApertureTheta+handles.ObjApertureEdge)) &amp; (<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a> &gt; handles.ObjApertureTheta));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>(<a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a>) = 0.5*<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>(<a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a>).*(1+cos(pi*(<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>(<a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a>)-handles.<a class="code" href="image_sim_8m.html#ac16e8fafe8788f3b927b805b701ed99c">ObjApertureTheta</a>)/handles.ObjApertureEdge));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>(<a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a>) = 0.5*<a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>(<a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a>).*(1+cos(pi*(<a class="code" href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a>(<a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a>)-handles.<a class="code" href="image_sim_8m.html#ac16e8fafe8788f3b927b805b701ed99c">ObjApertureTheta</a>)/handles.ObjApertureEdge));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    clear <a class="code" href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;% Compute the damping <a class="code" href="image_sim_8m.html#a2a5a93dafb68c266fe1beb6116fb0ce5">envelopes</a>:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;% This is what I used <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> simImageFromWave - check this!!!:</div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a2a5a93dafb68c266fe1beb6116fb0ce5">  205</a></span>&#160;% Etemp = exp(-2.0*(1.0/handles.<a class="code" href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">lambda</a>*handles.<a class="code" href="image_sim_8m.html#a15f1a96dd5e77ed931110fbb52692049">Delta</a>*theta2).^2);  </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">get</span>(handles.checkboxDelta,<span class="stringliteral">&#39;Value&#39;</span>))</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a> = exp(-sign(handles.Delta)*(0.5*pi/handles.lambda*handles.Delta*theta2).^2);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(<a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a> &gt; 3)) = 3;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    </div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a391e34f2de441d79152a7b3d6e4c9c86">  213</a></span>&#160;    % <a class="code" href="image_sim_8m.html#a391e34f2de441d79152a7b3d6e4c9c86">figure</a>; <a class="code" href="image_sim_8m.html#a56d3a59131aac023681a044b7481f27d">plot</a>(handles.dkx*10*[-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2-1],[<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(:,1)) <a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:,1))]); <a class="code" href="image_sim_8m.html#af5e7b6b3888b7ff1427978d360412fe7">pause</a>(0.1);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    % Apply the damping <a class="code" href="image_sim_8m.html#a2a5a93dafb68c266fe1beb6116fb0ce5">envelopes</a> as <a class="code" href="image_sim_8m.html#a2fd56ce4970b3332e6c626b31607b782">well</a>:</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a2fd56ce4970b3332e6c626b31607b782">  215</a></span>&#160;    <a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a> = <a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>.*<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a> = <a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>.*<a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordflow">if</span> (handles.TiltX ~= 0) || (handles.TiltY ~= 0)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="image_sim_8m.html#a34b20e3956ba06c0f792cff638706a9b">tx</a> = round(handles.TiltX/(handles.lambda*handles.dkx));</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">  221</a></span>&#160;    <a class="code" href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">ty</a> = round(handles.TiltY/(handles.lambda*handles.dky));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_QuasiCoherent,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        handles.Psi = ifft2(circshift(fft2(handles.wave),[<a class="code" href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">ty</a> <a class="code" href="image_sim_8m.html#a34b20e3956ba06c0f792cff638706a9b">tx</a>]).*<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa8f31224617f37bdccf7d77eef73a4a3">  225</a></span>&#160;        handles.Psi = ifft2(circshift(fft2(handles.wave),[<a class="code" href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">ty</a> tx]).*<a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>);     </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        handles.Espat = <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a34b20e3956ba06c0f792cff638706a9b">  229</a></span>&#160;    tx = 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">ty</a> = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_QuasiCoherent,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        handles.Psi = ifft2(fft2(handles.wave).*<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        handles.Psi = ifft2(fft2(handles.wave).*<a class="code" href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        handles.Espat = <a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>        </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;% handles.Cs*<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(theta2)).^2</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;% The radiobutton <span class="stringliteral">&#39;Wave&#39;</span> decides whether to <a class="code" href="image_sim_8m.html#a56d3a59131aac023681a044b7481f27d">plot</a> the <a class="code" href="image_sim_8m.html#a20dc037394f2773f476c77746b20881b">wave</a>, or the CTF</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobuttonWave,<span class="stringliteral">&#39;Value&#39;</span>)  </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    % show the wave <span class="keyword">function</span>:</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="image_sim_8m.html#ab964b27abe11b74fda54cae6e1a89e85">axes</a>(handles.axesAmplitude);</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">  244</a></span>&#160;    <a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a> = <span class="keyword">get</span>(handles.axesAmplitude,<span class="stringliteral">&#39;XLim&#39;</span>);  <a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a> = <span class="keyword">get</span>(handles.axesAmplitude,<span class="stringliteral">&#39;YLim&#39;</span>);    <a class="code" href="image_sim_8m.html#a08244d156689b3ad5a7c2c2c6e5c7a7c">cla</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.wave));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(gca,<span class="stringliteral">&#39;YDir&#39;</span>,<span class="stringliteral">&#39;normal&#39;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;amplitide&#39;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a>(<span class="stringliteral">&#39;x in nm&#39;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a>(<span class="stringliteral">&#39;y in nm&#39;</span>);    </div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">  250</a></span>&#160;    axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (handles.initialized)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;       % <a class="code" href="aberrations_8m.html#a5eb8d5664fde7892dc80f5dbe5218568">xlim</a>(<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#a4d6bf7ca27b90221b33758fc9f02d95f">ylim</a>(<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>); </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;       <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,<span class="stringliteral">&#39;XLim&#39;</span>,<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,<span class="stringliteral">&#39;YLim&#39;</span>,<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="image_sim_8m.html#ab964b27abe11b74fda54cae6e1a89e85">axes</a>(handles.axesPhase);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a> = <span class="keyword">get</span>(handles.axesPhase,<span class="stringliteral">&#39;XLim&#39;</span>);  <a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a> = <span class="keyword">get</span>(handles.axesPhase,<span class="stringliteral">&#39;YLim&#39;</span>);    <a class="code" href="image_sim_8m.html#a08244d156689b3ad5a7c2c2c6e5c7a7c">cla</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.wave));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(gca,<span class="stringliteral">&#39;YDir&#39;</span>,<span class="stringliteral">&#39;normal&#39;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;phase&#39;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (handles.initialized)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;       % <a class="code" href="aberrations_8m.html#a5eb8d5664fde7892dc80f5dbe5218568">xlim</a>(<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#a4d6bf7ca27b90221b33758fc9f02d95f">ylim</a>(<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>); </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,<span class="stringliteral">&#39;XLim&#39;</span>,<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,<span class="stringliteral">&#39;YLim&#39;</span>,<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    % show the CTF:</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a0bbe3bce7888733cdeb0db41e5b1dc36">  268</a></span>&#160;    <a class="code" href="image_sim_8m.html#ab964b27abe11b74fda54cae6e1a89e85">axes</a>(handles.axesAmplitude);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a> = <span class="keyword">get</span>(handles.axesAmplitude,<span class="stringliteral">&#39;XLim&#39;</span>);  <a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a> = <span class="keyword">get</span>(handles.axesAmplitude,<span class="stringliteral">&#39;YLim&#39;</span>);    <a class="code" href="image_sim_8m.html#a08244d156689b3ad5a7c2c2c6e5c7a7c">cla</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    % handles.kx</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    % <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.kx,handles.ky,<a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dkx*10*[-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2-1],handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>)));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(gca,<span class="stringliteral">&#39;YDir&#39;</span>,<span class="stringliteral">&#39;normal&#39;</span>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;Real(CTF)&#39;</span>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a>(<span class="stringliteral">&#39;kx in 1/nm&#39;</span>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a>(<span class="stringliteral">&#39;ky in 1/nm&#39;</span>);    </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (handles.initialized)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;       %<a class="code" href="aberrations_8m.html#a5eb8d5664fde7892dc80f5dbe5218568">xlim</a>(<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#a4d6bf7ca27b90221b33758fc9f02d95f">ylim</a>(<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>); </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;       <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,<span class="stringliteral">&#39;XLim&#39;</span>,<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,<span class="stringliteral">&#39;YLim&#39;</span>,<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="image_sim_8m.html#ab964b27abe11b74fda54cae6e1a89e85">axes</a>(handles.axesPhase);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a> = <span class="keyword">get</span>(handles.axesPhase,<span class="stringliteral">&#39;XLim&#39;</span>);  <a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a> = <span class="keyword">get</span>(handles.axesPhase,<span class="stringliteral">&#39;YLim&#39;</span>);    <a class="code" href="image_sim_8m.html#a08244d156689b3ad5a7c2c2c6e5c7a7c">cla</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dkx*10*[-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2-1],handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="fftw__allocator_8hpp.html#a4b67f0883b07b3e879fc8c8481e3d393">imag</a>(<a class="code" href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a>)));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(gca,<span class="stringliteral">&#39;YDir&#39;</span>,<span class="stringliteral">&#39;normal&#39;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    hold <a class="code" href="image_sim_8m.html#a454532bd4d96c4531eb16b4052fefbe4">on</a></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">get</span>(handles.checkboxDelta,<span class="stringliteral">&#39;Value&#39;</span>) &amp;&amp; <span class="keyword">get</span>(handles.checkboxConvAngle,<span class="stringliteral">&#39;Value&#39;</span>))</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="image_sim_8m.html#a56d3a59131aac023681a044b7481f27d">plot</a>(handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],handles.dky*5*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*(0.9/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>([<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(:,1); <a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:,1)])*[<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(:,1)) <a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:,1))]),<span class="stringliteral">&#39;Linewidth&#39;</span>,2);</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a89d8aed5fbb472f6199ce54ecd7a31bc">  292</a></span>&#160;        <a class="code" href="image_sim_8m.html#a89d8aed5fbb472f6199ce54ecd7a31bc">legend</a>(<span class="stringliteral">&#39;E_{spat}&#39;</span>,<span class="stringliteral">&#39;E_{temp}&#39;</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">get</span>(handles.checkboxDelta,<span class="stringliteral">&#39;Value&#39;</span>) &amp;&amp; (~<span class="keyword">get</span>(handles.checkboxConvAngle,<span class="stringliteral">&#39;Value&#39;</span>)))</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="image_sim_8m.html#a56d3a59131aac023681a044b7481f27d">plot</a>(handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],handles.dky*5*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*(0.9/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:,1))*[<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a>(:,1))]),<span class="stringliteral">&#39;Linewidth&#39;</span>,2);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="image_sim_8m.html#a89d8aed5fbb472f6199ce54ecd7a31bc">legend</a>(<span class="stringliteral">&#39;E_{temp}&#39;</span>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (~<span class="keyword">get</span>(handles.checkboxDelta,<span class="stringliteral">&#39;Value&#39;</span>) &amp;&amp; <span class="keyword">get</span>(handles.checkboxConvAngle,<span class="stringliteral">&#39;Value&#39;</span>))</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="image_sim_8m.html#a56d3a59131aac023681a044b7481f27d">plot</a>(handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],handles.dky*5*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*(0.9/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(:,1))*[<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>(:,1))]),<span class="stringliteral">&#39;Linewidth&#39;</span>,2);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="image_sim_8m.html#a89d8aed5fbb472f6199ce54ecd7a31bc">legend</a>(<span class="stringliteral">&#39;E_{spat}&#39;</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    hold off</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;Imag(CTF)&#39;</span>);  </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (handles.initialized)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;       % <a class="code" href="aberrations_8m.html#a5eb8d5664fde7892dc80f5dbe5218568">xlim</a>(<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#a4d6bf7ca27b90221b33758fc9f02d95f">ylim</a>(<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>); </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;       <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,<span class="stringliteral">&#39;XLim&#39;</span>,<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,<span class="stringliteral">&#39;YLim&#39;</span>,<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<a class="code" href="image_sim_8m.html#ab964b27abe11b74fda54cae6e1a89e85">axes</a>(handles.axesImage);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a> = <span class="keyword">get</span>(handles.axesImage,<span class="stringliteral">&#39;XLim&#39;</span>);  <a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a> = <span class="keyword">get</span>(handles.axesImage,<span class="stringliteral">&#39;YLim&#39;</span>);    <a class="code" href="image_sim_8m.html#a08244d156689b3ad5a7c2c2c6e5c7a7c">cla</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobuttonImage,<span class="stringliteral">&#39;Value&#39;</span>)  </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    % show the <a class="code" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a> = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi).^2;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_FluxPreserving,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a> = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(<a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a>).*<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Vibration,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a> = (pi*handles.vibration_Axis1/(-log(0.5))).^2;</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="image_sim_8m.html#abded2f650c4628bd791ebe1e3b0dab43">  322</a></span>&#160;        <a class="code" href="image_sim_8m.html#abded2f650c4628bd791ebe1e3b0dab43">vib2</a> = (pi*handles.vibration_Axis2/(-log(0.5))).^2;</div>
<div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">  323</a></span>&#160;        <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a> = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(<a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a>).*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-<a class="code" href="image_sim_8m.html#abded2f650c4628bd791ebe1e3b0dab43">vib2</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Counts,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(handles.edit_ImgCounts,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a> = cnts*simIm+sqrt(cnts*simIm).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(simIm));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(simIm &lt; 0)) = 0;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],simIm);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;Image t=%.1f nm [%.4f .. %.4f]&#39;</span>,0.1*handles.thickness,min(min(simIm)),<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(simIm))));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;elseif <span class="keyword">get</span>(handles.radiobutton_WaveAmplitude,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    % simIm = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    % <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],simIm);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    % <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;Amplitude t=%.1f nm [%.4f .. %.4f]&#39;</span>,0.1*handles.thickness,min(min(simIm)),<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(simIm))));</div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">  337</a></span>&#160;    <a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a> = log(1+<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(fft2(handles.Psi)));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a>(mod(<a class="code" href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">ty</a>+<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>)+1,1+mod(tx+<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>)) = 0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dkx*10*[-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2-1],handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(<a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a>));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;Diffraction Pattern (log scale)&#39;</span>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;elseif <span class="keyword">get</span>(handles.radiobutton_WavePhase,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    simIm = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.Psi);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],simIm);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;Phase t=%.1f nm [%.4f .. %.4f]&#39;</span>,0.1*handles.thickness,min(min(simIm)),<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(simIm))));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    % show the diffractogram</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    simIm = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi).^2;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Counts,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(handles.edit_ImgCounts,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        simIm = cnts*simIm+sqrt(cnts*simIm).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(simIm));</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(simIm &lt; 0)) = 0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_FluxPreserving,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a> = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(fft2(simIm).*<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a> = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(fft2(simIm));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Vibration,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a> = (pi*handles.vibration_Axis1/(-log(0.5))).^2;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="image_sim_8m.html#abded2f650c4628bd791ebe1e3b0dab43">vib2</a> = (pi*handles.vibration_Axis2/(-log(0.5))).^2;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        diffg = diffg.*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    diffg = log(1+diffg);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a>(1,1) = 0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dkx*10*[-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2-1],handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(diffg));</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;Diffractogram (log scale)&#39;</span>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<a class="code" href="image_sim_8m.html#af56c95f61621bf9779137b38fcb3e0fd">colormap</a>(<span class="stringliteral">&#39;gray&#39;</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(gca,<span class="stringliteral">&#39;YDir&#39;</span>,<span class="stringliteral">&#39;normal&#39;</span>);</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">  372</a></span>&#160;<span class="keywordflow">if</span> (<span class="keyword">get</span>(handles.radiobuttonDiffractogram,<span class="stringliteral">&#39;Value&#39;</span>) == 0) &amp;&amp; (<span class="keyword">get</span>(handles.radiobutton_WaveAmplitude,<span class="stringliteral">&#39;Value&#39;</span>) == 0)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a>(<span class="stringliteral">&#39;x in nm&#39;</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a>(<span class="stringliteral">&#39;y in nm&#39;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a>(<span class="stringliteral">&#39;x in 1/nm&#39;</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a>(<span class="stringliteral">&#39;y in 1/nm&#39;</span>);    </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordflow">if</span> (handles.initialized)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    % <a class="code" href="aberrations_8m.html#a5eb8d5664fde7892dc80f5dbe5218568">xlim</a>(<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#a4d6bf7ca27b90221b33758fc9f02d95f">ylim</a>(<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,<span class="stringliteral">&#39;XLim&#39;</span>,<a class="code" href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a>); <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,<span class="stringliteral">&#39;YLim&#39;</span>,<a class="code" href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;handles.initialized = 1;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;% <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(gcbo, handles);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;%% <a class="code" href="fileio__fftw3_8cpp.html#a955f504eccf76b4eb2489c0adab03121">A</a> few utility <a class="code" href="image_sim_8m.html#a5c06813fe91f99a63a998aa2b4e6335d">functions</a>:</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keyword">function</span> handles = readWave(handles)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (0)</div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a5c06813fe91f99a63a998aa2b4e6335d">  395</a></span>&#160;    % <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a> = <a class="code" href="read_c_f_g__qstem_8m.html#a85162b5d5e6736f5aa8616580d4e8a75">sum</a>(imread(&#39;amplitude.jpg&#39;),3);</div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">  396</a></span>&#160;    % <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="read_c_f_g__qstem_8m.html#a85162b5d5e6736f5aa8616580d4e8a75">sum</a>(imread(&#39;<a class="code" href="image_sim_8m.html#a27fb1250ca117b18cc017488b7e8a127">phase</a>.jpg&#39;),3);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    % normalize the <a class="code" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a> <a class="code" href="image_sim_8m.html#aa4f166fe617bcfd58e6c02d41f03c118">intensities</a>:</div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa4f166fe617bcfd58e6c02d41f03c118">  398</a></span>&#160;    <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a> = <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>))-0.5;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    </div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a2eb1b2c41b2c60683d5d4f9a45893d00">  401</a></span>&#160;    handles.<a class="code" href="image_sim_8m.html#a2eb1b2c41b2c60683d5d4f9a45893d00">wave0</a> = img1.*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*img2);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    clear img1 img2</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">  404</a></span>&#160;    [<a class="code" href="convert2cfg_8m.html#a1a3091fb7347c8f640f7b03687dadd44">filename</a>, <a class="code" href="convert2cfg_8m.html#aea8eee85d5cbb354554d5625d1bbc2ad">pathname</a>] = <a class="code" href="image_sim_8m.html#acf66413b59082c95cc095f3e1373f608">uigetfile</a>({<span class="stringliteral">&#39;*.img&#39;</span>,<span class="stringliteral">&#39;Wave function&#39;</span>;<span class="stringliteral">&#39;*.*&#39;</span>,<span class="stringliteral">&#39;All files&#39;</span>},<span class="stringliteral">&#39;Select a complex wave function&#39;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(<a class="code" href="convert2cfg_8m.html#a1a3091fb7347c8f640f7b03687dadd44">filename</a>,0) || <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(<a class="code" href="convert2cfg_8m.html#aea8eee85d5cbb354554d5625d1bbc2ad">pathname</a>,0)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        % <a class="code" href="image_sim_8m.html#af6e37fae559389af2ef17f22db79e85c">disp</a>(<span class="stringliteral">&#39;User pressed cancel&#39;</span>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <a class="code" href="convert2cfg_8m.html#a1a3091fb7347c8f640f7b03687dadd44">filename</a> =  fullfile(<a class="code" href="convert2cfg_8m.html#aea8eee85d5cbb354554d5625d1bbc2ad">pathname</a>, <a class="code" href="convert2cfg_8m.html#a1a3091fb7347c8f640f7b03687dadd44">filename</a>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        [<a class="code" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a>,<a class="code" href="image_sim_8m.html#a6fbdf18a87d576fd409fa5a5718ea427">t</a>,<a class="code" href="image_sim_8m.html#a0f78069bbc8a49dd82779a5f3c6abba2">dx</a>,<a class="code" href="image_sim_8m.html#aba04d96942cca2760ed9cf11b382c352">dy</a>,<a class="code" href="image_sim_8m.html#aca46b83ec8f21353a4ff43eb667cd2b6">params</a>,<a class="code" href="image_sim_8m.html#aea4cc4bd8e43a7f8ebf9b0ee3da8d681">comment</a>] = <a class="code" href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">binread2D</a>(filename);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        [<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(<a class="code" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a>);</div>
<div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a251a4ef16ae9f055ad88c14c2597ca43">  412</a></span>&#160;        <a class="code" href="image_sim_8m.html#a251a4ef16ae9f055ad88c14c2597ca43">realFlag</a> = isreal(img);</div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aea4cc4bd8e43a7f8ebf9b0ee3da8d681">  413</a></span>&#160;        <a class="code" href="image_sim_8m.html#aea4cc4bd8e43a7f8ebf9b0ee3da8d681">comment</a> = <span class="keywordtype">char</span>(<a class="code" href="image_sim_8m.html#aea4cc4bd8e43a7f8ebf9b0ee3da8d681">comment</a>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        handles.<a class="code" href="image_sim_8m.html#a2eb1b2c41b2c60683d5d4f9a45893d00">wave0</a> = img;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        handles.<a class="code" href="image_sim_8m.html#a0f78069bbc8a49dd82779a5f3c6abba2">dx</a> = <a class="code" href="image_sim_8m.html#a0f78069bbc8a49dd82779a5f3c6abba2">dx</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aba04d96942cca2760ed9cf11b382c352">  416</a></span>&#160;        handles.<a class="code" href="image_sim_8m.html#aba04d96942cca2760ed9cf11b382c352">dy</a> = <a class="code" href="image_sim_8m.html#aba04d96942cca2760ed9cf11b382c352">dy</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">  417</a></span>&#160;        handles.<a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a> = <a class="code" href="image_sim_8m.html#a6fbdf18a87d576fd409fa5a5718ea427">t</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ~<a class="code" href="aberrations_8m.html#a3e9abce732c52a887bbe428e87d894c1">isempty</a>(<a class="code" href="image_sim_8m.html#aca46b83ec8f21353a4ff43eb667cd2b6">params</a>)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1a479ccf79f439ab6d3cda93f70137bd">length</a>(<a class="code" href="image_sim_8m.html#aca46b83ec8f21353a4ff43eb667cd2b6">params</a>) &gt; 8</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                handles.<a class="code" href="image_sim_8m.html#a8729222064abdba94398e8a2caf0609e">highVoltage</a> = <a class="code" href="image_sim_8m.html#aca46b83ec8f21353a4ff43eb667cd2b6">params</a>(1);</div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">  422</a></span>&#160;                handles.<a class="code" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a> = 1e-7*params(2);</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a095451ad095fab975004df8fa1925cb8">  423</a></span>&#160;                handles.<a class="code" href="image_sim_8m.html#a095451ad095fab975004df8fa1925cb8">Defocus</a> = params(3);</div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa86513d9e6380d2aa6e86ed5fa4bd86a">  424</a></span>&#160;                handles.<a class="code" href="image_sim_8m.html#aa86513d9e6380d2aa6e86ed5fa4bd86a">Astig</a> = 0.01*params(4)*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*params(5));        % astigmatism</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a15f1a96dd5e77ed931110fbb52692049">  425</a></span>&#160;                handles.<a class="code" href="image_sim_8m.html#a15f1a96dd5e77ed931110fbb52692049">Delta</a> = params(6);           % <a class="code" href="image_sim_8m.html#a15f1a96dd5e77ed931110fbb52692049">Delta</a> = Cc * dE_E = focal <a class="code" href="sim_image_from_wave_8m.html#a38bcf55414b93eac67018aee91bed97c">spread</a></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                handles.<a class="code" href="image_sim_8m.html#a4c08b2f6798f294d143d8b233985c10f">Convergence</a> = params(7);        % illumination convergence <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a></div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a9453345457e3f32823308485e91ea707">  427</a></span>&#160;                handles.<a class="code" href="image_sim_8m.html#a9453345457e3f32823308485e91ea707">TiltX</a> = 1e-3*180/pi*params(8);          % beam tilt <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> deg -&gt; rad</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                handles.<a class="code" href="image_sim_8m.html#a2e693f713f9e8de2e4ac5d82f5ebfe4b">TiltY</a> = 1e-3*180/pi*params(9);          % beam tilt <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> deg -&gt; rad</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editAccVoltage,&#39;<a class="code" href="image_sim_8m.html#a75871acd33bd071349a6f2d6cd0aa6b8">String</a>&#39;,handles.<a class="code" href="image_sim_8m.html#a8729222064abdba94398e8a2caf0609e">highVoltage</a>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editAstig1,&#39;String&#39;,10*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.<a class="code" href="image_sim_8m.html#aa86513d9e6380d2aa6e86ed5fa4bd86a">Astig</a>));</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editAstig2,&#39;String&#39;,180/pi*<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.Astig));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDefocus,&#39;String&#39;,0.1*handles.<a class="code" href="image_sim_8m.html#a095451ad095fab975004df8fa1925cb8">Defocus</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editCs,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;%.4<a class="code" href="namespacepython_1_1potential.html#af887b24c78c0630197f05f84f19de90c">f</a>&#39;,1e-7*handles.<a class="code" href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a>));</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editConvAngle,&#39;String&#39;,handles.<a class="code" href="image_sim_8m.html#a4c08b2f6798f294d143d8b233985c10f">Convergence</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDelta,&#39;String&#39;,0.1*handles.<a class="code" href="image_sim_8m.html#a15f1a96dd5e77ed931110fbb52692049">Delta</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editTiltX,&#39;String&#39;,1<a class="code" href="qmb_8m.html#ada985816ea79ac4451f0f552d48090e5">e3</a>*handles.<a class="code" href="image_sim_8m.html#a9453345457e3f32823308485e91ea707">TiltX</a>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editTiltY,&#39;String&#39;,1<a class="code" href="qmb_8m.html#ada985816ea79ac4451f0f552d48090e5">e3</a>*handles.<a class="code" href="image_sim_8m.html#a2e693f713f9e8de2e4ac5d82f5ebfe4b">TiltY</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        % <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(&#39;Pixel <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>: %g <a class="code" href="aberrations_8m.html#a84c455b54a16f1c540f6abcc5b858393">x</a> %g\n&#39;,dx,dy);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editSampling,&#39;String&#39;,0.1*min(dx,dy));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>    </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a6504436723c396eecb451acabced8531">  445</a></span>&#160;handles.<a class="code" href="image_sim_8m.html#a6504436723c396eecb451acabced8531">numWaves</a> = 1;             </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;% <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(gcbo, handles);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> handles = updateKArrays(handles)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;[<a class="code" href="draw_xtal_8m.html#abc26c33960c3103b4dade478795ea82b">h</a>,w] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.<a class="code" href="image_sim_8m.html#a2eb1b2c41b2c60683d5d4f9a45893d00">wave0</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">  452</a></span>&#160;handles.<a class="code" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a>       = 1/(w*handles.dx);</div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a3c8582bd540c65d79e214b39ca67b9ca">  453</a></span>&#160;handles.<a class="code" href="image_sim_8m.html#a3c8582bd540c65d79e214b39ca67b9ca">dky</a>       = 1/(h*handles.dy);</div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">  454</a></span>&#160;<a class="code" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a>  = <a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(handles.<a class="code" href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a>*[-w/2:w/2-1]);</div>
<div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">  455</a></span>&#160;<a class="code" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a>  = <a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(handles.<a class="code" href="image_sim_8m.html#a3c8582bd540c65d79e214b39ca67b9ca">dky</a>*[-h/2:h/2-1].&#39;);</div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">  456</a></span>&#160;handles.<a class="code" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a> = repmat(<a class="code" href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a>,h,1);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;handles.<a class="code" href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">ky2</a> = repmat(<a class="code" href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a>,1,w);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;% handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a> = atan2(handles.<a class="code" href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">ky2</a>,handles.<a class="code" href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;% <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>, handles);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;%%</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;%% Handler for the different checkbox- and edit-controls:</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;%%</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;% --- Executes <a class="code" href="image_sim_8m.html#a454532bd4d96c4531eb16b4052fefbe4">on</a> <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbuttonUpdate.</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> handles = <a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, <a class="code" href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a>, handles)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;% <a class="code" href="_displacement_params_8m.html#ac0005745f18f3ed5d3e2f7943e5243c4">First</a>, we need to retreive the relevant imaging <a class="code" href="draw_xtal_8m.html#aeb6159906f64d5f1b8476454468f5af3">parameters</a></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;handles.MinAmplitude  = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editMinAmplitude,&#39;String&#39;));</div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab7f9e5712021c7e4807a0692ff01fd35">  472</a></span>&#160;handles.<a class="code" href="image_sim_8m.html#ab7f9e5712021c7e4807a0692ff01fd35">MaxPhase</a> = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editMaxPhase,&#39;String&#39;));</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;handles.<a class="code" href="image_sim_8m.html#aea0f936671f7f4f8fdb0dd293e4d6489">Amorph</a>   = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editAmorph,&#39;String&#39;));</div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a8729222064abdba94398e8a2caf0609e">  474</a></span>&#160;handles.highVoltage = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editAccVoltage,&#39;String&#39;));</div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">  475</a></span>&#160;handles.<a class="code" href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">lambda</a>   = wavelength(handles.highVoltage);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.textAccVoltageUnit,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;kV, <a class="code" href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">lambda</a>=%.4f <a class="code" href="fileio__fftw3_8cpp.html#a955f504eccf76b4eb2489c0adab03121">A</a>&#39;,handles.<a class="code" href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">lambda</a>));</div>
<div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">  477</a></span>&#160;% Read Defocus, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;<a class="code" href="image_sim_8m.html#a454532bd4d96c4531eb16b4052fefbe4">on</a>&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxDefocus,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    % convert Defocus from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> to A</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    handles.Defocus = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editDefocus,&#39;String&#39;));</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Defocus=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;% Read Cs, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxCs,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    % convert Cs from mm to A</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    handles.Cs = 1e7*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editCs,&#39;String&#39;));</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Cs=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a67f88f0d593aadb8fec844297e059599">  487</a></span>&#160;% Read <a class="code" href="image_sim_8m.html#a67f88f0d593aadb8fec844297e059599">Tilt</a>, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxTilt,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    % convert Tilt from mrad to rad</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    handles.TiltX = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editTiltX,&#39;String&#39;));</div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a2e693f713f9e8de2e4ac5d82f5ebfe4b">  491</a></span>&#160;    handles.TiltY = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editTiltY,&#39;String&#39;));</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.TiltX=0; handles.TiltY=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxComa,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    % convert <a class="code" href="image_sim_8m.html#a828ae7a797906638d292911b43b14579">Coma</a> from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> and deg to A and rad</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a828ae7a797906638d292911b43b14579">Coma</a> = 1e4*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editComa,&#39;String&#39;)))*...</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editComaAngle,&#39;String&#39;)));</div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a828ae7a797906638d292911b43b14579">  497</a></span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.<a class="code" href="image_sim_8m.html#a828ae7a797906638d292911b43b14579">Coma</a>=0;  <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkbox3foldAstig,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    % convert Coma from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> and deg to A and rad</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    handles.<a class="code" href="image_sim_8m.html#ad1e3f2cce958f10b9f27e568964658f2">Astig3</a> = 1e4*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit3foldAstig,&#39;String&#39;)))*...</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit3foldAstigAngle,&#39;String&#39;)));</div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ad1e3f2cce958f10b9f27e568964658f2">  502</a></span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.<a class="code" href="image_sim_8m.html#ad1e3f2cce958f10b9f27e568964658f2">Astig3</a>=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab83702252d2bea5215e706c2ca46e1cd">  503</a></span>&#160;% Read <a class="code" href="image_sim_8m.html#ab83702252d2bea5215e706c2ca46e1cd">Astigmatism</a>, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxAstig,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    % convert Tilt from mrad to rad</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    handles.Astig = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editAstig1,&#39;String&#39;))*...</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editAstig2,&#39;String&#39;)));</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Astig=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;% Read Delta, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxDelta,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    % convert Cs from mm to A</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    handles.Delta = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editDelta,&#39;String&#39;));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Delta=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">  515</a></span>&#160;% Read Convergence <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkboxConvAngle,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    % convert Cs from mm to A</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4c08b2f6798f294d143d8b233985c10f">  518</a></span>&#160;    handles.Convergence = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.editConvAngle,&#39;String&#39;));</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Convergence=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;% Read objective <a class="code" href="sim_image_from_wave_8m.html#ac11faa037dc9050b7db352519f8f8440">aperture</a> angle:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkbox_ObjAperture,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    % convert angle from mrad to rad</div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ac16e8fafe8788f3b927b805b701ed99c">  523</a></span>&#160;    handles.<a class="code" href="image_sim_8m.html#ac16e8fafe8788f3b927b805b701ed99c">ObjApertureTheta</a> = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit_ObjApertureTheta,&#39;String&#39;));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.<a class="code" href="image_sim_8m.html#ac16e8fafe8788f3b927b805b701ed99c">ObjApertureTheta</a>=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;% Read sample vibration</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.checkbox_Vibration,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    % convert vibration from pm to A:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a617e69bc47c08413dff023b0d0d9d5c6">vibration_Axis1</a> = 0.1*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit_Vibration_Axis1,&#39;String&#39;));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a489e6c7c5e937f378873d423394fa972">vibration_Axis2</a> = 0.1*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit_Vibration_Axis2,&#39;String&#39;));</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    handles.<a class="code" href="image_sim_8m.html#af86ea2576d700f75de9452170bb57912">vibration_Angle</a> = pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(handles.edit_Vibration_Angle,&#39;String&#39;));</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    handles.<a class="code" href="image_sim_8m.html#aea926c42f75577fdf775d6ceda9624bd">applyVibration</a> = 1;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a617e69bc47c08413dff023b0d0d9d5c6">vibration_Axis1</a> = 0;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a489e6c7c5e937f378873d423394fa972">vibration_Axis2</a> = 0;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    handles.<a class="code" href="image_sim_8m.html#af86ea2576d700f75de9452170bb57912">vibration_Angle</a> = 0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    handles.applyVibration = 0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;%% Redraw Images</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;handles = updateImages(handles);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxDefocus.</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxDefocus_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxTilt.</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxTilt_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxComa.</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxComa_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxImage.</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxImage_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxDiffractogram.</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxDiffractogram_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxRealCTF.</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxRealCTF_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxImagCTF.</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxImagCTF_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxDelta.</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxDelta_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkboxConvAngle.</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkboxConvAngle_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkbox_ObjAperture.</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkbox_ObjAperture_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;% Edit <a class="code" href="image_sim_8m.html#a64b52c93bb6e3c8debb644b626e7efab">fields</a>:</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div>
<div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a64b52c93bb6e3c8debb644b626e7efab">  588</a></span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> edit_ObjApertureEdge_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> edit_ObjApertureEdge_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(<a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(hObject,&#39;<a class="code" href="image_sim_8m.html#a97695672c0d89ebbb1074dee2ea2a8d8">BackgroundColor</a>&#39;), <a class="code" href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a>(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;<a class="code" href="image_sim_8m.html#acc4c9367cff2473d08ec9910547865f6">white</a>&#39;);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a902996ad1133218c2e0fb07ae14f43e1">edit_ObjApertTheta_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> edit_ObjApertTheta_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#afd622fdcc9bd74c4ed8747bf95ead848">editDefocus_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editDefocus_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a191987812b92b9fcd02f8be84cce361a">editCs_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editCs_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a1540bbd753c65267f505c582c9aeeea3">editAstig1_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editAstig1_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a26f9d2ec21a10a798d9d570aacf4ac76">editAstig2_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editAstig2_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a3dc72fa3ba37b0cc1cca1106056f14e8">editCurv1_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editCurv1_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a0953e540f68f10487a54cbd0c1486018">editDelta_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editDelta_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a7dd200a5828d901e0b3b7a938a70fb51">editConvAngle_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editConvAngle_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a734abb80403ebc18458d4672fa1b1ce0">editPincushion_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editPincushion_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a37910ddf751768ef7b70134a17ebaf4d">editSpiral_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editSpiral_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#accad547592c29b16895e9ebe9615b0d9">editSampling_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;%handles.dx = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(hObject,&#39;String&#39;));</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;%handles = updateKArrays(handles);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;%<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editSampling_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a179337ab4a7025901f7997d2b6f0388a">editAccVoltage_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editAccVoltage_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a533ceb9f1e84fa11ea7109b5be40f26e">editTiltX_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editTiltX_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a916cff68d78d7f25dd9a2c684ca8d4f6">editTiltY_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editTiltY_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#aff5b347ee7496bd631093b761e4a1316">editComa_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editComa_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobuttonWave.</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> radiobuttonWave_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,&#39;<a class="code" href="image_sim_8m.html#a7ae766fd74a0a4159d106a3d0647fb49">XLimMode</a>&#39;,&#39;<a class="code" href="image_sim_8m.html#ad73a4d380561ec4b316f4532b70d90a2">auto</a>&#39;);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;handles.<a class="code" href="image_sim_8m.html#a589b13a90e011e72db96b891b65da911">initialized</a> = 0;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobuttonCTF.</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> radiobuttonCTF_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesAmplitude,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesPhase,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;handles.initialized = 0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobuttonImage.</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> radiobuttonImage_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.<a class="code" href="image_sim_8m.html#abff58742c346a246952566cf5aa5fbb0">diffractogramMode</a>)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    handles.initialized = 0;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;handles.<a class="code" href="image_sim_8m.html#abff58742c346a246952566cf5aa5fbb0">diffractogramMode</a> = 0;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobuttonDiffractogram.</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> radiobuttonDiffractogram_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.diffractogramMode == 0)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    handles.initialized = 0;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;handles.diffractogramMode = 1;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobutton_WaveAmplitude.</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> radiobutton_WaveAmplitude_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;%<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.diffractogramMode)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;%    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;%    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;%    handles.initialized = 0;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;%<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;%handles.diffractogramMode = 0;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.diffractogramMode == 0)</div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a7ae766fd74a0a4159d106a3d0647fb49">  801</a></span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    handles.initialized = 0;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;handles.diffractogramMode = 1;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobutton_WavePhase.</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> radiobutton_WavePhase_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.diffractogramMode)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.axesImage,&#39;XLimMode&#39;,&#39;auto&#39;);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    handles.initialized = 0;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;handles.diffractogramMode = 0;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;handles.initialized = 0;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#aae2323afde46f03e269fa200b961ee3e">editMinAmplitude_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editMinAmplitude_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a861663adf18d48ac8dec574d9dbf4c6e">editMaxPhase_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editMaxPhase_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a59b957ee37120fefdb602bc6a0cd242e">editAmorph_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editAmorph_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#acab7fb886236454279b8a82dffe94cf2">editComaAngle_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> editComaAngle_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkbox3foldAstig.</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> checkbox3foldAstig_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a29e8f69ee879d91442e854b359650abe">edit3foldAstig_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> edit3foldAstig_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#aeadc3c4bb8c4d028b7ff79c58f5038e6">edit3foldAstigAngle_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> edit3foldAstigAngle_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#ac953f65c4c7e5bd28b7ef53a5d8ebef2">edit_DefStep_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a86f0cd0012491485fb7a7a97b224e03f">edit_DefStep_CreateFcn</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00907"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a97695672c0d89ebbb1074dee2ea2a8d8">  907</a></span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00908"></a><span class="lineno"><a class="line" href="image_sim_8m.html#acc4c9367cff2473d08ec9910547865f6">  908</a></span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#ac208db9151fd331be3a084b3fa236031">edit_DefCount_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#a924408856d2b35b39987e1b0cd0aed63">edit_DefCount_CreateFcn</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a65f709f494ec1ade7529677dab572f58">  925</a></span>&#160;% --- Executes on selection change <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="code" href="image_sim_8m.html#a0c37f92496b0fdd29568d2891e681bad">listbox1</a>.</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> listbox1_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;% Hints: contents = get(hObject,&#39;String&#39;) returns <a class="code" href="image_sim_8m.html#a0c37f92496b0fdd29568d2891e681bad">listbox1</a> contents as <a class="code" href="_read_d_m3___matlab_8m.html#a788f12e84a4147fbec966d469221fb80">cell</a> <a class="code" href="convert2cfg_8m.html#a7cec22fd326288e5df0dadf886d5d919">array</a></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;%        contents{<span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>,<span class="stringliteral">&#39;Value&#39;</span>)} returns <a class="code" href="qstem_8m.html#aa6941f884e278157f98a91b064426421">selected</a> item from <a class="code" href="image_sim_8m.html#a0c37f92496b0fdd29568d2891e681bad">listbox1</a></div>
<div class="line"><a name="l00929"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a0c37f92496b0fdd29568d2891e681bad">  929</a></span>&#160;[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.wave0);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">switch</span> <span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">case</span> 1</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a> = <a class="code" href="read_c_f_g__qstem_8m.html#a85162b5d5e6736f5aa8616580d4e8a75">sum</a>(imread(<span class="stringliteral">&#39;amplitude.jpg&#39;</span>),3);</div>
<div class="line"><a name="l00933"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">  933</a></span>&#160;        <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a> = <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>));</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        handles.wave0 = <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>.*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.wave0));        </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">case</span> 2</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a> = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>(<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2)+1,<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2)+1) = 1;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.wave0);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        handles.wave0 = <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>.*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>);       </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">case</span> 3</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a> = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>(<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2)+1,<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2)+1+<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>([-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/4 <a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/4])) = 1;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.wave0);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        handles.wave0 = <a class="code" href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a>.*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>);       </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> listbox1_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;% --- Executes on selection change <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> listbox2.</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> listbox2_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.wave0);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keywordflow">switch</span> <span class="keyword">get</span>(<a class="code" href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a>,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">case</span> 1</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="read_c_f_g__qstem_8m.html#a85162b5d5e6736f5aa8616580d4e8a75">sum</a>(imread(<span class="stringliteral">&#39;phase.jpg&#39;</span>),3);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        % normalize the <a class="code" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a> <a class="code" href="image_sim_8m.html#aa4f166fe617bcfd58e6c02d41f03c118">intensities</a>:</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>))-0.5;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        handles.wave0 = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.wave0).*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">case</span> 2</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>(<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2)+1,<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2)+1) = 1;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>))-0.5;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        handles.wave0 = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.wave0).*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*<a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">case</span> 3 % 2 delta <a class="code" href="image_sim_8m.html#a5c06813fe91f99a63a998aa2b4e6335d">functions</a></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a> = <a class="code" href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>(<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2)+1,<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2)+1+<a class="code" href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a>([-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/4 <a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/4])) = 1;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        img2 = img2/<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(img2))-0.5;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        handles.wave0 = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.wave0).*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*img2);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> listbox2_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbutton_ThicknessDefocusSeries.</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> pushbutton_ThicknessDefocusSeries_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;[filename, pathname] = <a class="code" href="image_sim_8m.html#acf66413b59082c95cc095f3e1373f608">uigetfile</a>(&#39;*.img&#39;, &#39;Select <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> of wave <a class="code" href="image_sim_8m.html#a5c06813fe91f99a63a998aa2b4e6335d">functions</a>&#39;,&#39;MultiSelect&#39;,&#39;on&#39;);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;filename</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;% <a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a> the number of files that has been <a class="code" href="qstem_8m.html#aa6941f884e278157f98a91b064426421">selected</a></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#af7022c931e47482f063cae1ddf540e7e">iscell</a>(filename)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    handles.numWaves = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(filename,2);</div>
<div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a0d5f64d7b88fb6a504daba91fde8e4d1">  998</a></span>&#160;    handles.<a class="code" href="image_sim_8m.html#a0d5f64d7b88fb6a504daba91fde8e4d1">waveNames</a> = filename;</div>
<div class="line"><a name="l00999"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a1508b4021830d267a270e2067f89550d">  999</a></span>&#160;    handles.<a class="code" href="image_sim_8m.html#a1508b4021830d267a270e2067f89550d">wavePath</a> = pathname;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(&#39;Will process %<a class="code" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a> wave <a class="code" href="image_sim_8m.html#a5c06813fe91f99a63a998aa2b4e6335d">functions</a>\n&#39;,handles.numWaves);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (<a class="code" href="aberrations_8m.html#a3e9abce732c52a887bbe428e87d894c1">isempty</a>(filename))</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(&#39;<a class="code" href="aberrations_8m.html#aa2fa5ea275f5d08a1f7ca407861c4be1">No</a> <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a> <a class="code" href="qstem_8m.html#aa6941f884e278157f98a91b064426421">selected</a>!\n&#39;);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <a class="code" href="convert2cfg_8m.html#a9717e7bbecb906637e86cef6da3d83c2">return</a></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    handles.numWaves = 1;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (<a class="code" href="qmb_8m.html#acb0bf34e5a38d0484b1e3e24b8106f52">strcmp</a>(filename,&#39;wave_0_0.img&#39;) == 1)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        handles.numWaves = -1;  % let the user define number of thicknesses and TDS runs</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01010"></a><span class="lineno"><a class="line" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8"> 1010</a></span>&#160;    [img,t,dx,dy,params,comment] = <a class="code" href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">binread2D</a>(fullfile(pathname,filename));</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    handles.wave0 = img;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    handles.dx = dx;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    handles.dy = dy;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a> = t;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    handles.<a class="code" href="image_sim_8m.html#a1508b4021830d267a270e2067f89550d">wavePath</a> = pathname;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<a class="code" href="image_sim_8m.html#aa68874ba31f8ae452ff865792a1961b7">pushbutton_FocSeries_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbutton_saveImg.</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> pushbutton_saveImg_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;% hObject    handle to pushbutton_saveImg (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;% eventdata  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;% handles    structure with handles and user data (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GUIDATA)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;[filename, pathname] = <a class="code" href="image_sim_8m.html#a232f589ad3de91372ee1b484cbe9e209">uiputfile</a>(&#39;*.img&#39;, &#39;Save <a class="code" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a> as&#39;);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(filename,0) <a class="code" href="convert2cfg_8m.html#a9717e7bbecb906637e86cef6da3d83c2">return</a>; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.wave0);</div>
<div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422"> 1030</a></span>&#160;<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a> = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editSampling,&#39;String&#39;));</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;handles = <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;dx = handles.dx;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;dy = handles.dy;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;handles = updateImages(handles);</div>
<div class="line"><a name="l01037"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10"> 1037</a></span>&#160;img = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.<a class="code" href="image_sim_8m.html#aa8f31224617f37bdccf7d77eef73a4a3">Psi</a>).^2;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Vibration,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    kx2 = handles.kx2;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    ky2 = handles.ky2;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>  = (kx2.^2+ky2.^2);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>     = atan2(ky2,kx2);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div>
<div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb"> 1044</a></span>&#160;    <a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a> = (pi*handles.vibration_Axis1/(-log(0.5))).^2;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    vib2 = (pi*handles.vibration_Axis2/(-log(0.5))).^2;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.radiobutton_FluxPreserving,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        img = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(img).*handles.<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>.*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        img = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(img).*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.radiobutton_FluxPreserving,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        img = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(img).*handles.<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>));</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Sampling,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <a class="code" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a> = round((<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1)*dx/<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>)+1;</div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9"> 1061</a></span>&#160;    <a class="code" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a> = round((Ny-1)*dy/sampling)+1;</div>
<div class="line"><a name="l01062"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425"> 1062</a></span>&#160;    <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a> = sampling*[0:<a class="code" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a>-1];</div>
<div class="line"><a name="l01063"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d"> 1063</a></span>&#160;    <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a> = sampling*[0:<a class="code" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a>-1];</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) &gt; dx*(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1), <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) = dx*(Nx-1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) &gt; dy*(Ny-1), <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) = dy*(Ny-1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    img2 = interp2(dx*[0:Nx-1],dy*[0:Ny-1].&#39;,img,<a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>,<a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>.&#39;,&#39;linear&#39;,0);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Counts,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_ImgCounts,&#39;String&#39;));</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        img2 = cnts*img2+sqrt(cnts*img2).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(img2));</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        img2(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(img2 &lt; 0)) = 0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(img2,fullfile(pathname, filename),sampling,sampling,handles.<a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a>,0,0);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>    </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Counts,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_ImgCounts,&#39;String&#39;));</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        img = cnts*img+sqrt(cnts*img).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(img));</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        img(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(img &lt; 0)) = 0;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(img,fullfile(pathname, filename),dx,dy,handles.thickness,0,0);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbutton_FocSeries.</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> <a class="code" href="image_sim_8m.html#aa68874ba31f8ae452ff865792a1961b7">pushbutton_FocSeries_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;folder = <a class="code" href="image_sim_8m.html#aaa93f32e31a2b6945d6aa1acbf541f0e">uigetdir</a>(&#39;&#39;, &#39;Select the target folder&#39;);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(folder,0) return; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;[Ny,Nx] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.wave0);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxDefocus,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;,1);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;% convert Defocus from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> to A</div>
<div class="line"><a name="l01099"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a85be494f1d6cfae73a7661fcbf449178"> 1099</a></span>&#160;<a class="code" href="image_sim_8m.html#a85be494f1d6cfae73a7661fcbf449178">defocus0</a> = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editDefocus,&#39;String&#39;));</div>
<div class="line"><a name="l01100"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198"> 1100</a></span>&#160;<a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> = round(<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_DefCount,&#39;String&#39;)));</div>
<div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec"> 1101</a></span>&#160;<a class="code" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a>  = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_DefStep,&#39;String&#39;));</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;sampling = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editSampling,&#39;String&#39;));</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;handles = <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;dx = handles.dx;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;dy = handles.dy;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>  = (handles.kx2.^2+handles.ky2.^2);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a> = atan2(handles.ky2,handles.kx2);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div>
<div class="line"><a name="l01110"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522"> 1110</a></span>&#160;<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> = 0;</div>
<div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a28e5a7d765c6f5094ae1e07079195c41"> 1111</a></span>&#160;<a class="code" href="image_sim_8m.html#a28e5a7d765c6f5094ae1e07079195c41">Nthickness</a> = handles.numWaves;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.numWaves &lt; 0)  % means, we have read the first wave of <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> TDS series</div>
<div class="line"><a name="l01113"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ac33b6f8c6739912256ac5fd377d543b6"> 1113</a></span>&#160;    <a class="code" href="image_sim_8m.html#ac33b6f8c6739912256ac5fd377d543b6">prompt</a>={<span class="stringliteral">&#39;Number of thicknesses (&gt;=1):&#39;</span>,<span class="stringliteral">&#39;Number of TDS runs (&gt;=0):&#39;</span>};</div>
<div class="line"><a name="l01114"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151"> 1114</a></span>&#160;    <a class="code" href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151">name</a>=<span class="stringliteral">&#39;Select range of frames for Video output&#39;</span>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"><a class="line" href="image_sim_8m.html#af2f323caad11c790b60b05a6916887c3"> 1115</a></span>&#160;    <a class="code" href="image_sim_8m.html#af2f323caad11c790b60b05a6916887c3">numlines</a>=1;</div>
<div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a75180f3a56b12e0ea7561b96f5583f33"> 1116</a></span>&#160;    <a class="code" href="image_sim_8m.html#a75180f3a56b12e0ea7561b96f5583f33">defaultanswer</a>={<span class="charliteral">&#39;1&#39;</span>,<span class="charliteral">&#39;0&#39;</span>};</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a8c4d9ee8d4f82d724070b97e70b9c4e5"> 1118</a></span>&#160;    <a class="code" href="image_sim_8m.html#a8c4d9ee8d4f82d724070b97e70b9c4e5">answer</a>=inputdlg(<a class="code" href="image_sim_8m.html#ac33b6f8c6739912256ac5fd377d543b6">prompt</a>,<a class="code" href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151">name</a>,<a class="code" href="image_sim_8m.html#af2f323caad11c790b60b05a6916887c3">numlines</a>,<a class="code" href="image_sim_8m.html#a75180f3a56b12e0ea7561b96f5583f33">defaultanswer</a>);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="image_sim_8m.html#a28e5a7d765c6f5094ae1e07079195c41">Nthickness</a> = <a class="code" href="image_sim_8m.html#a07be7620fe0b9f26017a975773b41995">str2num</a>(cell2mat(<a class="code" href="image_sim_8m.html#a8c4d9ee8d4f82d724070b97e70b9c4e5">answer</a>(1)));</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> = <a class="code" href="image_sim_8m.html#a07be7620fe0b9f26017a975773b41995">str2num</a>(cell2mat(<a class="code" href="image_sim_8m.html#a8c4d9ee8d4f82d724070b97e70b9c4e5">answer</a>(2)));</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    </div>
<div class="line"><a name="l01123"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1"> 1123</a></span>&#160;<span class="keywordflow">for</span> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> = 0:<a class="code" href="image_sim_8m.html#a28e5a7d765c6f5094ae1e07079195c41">Nthickness</a>-1</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.numWaves &gt; 1)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5">filenameT</a> = fullfile(handles.<a class="code" href="image_sim_8m.html#a1508b4021830d267a270e2067f89550d">wavePath</a>,handles.<a class="code" href="image_sim_8m.html#a0d5f64d7b88fb6a504daba91fde8e4d1">waveNames</a>{<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>+1});</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;       % read the wave <span class="keyword">function</span>:</div>
<div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a6fbdf18a87d576fd409fa5a5718ea427"> 1127</a></span>&#160;       [newWave,t,dx,dy,params,comment] = <a class="code" href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">binread2D</a>(<a class="code" href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5">filenameT</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;       handles.wave0 = newWave;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;       handles.dx = <a class="code" href="image_sim_8m.html#a0f78069bbc8a49dd82779a5f3c6abba2">dx</a>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;       handles.dy = <a class="code" href="image_sim_8m.html#aba04d96942cca2760ed9cf11b382c352">dy</a>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;       handles.thickness = <a class="code" href="image_sim_8m.html#a6fbdf18a87d576fd409fa5a5718ea427">t</a>;        </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;       <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Processing wave %s at thickness %.1fnm\n&#39;</span>,<a class="code" href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5">filenameT</a>,0.1*t);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    elseif handles.numWaves &lt; 0</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Thickness index: %d\n&#39;</span>,<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>);       </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">for</span> <a class="code" href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a>=0:<a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a>-1</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a> = <a class="code" href="image_sim_8m.html#a85be494f1d6cfae73a7661fcbf449178">defocus0</a>+idf*<a class="code" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDefocus,<span class="stringliteral">&#39;String&#39;</span>,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        handles.Defocus = 10*<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">for</span> itds=0:<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a>-1,0)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> &gt; 0</div>
<div class="line"><a name="l01144"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5"> 1144</a></span>&#160;                <a class="code" href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5">filenameT</a> = fullfile(handles.<a class="code" href="image_sim_8m.html#a1508b4021830d267a270e2067f89550d">wavePath</a>,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;wave_%d_%<a class="code" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a>.img&#39;,itds,<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>));</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                % read the wave <a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a>:</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                [newWave,t,dx,dy,params,comment] = <a class="code" href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">binread2D</a>(<a class="code" href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5">filenameT</a>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                handles.wave0 = newWave;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                handles.dx = dx;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                handles.dy = dy;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                handles.<a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a> = t;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                % <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(&#39;Processing wave %<a class="code" href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a> at <a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a> %.1fnm\n&#39;,filenameT,0.1*t);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>                  </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            handles = updateImages(handles);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            % handles = <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            img = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.<a class="code" href="image_sim_8m.html#aa8f31224617f37bdccf7d77eef73a4a3">Psi</a>).^2;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Vibration,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                <a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a> = (pi*handles.vibration_Axis1/(-log(0.5))).^2;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                vib2 = (pi*handles.vibration_Axis2/(-log(0.5))).^2;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.radiobutton_FluxPreserving,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                    img = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(img).*handles.<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>.*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));                    </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                <a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    img = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(img).*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.radiobutton_FluxPreserving,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                    img = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(img).*handles.<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>));</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            </div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="image_sim_8m.html#accfa32fc89ba0b38e0504d8b8a0a6f54"> 1172</a></span>&#160;            % resample the <a class="code" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a>, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#accfa32fc89ba0b38e0504d8b8a0a6f54">requested</a>:</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Sampling,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;)</div>
<div class="line"><a name="l01174"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9"> 1174</a></span>&#160;                <a class="code" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a> = round((<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1)*dx/<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>)+1;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                <a class="code" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a> = round((<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1)*dy/sampling)+1;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a> = sampling*[0:<a class="code" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a>-1];</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a> = sampling*[0:<a class="code" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a>-1];</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) &gt; dx*(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1), <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) = dx*(Nx-1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) &gt; dy*(<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1), <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) = dy*(Ny-1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                img2 = interp2(dx*[0:Nx-1],dy*[0:Ny-1].&#39;,img,<a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>,<a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>.&#39;,&#39;linear&#39;,0);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                img = img2;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> (handles.numWaves &gt; 1)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    % extract <a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a> <a class="code" href="convert2cfg_8m.html#ab8735b00764542f758cab8113c52b8ec">index</a> from wave <a class="code" href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151">name</a>:</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    <a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a> = handles.<a class="code" href="image_sim_8m.html#a0d5f64d7b88fb6a504daba91fde8e4d1">waveNames</a>{it+1};</div>
<div class="line"><a name="l01187"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a"> 1187</a></span>&#160;                    <a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a> = <a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a>(6:<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>-4);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> == 1</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                        <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%s.img&#39;</span>,folder,<a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a>);                        </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc"> 1191</a></span>&#160;                        <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%s_%d.img&#39;</span>,folder,<a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a>,idf);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Image %s (thickness=%.1f nm, def=%g nm):  &#39;</span>,<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,0.1*handles.thickness,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);                    </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> == 0)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> == 1</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                            <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img.img&#39;</span>,folder);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                            <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%d.img&#39;</span>,folder,idf);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                        <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Image %d (def=%gnm):  &#39;</span>,idf,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                        <span class="keywordflow">if</span> (itds == 0)</div>
<div class="line"><a name="l01204"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5"> 1204</a></span>&#160;                            <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Thickness = %.1f nm, def = %g nm) ... \n    ... &#39;</span>,0.1*handles.thickness,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Counts,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                    cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(handles.edit_ImgCounts,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    img2 = cnts*img2+sqrt(cnts*img2).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(img2));</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(img2 &lt; 0)) = 0;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> == 0)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(img2,<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>,<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>,handles.thickness,0,0);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                    </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                   <span class="keywordflow">if</span> (itds == 0)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                       <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a> = <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8"> 1221</a></span>&#160;                       <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a> = <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a>+img2;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                   <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Counts,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                    cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(handles.edit_ImgCounts,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    img = cnts*img+sqrt(cnts*img).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(img));</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                    <a class="code" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(img &lt; 0)) = 0;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                <span class="keywordflow">if</span> (handles.numWaves &gt; 1)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                    <a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a> = handles.waveNames{<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>+1};</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                    <a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a> = <a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a>(6:<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>-4);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                    <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> == 1</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                        <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%s.img&#39;</span>,folder,<a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a>);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                        <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%s_%d.img&#39;</span>,folder,<a class="code" href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a>,idf);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Image %s (thickness=%.1fnm, def=%gnm):  &#39;</span>,<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,0.1*handles.thickness,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                    <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> == 1</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                        <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img.img&#39;</span>,folder);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                        <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%d.img&#39;</span>,folder,idf);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>                    </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;Image %d (def=%gnm):  &#39;</span>,idf,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> == 0)</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                    <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(img,<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,dx,dy,handles.thickness,0,0);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                   <span class="keywordflow">if</span> (itds == 0)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                       <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a> = <a class="code" href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a>;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                       <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a> = <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a>+img2;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                   <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>            </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> % <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> of TDS loop</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a> &gt; 0)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;           <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a> = <a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a>/<a class="code" href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;           <span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> == 1</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;               <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%d.img&#39;</span>,folder,<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;           <span class="keywordflow">else</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;               <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> = <a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%s\\img_%d_%d.img&#39;</span>,folder,<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>,idf);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;           <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;           <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;TDS-Image img_%d_%d.img (thickness=%.1fnm, def=%gnm):  &#39;</span>,<a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a>,idf,0.1*handles.thickness,<a class="code" href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;           <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Sampling,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;               <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(<a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a>,<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>,<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>,handles.thickness,0,0);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;           <span class="keywordflow">else</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;               <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(<a class="code" href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a>,<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,dx,dy,handles.thickness,0,0);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;           <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> % <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> of <a class="code" href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a> loop</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> % <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a> of <a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a> loop</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDefocus,<span class="stringliteral">&#39;String&#39;</span>,<a class="code" href="image_sim_8m.html#a85be494f1d6cfae73a7661fcbf449178">defocus0</a>);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;clear img</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbutton_NewWindow.</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> pushbutton_NewWindow_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;handles = <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;%    handles = updateImages(handles);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;[Ny,Nx] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.wave0);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<a class="code" href="image_sim_8m.html#a391e34f2de441d79152a7b3d6e4c9c86">figure</a>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a8fa675eb2fcec5b95d9d21c670da7f30"> 1289</a></span>&#160;% <a class="code" href="image_sim_8m.html#a8fa675eb2fcec5b95d9d21c670da7f30">ax</a> = gca;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobuttonImage,<span class="stringliteral">&#39;Value&#39;</span>)  </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    % show the <a class="code" href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    simIm = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi).^2;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Vibration,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a> = (pi*handles.vibration_Axis1/(-log(0.5))).^2;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        vib2 = (pi*handles.vibration_Axis2/(-log(0.5))).^2;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_FluxPreserving,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            simIm = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(simIm).*handles.Espat.*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            simIm = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(simIm).*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)))));</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_FluxPreserving,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            simIm = <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a>(ifft2(fft2(simIm).*handles.Espat));</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Counts,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        cnts = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(<span class="keyword">get</span>(handles.edit_ImgCounts,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        simIm = cnts*simIm+sqrt(cnts*simIm).*randn(<a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(simIm));</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <a class="code" href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a>(<a class="code" href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a>(simIm &lt; 0)) = 0;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],simIm);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;Image t=%.1f nm [%.2f .. %.2f]&#39;</span>,0.1*handles.thickness,min(min(simIm)),<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(simIm))));</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;elseif <span class="keyword">get</span>(handles.radiobutton_WaveAmplitude,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    simIm = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],simIm);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;Amplitude t=%.1f nm [%.2f .. %.2f]&#39;</span>,0.1*handles.thickness,min(min(simIm)),<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(simIm))));</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;elseif <span class="keyword">get</span>(handles.radiobutton_WavePhase,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    simIm = <a class="code" href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a>(handles.Psi);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],simIm);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;Phase t=%.1f nm [%.2f .. %.2f]&#39;</span>,0.1*handles.thickness,min(min(simIm)),<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(<a class="code" href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a>(simIm))));</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    simIm = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi).^2;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    % show the diffractogram</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.radiobutton_FluxPreserving,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        diffg = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(fft2(simIm).*<a class="code" href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a>);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        diffg = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(fft2(simIm));</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">if</span> <span class="keyword">get</span>(handles.checkbox_Vibration,<span class="stringliteral">&#39;Value&#39;</span>)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a> = (pi*handles.vibration_Axis1/(-log(0.5))).^2;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        vib2 = (pi*handles.vibration_Axis2/(-log(0.5))).^2;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        diffg = diffg.*exp(-<a class="code" href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a>*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(cos(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle))-vib2*<a class="code" href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a>.*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(sin(<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>-handles.vibration_Angle)));</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    diffg = log(1+diffg);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <a class="code" href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a>(1,1) = 0;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dkx*10*[-<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>/2-1],handles.dky*10*[-<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>/2-1],<a class="code" href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a>(diffg));</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <a class="code" href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a>(<span class="stringliteral">&#39;Diffractogram (log scale)&#39;</span>);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;% <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(handles.dx/10*[0:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1],handles.dy/10*[0:<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1],<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Psi).^2,<span class="stringliteral">&#39;Parent&#39;</span>,gca);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<a class="code" href="image_sim_8m.html#af56c95f61621bf9779137b38fcb3e0fd">colormap</a>(<span class="stringliteral">&#39;gray&#39;</span>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(gca,<span class="stringliteral">&#39;YDir&#39;</span>,<span class="stringliteral">&#39;normal&#39;</span>);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">get</span>(handles.radiobuttonDiffractogram,<span class="stringliteral">&#39;Value&#39;</span>) == 0)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <a class="code" href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a>(<span class="stringliteral">&#39;x in nm&#39;</span>);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a>(<span class="stringliteral">&#39;y in nm&#39;</span>);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <a class="code" href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a>(<span class="stringliteral">&#39;x in 1/nm&#39;</span>);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <a class="code" href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a>(<span class="stringliteral">&#39;y in 1/nm&#39;</span>);    </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="image_sim_8m.html#aec0a4fa5ed0e46b2a0a8fb27d295274d"> 1352</a></span>&#160;<a class="code" href="image_sim_8m.html#aec0a4fa5ed0e46b2a0a8fb27d295274d">colorbar</a>;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbutton_Scherzer.</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<a class="code" href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a> pushbutton_Scherzer_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;handles.Cs = <a class="code" href="image_sim_8m.html#a07be7620fe0b9f26017a975773b41995">str2num</a>(get(handles.editCs,&#39;String&#39;));</div>
<div class="line"><a name="l01358"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a4980ffdb4105ec5cb708d21491f752a1"> 1358</a></span>&#160;handles.AccVoltage = <a class="code" href="image_sim_8m.html#a07be7620fe0b9f26017a975773b41995">str2num</a>(<span class="keyword">get</span>(handles.editAccVoltage,<span class="stringliteral">&#39;String&#39;</span>));</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;handles.Defocus = -0.1*sign(handles.Cs)*sqrt(1.5*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Cs)*1e7*wavelength(handles.<a class="code" href="image_sim_8m.html#a4980ffdb4105ec5cb708d21491f752a1">AccVoltage</a>));</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Defocus) &gt; 1</div>
<div class="line"><a name="l01362"></a><span class="lineno"><a class="line" href="image_sim_8m.html#a75871acd33bd071349a6f2d6cd0aa6b8"> 1362</a></span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDefocus,<span class="stringliteral">&#39;String&#39;</span>,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%.1f&#39;</span>,handles.Defocus));    </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDefocus,<span class="stringliteral">&#39;String&#39;</span>,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(<span class="stringliteral">&#39;%.4f&#39;</span>,handles.Defocus));</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div>
<div class="line"><a name="l01372"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab6f3c269fc46c9c1c0f81b3431240138"> 1372</a></span>&#160;% <span class="keyword">function</span> [img,t,dx,dy] = <a class="code" href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">binread2D</a>(<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,flag)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;% <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a> <span class="keywordflow">for</span> reading binary data of different formats</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;% input: </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;% <a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a> - <a class="code" href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151">name</a> of <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a> (string)</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;% <a class="code" href="_read_d_m3___matlab_8m.html#a9b0b6d24f95658a64d11e8d57d2c1c7d">printFlag</a> - 0: non-verbose, 1: verbose (default)</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;% flag: for overriding file flags.</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;% output:</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;% img      - image (complex or <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;% t        - <a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;% dx, dy   - pixel <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a> (for calibration)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;function [img,t,dx,dy,params,comment] = binread2D(<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,<a class="code" href="_read_d_m3___matlab_8m.html#a9b0b6d24f95658a64d11e8d57d2c1c7d">printFlag</a>,flag)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;headerlength = 4;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="keywordflow">if</span> <a class="code" href="convert2cfg_8m.html#a7f9b12e953d2678415a3d421f36ae4d6">nargin</a> &lt; 2</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <a class="code" href="_read_d_m3___matlab_8m.html#a9b0b6d24f95658a64d11e8d57d2c1c7d">printFlag</a> = 0;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;% <a class="code" href="_read_d_m3___matlab_8m.html#aa8ef7bba54ee37a8beab56f5091c552f">open</a> the <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a> and define the <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a> ID (<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>):</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>=fopen(<a class="code" href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a>,<span class="stringliteral">&#39;r&#39;</span>,<span class="stringliteral">&#39;ieee-le&#39;</span>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;% header = [headersize(bytes) paramSize commentSize Nx Ny complFlag doubleFlag dataSize version]</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;header = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,8,<span class="stringliteral">&#39;int32&#39;</span>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a> = header(5);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a> = header(4);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;t = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,1,<span class="stringliteral">&#39;float64&#39;</span>);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;dx = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,1,<span class="stringliteral">&#39;float64&#39;</span>);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;dy = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,1,<span class="stringliteral">&#39;float64&#39;</span>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;% read additional <a class="code" href="draw_xtal_8m.html#aeb6159906f64d5f1b8476454468f5af3">parameters</a> from <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a>, <span class="keywordflow">if</span> any exist:</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;paramSize = header(2);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="keywordflow">if</span> (paramSize &gt; 0)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    params = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,paramSize,<span class="stringliteral">&#39;float64&#39;</span>);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    % params</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;   params = []; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;% read comments from <a class="code" href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a>, <span class="keywordflow">if</span> any exist:</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;commentSize = header(3);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="keywordflow">if</span> (commentSize &gt; 0)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    comment = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,commentSize,<span class="stringliteral">&#39;char&#39;</span>).<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="stringliteral">    % comment(commentSize+1) = 0;</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="stringliteral">    % fprintf(&#39;</span>Comment: %s\n<span class="stringliteral">&#39;,comment);</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="stringliteral">else </span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="stringliteral">    comment = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="stringliteral">end</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="stringliteral">    % flag = 0;</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="stringliteral">integerFlag = 0;</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="stringliteral">complexFlag = header(6);</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="stringliteral">doubleFlag = (header(7) == 8*(complexFlag+1));</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="stringliteral">if (nargin &lt;3)</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="stringliteral">    flag = integerFlag+doubleFlag*4+complexFlag*2;    </span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="stringliteral">end</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="stringliteral">% fprintf(&#39;</span>Header Size: %dbytes, t: %g, dx: %g, dy: %g\n<span class="stringliteral">&#39;,header(1),t,dx,dy);</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="stringliteral">% bit 2: double</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="stringliteral">% bit 1: complex</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="stringliteral">% bit 0: integer</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="stringliteral">if printFlag</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="stringliteral">    fprintf(&#39;</span><a class="code" href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">binread2D</a> %<a class="code" href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a>: %<a class="code" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a> <a class="code" href="aberrations_8m.html#a84c455b54a16f1c540f6abcc5b858393">x</a> %<a class="code" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a> <a class="code" href="qmb_8m.html#a76d164d39acada2c40fd4397c2715217">pixels</a> flag = %<a class="code" href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a> (<span class="stringliteral">&#39;,fileName,Nx,Ny,flag);</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="stringliteral">end</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="stringliteral">switch bitand(flag,7)</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="stringliteral">case 0</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="stringliteral">    complexFlag = 0;</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="stringliteral">    doubleFlag = 0;</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="stringliteral">    if printFlag</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="stringliteral">        fprintf(&#39;</span>32-bit <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a> data, %.3fMB)\n<span class="stringliteral">&#39;,Nx*Ny*4/1048576);</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="stringliteral">    end</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="stringliteral">    img = fread(fid,[Ny,Nx],&#39;</span>float32<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="stringliteral">case 4</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="stringliteral">    complexFlag = 0;</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="stringliteral">    doubleFlag = 1;</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="stringliteral">    if printFlag</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="stringliteral">    fprintf(&#39;</span>64-bit <a class="code" href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a> data, %.3fMB)\n&#39;,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*8/1048576);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    img = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>],<span class="stringliteral">&#39;float64&#39;</span>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="keywordflow">case</span> 2</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    complexFlag = 1;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="binwrite2_d_8m.html#ae26e11ce032ccbede51aab16318e9ac8">doubleFlag</a> = 0;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">if</span> printFlag</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;32-bit complex data, %.3fMB)\n&#39;</span>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*8/1048576);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    % img = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,[<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>,2*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>],<span class="stringliteral">&#39;float32&#39;</span>);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    % img = <a class="code" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a>(1:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>,1:2:2*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1)+<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*img(1:Nx,2:2:2*Ny);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    img = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,[2*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>],<span class="stringliteral">&#39;float32&#39;</span>);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    img = <a class="code" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a>(1:2:2*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1,1:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>)+<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*img(2:2:2*Ny,1:Nx);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="keywordflow">case</span> 6</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    complexFlag = 1;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="binwrite2_d_8m.html#ae26e11ce032ccbede51aab16318e9ac8">doubleFlag</a> = 1;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">if</span> printFlag</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;64-bit complex data, %.3fMB)\n&#39;</span>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*16/1048576);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    img = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,[2*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>],<span class="stringliteral">&#39;float64&#39;</span>);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    img = <a class="code" href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a>(1:2:2*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>-1,1:<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>)+<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*img(2:2:2*Ny,1:Nx);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="keywordflow">case</span> 1</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    complexFlag = 0;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <a class="code" href="binwrite2_d_8m.html#ae26e11ce032ccbede51aab16318e9ac8">doubleFlag</a> = 0;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">if</span> printFlag</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;16-bit integer data, %.3fMB)\n&#39;</span>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>*<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>*8/1048576);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    img = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>],<span class="stringliteral">&#39;int16&#39;</span>);    </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="keywordflow">case</span> 5</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    complexFlag = 0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <a class="code" href="binwrite2_d_8m.html#ae26e11ce032ccbede51aab16318e9ac8">doubleFlag</a> = 0;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">if</span> printFlag</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a>(<span class="stringliteral">&#39;32-bit integer data)\n&#39;</span>);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    img = fread(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>,[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>],<span class="stringliteral">&#39;int32&#39;</span>);    </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;% <a class="code" href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a>(img); <a class="code" href="image_sim_8m.html#af56c95f61621bf9779137b38fcb3e0fd">colormap</a>(<span class="stringliteral">&#39;gray&#39;</span>); axis <a class="code" href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a>; axis <a class="code" href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<a class="code" href="convert2cfg_8m.html#a5f84f51058cdb4f43c29d2c875659f42">fclose</a>(<a class="code" href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a>);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkbox_Sampling.</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;function checkbox_Sampling_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;% hObject    handle to checkbox_Sampling (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;% eventdata  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> <a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a> future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;% handles    structure with handles and user data (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GUIDATA)</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;% <a class="code" href="aberrations_8m.html#a98e24af10201eb2a871179d81c16c84f">Hint</a>: get(hObject,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;) returns toggle state of checkbox_Sampling</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;% --- Executes on button press in pushbutton_SaveWave.</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;function pushbutton_SaveWave_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;% hObject    handle to pushbutton_SaveWave (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;% eventdata  reserved - to be defined in a future version of MATLAB</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;% handles    structure with handles and user data (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GUIDATA)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;[filename, pathname] = uiputfile(&#39;*.img&#39;, &#39;Save wave function as&#39;);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="keywordflow">if</span> <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(filename,0) <a class="code" href="convert2cfg_8m.html#a9717e7bbecb906637e86cef6da3d83c2">return</a>; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;[<a class="code" href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a>,<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>] = <a class="code" href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a>(handles.wave0);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxDefocus,&#39;<a class="code" href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a>&#39;,1);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;% convert Defocus from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> to A</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<a class="code" href="image_sim_8m.html#a85be494f1d6cfae73a7661fcbf449178">defocus0</a> = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editDefocus,&#39;String&#39;));</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<a class="code" href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a> = round(<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_DefCount,&#39;String&#39;)));</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<a class="code" href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a>  = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_DefStep,&#39;String&#39;));</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a> = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editSampling,&#39;String&#39;));</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;handles = <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;dx = handles.dx;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;dy = handles.dy;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Sampling,&#39;Value&#39;)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <a class="code" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a> = round((<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1)*dx/<a class="code" href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a>)+1;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a> = round((Ny-1)*dy/sampling)+1;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a> = sampling*[0:<a class="code" href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a>-1];</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a> = sampling*[0:<a class="code" href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a>-1];</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) &gt; dx*(<a class="code" href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a>-1), <a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) = dx*(Nx-1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) &gt; dy*(Ny-1), <a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>(<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>) = dy*(Ny-1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    </div>
<div class="line"><a name="l01549"></a><span class="lineno"><a class="line" href="image_sim_8m.html#ab029181f933cd68b26ce33b582c8f99d"> 1549</a></span>&#160;    <a class="code" href="image_sim_8m.html#ab029181f933cd68b26ce33b582c8f99d">Psi2</a> = interp2(dx*[0:Nx-1],dy*[0:Ny-1].&#39;,handles.<a class="code" href="image_sim_8m.html#aa8f31224617f37bdccf7d77eef73a4a3">Psi</a>,<a class="code" href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a>,<a class="code" href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a>.&#39;,&#39;linear&#39;,0);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(<a class="code" href="image_sim_8m.html#ab029181f933cd68b26ce33b582c8f99d">Psi2</a>,fullfile(pathname, filename),sampling,sampling,handles.<a class="code" href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a>,0,0);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <a class="code" href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a>(handles.Psi,fullfile(pathname, filename),dx,dy,handles.thickness,0,0);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;function handles = <a class="code" href="image_sim_8m.html#a3620c5808f65103e456213a81d95e7e3">readAllFields</a>(handles)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;handles.MinAmplitude  = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editMinAmplitude,&#39;String&#39;));</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;handles.<a class="code" href="image_sim_8m.html#ab7f9e5712021c7e4807a0692ff01fd35">MaxPhase</a> = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editMaxPhase,&#39;String&#39;));</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;handles.<a class="code" href="image_sim_8m.html#aea0f936671f7f4f8fdb0dd293e4d6489">Amorph</a>   = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editAmorph,&#39;String&#39;));</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;handles.highVoltage = <a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editAccVoltage,&#39;String&#39;));</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;handles.lambda   = wavelength(handles.highVoltage);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.textAccVoltageUnit,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;kV, lambda=%.4f A&#39;,handles.lambda));</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;% Read Defocus, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxDefocus,&#39;Value&#39;)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    % convert Defocus from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> to A</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    handles.Defocus = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editDefocus,&#39;String&#39;));</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Defocus=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;% Read Cs, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxCs,&#39;Value&#39;)</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    % convert Cs from mm to A</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    handles.Cs = 1e7*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editCs,&#39;String&#39;));</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Cs=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;% Read Tilt, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxTilt,&#39;Value&#39;)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    % convert Tilt from mrad to rad</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    handles.TiltX = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editTiltX,&#39;String&#39;));</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    handles.TiltY = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editTiltY,&#39;String&#39;));</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.TiltX=0; handles.TiltY=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxComa,&#39;Value&#39;)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    % convert Coma from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> and deg to A and rad</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    handles.Coma = 1e4*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editComa,&#39;String&#39;)))*...</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editComaAngle,&#39;String&#39;)));</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Coma=0;  <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox3foldAstig,&#39;Value&#39;)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    % convert Coma from <a class="code" href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a> and deg to A and rad</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    handles.Astig3 = 1e4*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit3foldAstig,&#39;String&#39;)))*...</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit3foldAstigAngle,&#39;String&#39;)));</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Astig3=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;% Read Astigmatism, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxAstig,&#39;Value&#39;)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    % convert Tilt from mrad to rad</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    handles.Astig = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editAstig1,&#39;String&#39;))*...</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editAstig2,&#39;String&#39;)));</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Astig=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;% Read Delta, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxDelta,&#39;Value&#39;)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    % convert Cs from mm to A</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    handles.Delta = 10*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editDelta,&#39;String&#39;));</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Delta=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;% Read Convergence angle, <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> the corresponding checkbox is &quot;on&quot;, <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a> <a class="code" href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a> to 0 <a class="code" href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a>:</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkboxConvAngle,&#39;Value&#39;)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    % convert Cs from mm to A</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    handles.Convergence = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.editConvAngle,&#39;String&#39;));</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.Convergence=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;% Read objective <a class="code" href="sim_image_from_wave_8m.html#ac11faa037dc9050b7db352519f8f8440">aperture</a> angle:</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_ObjAperture,&#39;Value&#39;)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    % convert angle from mrad to rad</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    handles.ObjApertureTheta = 1e-3*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_ObjApertureTheta,&#39;String&#39;));</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a>, handles.ObjApertureTheta=0; <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;% Read sample vibration</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> get(handles.checkbox_Vibration,&#39;Value&#39;)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    % convert vibration from pm to A:</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    handles.vibration_Axis1 = 0.1*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_Vibration_Axis1,&#39;String&#39;));</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    handles.vibration_Axis2 = 0.1*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_Vibration_Axis2,&#39;String&#39;));</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    handles.vibration_Angle = pi/180*<a class="code" href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a>(get(handles.edit_Vibration_Angle,&#39;String&#39;));</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    handles.applyVibration = 1;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<a class="code" href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    handles.vibration_Axis1 = 0;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    handles.vibration_Axis2 = 0;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    handles.vibration_Angle = 0;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    handles.applyVibration = 0;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> pushbutton_moreAberrations.</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;function pushbutton_moreAberrations_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;% handles = <a class="code" href="image_sim_8m.html#a3620c5808f65103e456213a81d95e7e3">readAllFields</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;% handles = <a class="code" href="image_sim_8m.html#a3620c5808f65103e456213a81d95e7e3">readAllFields</a>(handles);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;handles = <a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;handles.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(2)     = handles.Defocus;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;handles.<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(4)     = handles.Cs;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;handles.<a class="code" href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a>(2,2) = angle(handles.Astig);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;handles.<a class="code" href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a>(2,2)   = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Astig);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;handles.a(3,1)   = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Coma);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;handles.phi(3,1) = angle(handles.Coma);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;handles.a(3,3)   = <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Astig3);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;handles.phi(3,3) = angle(handles.Astig3);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;[a,phi,<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>,params] = aberrations_TEM(handles,fft2(handles.wave));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1a479ccf79f439ab6d3cda93f70137bd">length</a>(params) &gt; 1</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    handles.highVoltage = params(5);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    handles.Convergence    = params(6);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    handles.Delta    = params(7);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    handles.a        = a;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    handles.phi      = phi;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    handles.Defocus  = 1e-1*<a class="code" href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a>(2);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    handles.Cs       = c(4);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    handles.Astig    = 1e-1*a(2,2)*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*phi(2,2));</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    handles.Coma     = a(3,1)*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*phi(3,1));</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    handles.Astig3   = a(3,3)*exp(<a class="code" href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*phi(3,3));</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    % Coma</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editComa,&#39;String&#39;,1e-4*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Coma))</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editComaAngle,&#39;String&#39;,180/pi*angle(handles.Coma))</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Coma) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxComa,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    % Astig3</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.edit3foldAstig,&#39;String&#39;,1e-4*<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Astig3));</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.edit3foldAstigAngle,&#39;String&#39;,180/pi*angle(handles.Astig3));</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Astig3) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkbox3foldAstig,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    % Defocus, 2-fold Astig, etc.</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDefocus,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;%.1f&#39;,handles.Defocus));</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Defocus) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxDefocus,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editAstig1,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;%.1f&#39;,<a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Astig)));</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editAstig2,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;%.1f&#39;,angle(handles.Astig)*180/pi));</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Astig) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxAstig,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editCs,&#39;String&#39;,<a class="code" href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a>(&#39;%.4f&#39;,1e-7*handles.Cs));</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Cs) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxCs,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editConvAngle,&#39;String&#39;,handles.Convergence);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Convergence) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxConvAngle,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editDelta,&#39;String&#39;,0.1*handles.Delta);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> <a class="code" href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a>(handles.Delta) &gt; 0,  <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.checkboxDelta,&#39;Value&#39;,1); <a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(handles.editAccVoltage,&#39;String&#39;,handles.highVoltage);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    handles = <a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a>(hObject, handles);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkbox_Vibration.</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;function checkbox_Vibration_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;function <a class="code" href="image_sim_8m.html#a6a94eb03f353dfec3717a85cd66869f1">edit_Vibration_Axis1_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;function edit_Vibration_Axis1_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;% hObject    handle to edit_Vibration_Axis1 (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;% eventdata  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> a future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;% handles    empty - handles not created until after all CreateFcns called</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;% <a class="code" href="aberrations_8m.html#a98e24af10201eb2a871179d81c16c84f">Hint</a>: edit controls usually have a white background on Windows.</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;%       See ISPC and COMPUTER.</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;function <a class="code" href="image_sim_8m.html#a920bb92dcd2234f3cba6326ad8ff5067">edit_Vibration_Axis2_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;function edit_Vibration_Axis2_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;% hObject    handle to edit_Vibration_Axis2 (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;% eventdata  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> a future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;% handles    empty - handles not created until after all CreateFcns called</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;% <a class="code" href="aberrations_8m.html#a98e24af10201eb2a871179d81c16c84f">Hint</a>: edit controls usually have a white background on Windows.</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;%       See ISPC and COMPUTER.</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;function <a class="code" href="image_sim_8m.html#a94d03d7f5c98718b4dd57dc8207046bd">edit_Vibration_Angle_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;function edit_Vibration_Angle_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;% hObject    handle to edit_Vibration_Angle (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;% eventdata  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> a future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;% handles    empty - handles not created until after all CreateFcns called</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;% <a class="code" href="aberrations_8m.html#a98e24af10201eb2a871179d81c16c84f">Hint</a>: edit controls usually have a white background on Windows.</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;%       See ISPC and COMPUTER.</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkbox_IncludeHigherOrders.</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;function checkbox_IncludeHigherOrders_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;function <a class="code" href="image_sim_8m.html#af0885de31bc1b9a18428f7b51eac166f">edit_ImgCounts_Callback</a>(hObject, eventdata, handles)</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;% --- Executes during <span class="keywordtype">object</span> creation, after setting all properties.</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;function edit_ImgCounts_CreateFcn(hObject, eventdata, handles)</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;% hObject    handle to edit_ImgCounts (<a class="code" href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a> GCBO)</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;% eventdata  reserved - to be <a class="code" href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a> <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> a future <a class="code" href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a> of MATLAB</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;% handles    empty - handles not created until after all CreateFcns called</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;% <a class="code" href="aberrations_8m.html#a98e24af10201eb2a871179d81c16c84f">Hint</a>: edit controls usually have a white background on Windows.</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;%       See ISPC and COMPUTER.</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<a class="code" href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a> ispc &amp;&amp; <a class="code" href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a>(get(hObject,&#39;BackgroundColor&#39;), get(0,&#39;defaultUicontrolBackgroundColor&#39;))</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <a class="code" href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a>(hObject,&#39;BackgroundColor&#39;,&#39;white&#39;);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<a class="code" href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> checkbox_Counts.</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;function checkbox_Counts_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobutton_QuasiCoherent.</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;function radiobutton_QuasiCoherent_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;% --- Executes on <a class="code" href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a> press <a class="code" href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a> radiobutton_FluxPreserving.</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;function radiobutton_FluxPreserving_Callback(hObject, eventdata, handles)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<a class="code" href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a>(hObject, eventdata, handles);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="ttc" id="image_sim_8m_html_a85be494f1d6cfae73a7661fcbf449178"><div class="ttname"><a href="image_sim_8m.html#a85be494f1d6cfae73a7661fcbf449178">defocus0</a></div><div class="ttdeci">convert Defocus from nm to A defocus0</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01099">imageSim.m:1099</a></div></div>
<div class="ttc" id="image_sim_8m_html_ab83702252d2bea5215e706c2ca46e1cd"><div class="ttname"><a href="image_sim_8m.html#ab83702252d2bea5215e706c2ca46e1cd">Astigmatism</a></div><div class="ttdeci">end Read Astigmatism</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00503">imageSim.m:503</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac7580d86f4f7443ac6a9900e4d052aa8"><div class="ttname"><a href="image_sim_8m.html#ac7580d86f4f7443ac6a9900e4d052aa8">pushbuttonUpdate_Callback</a></div><div class="ttdeci">pushbuttonUpdate_Callback(hObject, eventdata, handles)</div></div>
<div class="ttc" id="image_sim_8m_html_a925f1dafab920cc07fdd1c7f72176a70"><div class="ttname"><a href="image_sim_8m.html#a925f1dafab920cc07fdd1c7f72176a70">theta2</a></div><div class="ttdeci">theta2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00128">imageSim.m:128</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac0fb82c01c336cc6f4ca51b5f7cace0d"><div class="ttname"><a href="image_sim_8m.html#ac0fb82c01c336cc6f4ca51b5f7cace0d">yi</a></div><div class="ttdeci">yi</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01063">imageSim.m:1063</a></div></div>
<div class="ttc" id="image_sim_8m_html_af86ea2576d700f75de9452170bb57912"><div class="ttname"><a href="image_sim_8m.html#af86ea2576d700f75de9452170bb57912">vibration_Angle</a></div><div class="ttdeci">handles vibration_Angle</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00064">imageSim.m:64</a></div></div>
<div class="ttc" id="image_sim_8m_html_a831a3e1133c41b364b824dcb52ee0f9a"><div class="ttname"><a href="image_sim_8m.html#a831a3e1133c41b364b824dcb52ee0f9a">itself</a></div><div class="ttdeci">function by itself</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00001">imageSim.m:1</a></div></div>
<div class="ttc" id="image_sim_8m_html_a8729222064abdba94398e8a2caf0609e"><div class="ttname"><a href="image_sim_8m.html#a8729222064abdba94398e8a2caf0609e">highVoltage</a></div><div class="ttdeci">handles highVoltage</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00474">imageSim.m:474</a></div></div>
<div class="ttc" id="image_sim_8m_html_af886e46486c668b4df32c12eb041dce6"><div class="ttname"><a href="image_sim_8m.html#af886e46486c668b4df32c12eb041dce6">binwrite2D</a></div><div class="ttdeci">end binwrite2D(img2, fullfile(pathname, filename), sampling, sampling, handles.thickness, 0, 0)</div></div>
<div class="ttc" id="image_sim_8m_html_a0bbe3bce7888733cdeb0db41e5b1dc36"><div class="ttname"><a href="image_sim_8m.html#a0bbe3bce7888733cdeb0db41e5b1dc36">CTF</a></div><div class="ttdeci">end else show the CTF</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00268">imageSim.m:268</a></div></div>
<div class="ttc" id="image_sim_8m_html_a896c037a32087c5c20d97e64a1786880"><div class="ttname"><a href="image_sim_8m.html#a896c037a32087c5c20d97e64a1786880">Value</a></div><div class="ttdeci">Value</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00372">imageSim.m:372</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac90d0392c90d0d03802f5e7ae1945e90"><div class="ttname"><a href="image_sim_8m.html#ac90d0392c90d0d03802f5e7ae1945e90">ky2</a></div><div class="ttdeci">end Compute the CTF(this is where the Math is) ky2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00126">imageSim.m:126</a></div></div>
<div class="ttc" id="image_sim_8m_html_a67f88f0d593aadb8fec844297e059599"><div class="ttname"><a href="image_sim_8m.html#a67f88f0d593aadb8fec844297e059599">Tilt</a></div><div class="ttdeci">end Read Tilt</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00487">imageSim.m:487</a></div></div>
<div class="ttc" id="image_sim_8m_html_abff58742c346a246952566cf5aa5fbb0"><div class="ttname"><a href="image_sim_8m.html#abff58742c346a246952566cf5aa5fbb0">diffractogramMode</a></div><div class="ttdeci">handles diffractogramMode</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00060">imageSim.m:60</a></div></div>
<div class="ttc" id="image_sim_8m_html_a232f589ad3de91372ee1b484cbe9e209"><div class="ttname"><a href="image_sim_8m.html#a232f589ad3de91372ee1b484cbe9e209">uiputfile</a></div><div class="ttdeci">'*.img', 'Save image as' uiputfile()</div></div>
<div class="ttc" id="qstem_8m_html_a48673c39259e21125ccdd489d990c78e"><div class="ttname"><a href="qstem_8m.html#a48673c39259e21125ccdd489d990c78e">output</a></div><div class="ttdeci">handles output</div><div class="ttdef"><b>Definition:</b> <a href="qstem_8m_source.html#l00063">qstem.m:63</a></div></div>
<div class="ttc" id="image_sim_8m_html_ade156e39c8481df78050021b1ffcd425"><div class="ttname"><a href="image_sim_8m.html#ade156e39c8481df78050021b1ffcd425">xi</a></div><div class="ttdeci">xi</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01062">imageSim.m:1062</a></div></div>
<div class="ttc" id="image_sim_8m_html_a828ae7a797906638d292911b43b14579"><div class="ttname"><a href="image_sim_8m.html#a828ae7a797906638d292911b43b14579">Coma</a></div><div class="ttdeci">handles Coma</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00497">imageSim.m:497</a></div></div>
<div class="ttc" id="image_sim_8m_html_a2e693f713f9e8de2e4ac5d82f5ebfe4b"><div class="ttname"><a href="image_sim_8m.html#a2e693f713f9e8de2e4ac5d82f5ebfe4b">TiltY</a></div><div class="ttdeci">handles TiltY</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00491">imageSim.m:491</a></div></div>
<div class="ttc" id="image_sim_8m_html_a7139acdd1e5da82d23644880b419a172"><div class="ttname"><a href="image_sim_8m.html#a7139acdd1e5da82d23644880b419a172">H</a></div><div class="ttdeci">function by creates a new IMAGESIM or raises the existing singleton * H</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00006">imageSim.m:6</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac953f65c4c7e5bd28b7ef53a5d8ebef2"><div class="ttname"><a href="image_sim_8m.html#ac953f65c4c7e5bd28b7ef53a5d8ebef2">edit_DefStep_Callback</a></div><div class="ttdeci">end function edit_DefStep_Callback(hObject, eventdata, handles)%---Executes during object creation</div></div>
<div class="ttc" id="image_sim_8m_html_a81818e83613dec074856ab22e695b67f"><div class="ttname"><a href="image_sim_8m.html#a81818e83613dec074856ab22e695b67f">gui_State</a></div><div class="ttdeci">function by creates a new IMAGESIM or raises the existing singleton property value pairs are applied to the GUI before imageSim_OpeningFunction gets called An unrecognized property name or invalid value makes property application stop All inputs are passed to imageSim_OpeningFcn via varargin *See GUI Options on GUIDE s Tools menu Choose GUI allows only one instance to run(singleton)&quot;. % % See also gui_State</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00031">imageSim.m:31</a></div></div>
<div class="ttc" id="image_sim_8m_html_a9c28a452ae702c03ca642f7909cb499b"><div class="ttname"><a href="image_sim_8m.html#a9c28a452ae702c03ca642f7909cb499b">simIm</a></div><div class="ttdeci">simIm</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00323">imageSim.m:323</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa5cd282e26bde51def39bb437904248d"><div class="ttname"><a href="image_sim_8m.html#aa5cd282e26bde51def39bb437904248d">angle</a></div><div class="ttdeci">end Read Convergence angle</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00515">imageSim.m:515</a></div></div>
<div class="ttc" id="image_sim_8m_html_a7d62e13f9dba56dfbd9a08101e6bfd77"><div class="ttname"><a href="image_sim_8m.html#a7d62e13f9dba56dfbd9a08101e6bfd77">kx</a></div><div class="ttdeci">kx</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00454">imageSim.m:454</a></div></div>
<div class="ttc" id="image_sim_8m_html_a1508b4021830d267a270e2067f89550d"><div class="ttname"><a href="image_sim_8m.html#a1508b4021830d267a270e2067f89550d">wavePath</a></div><div class="ttdeci">handles wavePath</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00999">imageSim.m:999</a></div></div>
<div class="ttc" id="image_sim_8m_html_a131dfbed98a438571209fb0821f3d5ec"><div class="ttname"><a href="image_sim_8m.html#a131dfbed98a438571209fb0821f3d5ec">defStep</a></div><div class="ttdeci">defStep</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01101">imageSim.m:1101</a></div></div>
<div class="ttc" id="image_sim_8m_html_a15f1a96dd5e77ed931110fbb52692049"><div class="ttname"><a href="image_sim_8m.html#a15f1a96dd5e77ed931110fbb52692049">Delta</a></div><div class="ttdeci">astigmatism handles Delta</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00425">imageSim.m:425</a></div></div>
<div class="ttc" id="image_sim_8m_html_ab74e6bf80237ddc4109968cedc58c151"><div class="ttname"><a href="image_sim_8m.html#ab74e6bf80237ddc4109968cedc58c151">name</a></div><div class="ttdeci">name</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01114">imageSim.m:1114</a></div></div>
<div class="ttc" id="image_sim_8m_html_afeaa7ecdd726aa1950ba61dc659eb561"><div class="ttname"><a href="image_sim_8m.html#afeaa7ecdd726aa1950ba61dc659eb561">equal</a></div><div class="ttdeci">axis equal</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00250">imageSim.m:250</a></div></div>
<div class="ttc" id="showimage_8m_html_ac1452fdfd6ea1c8c005ac90bbfa62011"><div class="ttname"><a href="showimage_8m.html#ac1452fdfd6ea1c8c005ac90bbfa62011">Ny</a></div><div class="ttdeci">Ny</div><div class="ttdef"><b>Definition:</b> <a href="showimage_8m_source.html#l00261">showimage.m:261</a></div></div>
<div class="ttc" id="aberrations_8m_html_a98e24af10201eb2a871179d81c16c84f"><div class="ttname"><a href="aberrations_8m.html#a98e24af10201eb2a871179d81c16c84f">Hint</a></div><div class="ttdeci">Insert custom Title and Text if specified by the user Hint</div><div class="ttdef"><b>Definition:</b> <a href="aberrations_8m_source.html#l00078">aberrations.m:78</a></div></div>
<div class="ttc" id="image_sim_8m_html_aae1d1bec0e9c36c2fddc5cd87d8c4eee"><div class="ttname"><a href="image_sim_8m.html#aae1d1bec0e9c36c2fddc5cd87d8c4eee">ischar</a></div><div class="ttdeci">if nargin &amp;&amp; ischar(varargin{1}) gui_State.gui_Callback</div></div>
<div class="ttc" id="namespacepython_1_1potential_html_af887b24c78c0630197f05f84f19de90c"><div class="ttname"><a href="namespacepython_1_1potential.html#af887b24c78c0630197f05f84f19de90c">python.potential.f</a></div><div class="ttdeci">tuple f</div><div class="ttdef"><b>Definition:</b> <a href="potential_8py_source.html#l00133">potential.py:133</a></div></div>
<div class="ttc" id="image_sim_8m_html_a2eb1b2c41b2c60683d5d4f9a45893d00"><div class="ttname"><a href="image_sim_8m.html#a2eb1b2c41b2c60683d5d4f9a45893d00">wave0</a></div><div class="ttdeci">handles wave0</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00401">imageSim.m:401</a></div></div>
<div class="ttc" id="image_sim_8m_html_a56d3a59131aac023681a044b7481f27d"><div class="ttname"><a href="image_sim_8m.html#a56d3a59131aac023681a044b7481f27d">plot</a></div><div class="ttdeci">plot(handles.dkx *10 *[-Nx/2:Nx/2-1],[fftshift(Espat(:, 1)) fftshift(Etemp(:, 1))])</div></div>
<div class="ttc" id="image_sim_8m_html_a0ad7769f602705d0703a3685f5768c7b"><div class="ttname"><a href="image_sim_8m.html#a0ad7769f602705d0703a3685f5768c7b">pl</a></div><div class="ttdeci">pl</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00132">imageSim.m:132</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac33b6f8c6739912256ac5fd377d543b6"><div class="ttname"><a href="image_sim_8m.html#ac33b6f8c6739912256ac5fd377d543b6">prompt</a></div><div class="ttdeci">we have read the first wave of a TDS series prompt</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01113">imageSim.m:1113</a></div></div>
<div class="ttc" id="image_sim_8m_html_a79f291e6d46f2b83a62e43c884a7e952"><div class="ttname"><a href="image_sim_8m.html#a79f291e6d46f2b83a62e43c884a7e952">signal</a></div><div class="ttdeci">Construct the wave function from the different weightings and amorphous signal</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00109">imageSim.m:109</a></div></div>
<div class="ttc" id="image_sim_8m_html_ae83a3dfda6520a0fe8f0dc112b82bdbc"><div class="ttname"><a href="image_sim_8m.html#ae83a3dfda6520a0fe8f0dc112b82bdbc">ky</a></div><div class="ttdeci">ky</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00455">imageSim.m:455</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac208db9151fd331be3a084b3fa236031"><div class="ttname"><a href="image_sim_8m.html#ac208db9151fd331be3a084b3fa236031">edit_DefCount_Callback</a></div><div class="ttdeci">end function edit_DefCount_Callback(hObject, eventdata, handles)%---Executes during object creation</div></div>
<div class="ttc" id="image_sim_8m_html_accad547592c29b16895e9ebe9615b0d9"><div class="ttname"><a href="image_sim_8m.html#accad547592c29b16895e9ebe9615b0d9">editSampling_Callback</a></div><div class="ttdeci">end function editSampling_Callback(hObject, eventdata, handles)%handles.dx</div></div>
<div class="ttc" id="image_sim_8m_html_a97695672c0d89ebbb1074dee2ea2a8d8"><div class="ttname"><a href="image_sim_8m.html#a97695672c0d89ebbb1074dee2ea2a8d8">BackgroundColor</a></div><div class="ttdeci">end function after setting all properties function BackgroundColor</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00907">imageSim.m:907</a></div></div>
<div class="ttc" id="image_sim_8m_html_a3dc72fa3ba37b0cc1cca1106056f14e8"><div class="ttname"><a href="image_sim_8m.html#a3dc72fa3ba37b0cc1cca1106056f14e8">editCurv1_Callback</a></div><div class="ttdeci">end function editCurv1_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="draw_xtal_8m_html_aeb6159906f64d5f1b8476454468f5af3"><div class="ttname"><a href="draw_xtal_8m.html#aeb6159906f64d5f1b8476454468f5af3">parameters</a></div><div class="ttdeci">end define variable parameters</div><div class="ttdef"><b>Definition:</b> <a href="draw_xtal_8m_source.html#l00009">drawXtal.m:9</a></div></div>
<div class="ttc" id="image_sim_8m_html_a3620c5808f65103e456213a81d95e7e3"><div class="ttname"><a href="image_sim_8m.html#a3620c5808f65103e456213a81d95e7e3">readAllFields</a></div><div class="ttdeci">hObject, eventdata, handles readAllFields()</div></div>
<div class="ttc" id="_display_model_properties_8m_html_a634fdd7f6426b0a49817c39e9101a3c4"><div class="ttname"><a href="_display_model_properties_8m.html#a634fdd7f6426b0a49817c39e9101a3c4">see</a></div><div class="ttdeci">end Determine what the user wants to see</div><div class="ttdef"><b>Definition:</b> <a href="_display_model_properties_8m_source.html#l00268">DisplayModelProperties.m:268</a></div></div>
<div class="ttc" id="image_sim_8m_html_a27fb1250ca117b18cc017488b7e8a127"><div class="ttname"><a href="image_sim_8m.html#a27fb1250ca117b18cc017488b7e8a127">phase</a></div><div class="ttdeci">end phase</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00113">imageSim.m:113</a></div></div>
<div class="ttc" id="image_sim_8m_html_a6a94eb03f353dfec3717a85cd66869f1"><div class="ttname"><a href="image_sim_8m.html#a6a94eb03f353dfec3717a85cd66869f1">edit_Vibration_Axis1_Callback</a></div><div class="ttdeci">function edit_Vibration_Axis1_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="_display_model_properties_8m_html_adfc876b35db3e97d88b3a2e0d8ff0c61"><div class="ttname"><a href="_display_model_properties_8m.html#adfc876b35db3e97d88b3a2e0d8ff0c61">defined</a></div><div class="ttdeci">end end end Compute the effective Z number in thos where it is defined</div><div class="ttdef"><b>Definition:</b> <a href="_display_model_properties_8m_source.html#l00405">DisplayModelProperties.m:405</a></div></div>
<div class="ttc" id="image_sim_8m_html_a0f78069bbc8a49dd82779a5f3c6abba2"><div class="ttname"><a href="image_sim_8m.html#a0f78069bbc8a49dd82779a5f3c6abba2">dx</a></div><div class="ttdeci">initialize sampling distance handles dx</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00072">imageSim.m:72</a></div></div>
<div class="ttc" id="image_sim_8m_html_a191987812b92b9fcd02f8be84cce361a"><div class="ttname"><a href="image_sim_8m.html#a191987812b92b9fcd02f8be84cce361a">editCs_Callback</a></div><div class="ttdeci">end function editCs_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a5c06813fe91f99a63a998aa2b4e6335d"><div class="ttname"><a href="image_sim_8m.html#a5c06813fe91f99a63a998aa2b4e6335d">functions</a></div><div class="ttdeci">A few utility functions</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00395">imageSim.m:395</a></div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_a38bcf55414b93eac67018aee91bed97c"><div class="ttname"><a href="sim_image_from_wave_8m.html#a38bcf55414b93eac67018aee91bed97c">spread</a></div><div class="ttdeci">relative energy spread(0.4eV at 200kV) alpha=0.1e-3</div></div>
<div class="ttc" id="image_sim_8m_html_a4b3c37c61371884e2fa57cb0e428f1c8"><div class="ttname"><a href="image_sim_8m.html#a4b3c37c61371884e2fa57cb0e428f1c8">imgTDS</a></div><div class="ttdeci">else imgTDS</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01221">imageSim.m:1221</a></div></div>
<div class="ttc" id="image_sim_8m_html_a4d6bf7ca27b90221b33758fc9f02d95f"><div class="ttname"><a href="image_sim_8m.html#a4d6bf7ca27b90221b33758fc9f02d95f">ylim</a></div><div class="ttdeci">ylim(yl)</div></div>
<div class="ttc" id="image_sim_8m_html_aea926c42f75577fdf775d6ceda9624bd"><div class="ttname"><a href="image_sim_8m.html#aea926c42f75577fdf775d6ceda9624bd">applyVibration</a></div><div class="ttdeci">handles applyVibration</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00061">imageSim.m:61</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa4f166fe617bcfd58e6c02d41f03c118"><div class="ttname"><a href="image_sim_8m.html#aa4f166fe617bcfd58e6c02d41f03c118">intensities</a></div><div class="ttdeci">normalize the image intensities</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00398">imageSim.m:398</a></div></div>
<div class="ttc" id="_displacement_params_8m_html_abae9a3ce1348fc8b6ab1330584bd5bea"><div class="ttname"><a href="_displacement_params_8m.html#abae9a3ce1348fc8b6ab1330584bd5bea">in</a></div><div class="ttdeci">difference in</div><div class="ttdef"><b>Definition:</b> <a href="_displacement_params_8m_source.html#l00068">DisplacementParams.m:68</a></div></div>
<div class="ttc" id="image_sim_8m_html_a937578938a0404b0a56dc22db477bdcb"><div class="ttname"><a href="image_sim_8m.html#a937578938a0404b0a56dc22db477bdcb">title</a></div><div class="ttdeci">title('amplitide')</div></div>
<div class="ttc" id="showimage_8m_html_ac1b7f512a0fa5c0b7d1d056a07969aa2"><div class="ttname"><a href="showimage_8m.html#ac1b7f512a0fa5c0b7d1d056a07969aa2">use</a></div><div class="ttdeci">end end decide which part of a complex image to use</div><div class="ttdef"><b>Definition:</b> <a href="showimage_8m_source.html#l00276">showimage.m:276</a></div></div>
<div class="ttc" id="image_sim_8m_html_a2570d7acc6c1f2cbdea714285e3a01a7"><div class="ttname"><a href="image_sim_8m.html#a2570d7acc6c1f2cbdea714285e3a01a7">size</a></div><div class="ttdeci">handles.wave0 size()</div></div>
<div class="ttc" id="image_sim_8m_html_a6e1ec50d40620688cd6376e335851fa5"><div class="ttname"><a href="image_sim_8m.html#a6e1ec50d40620688cd6376e335851fa5">Cs</a></div><div class="ttdeci">handles Cs</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00422">imageSim.m:422</a></div></div>
<div class="ttc" id="_read_d_m3___matlab_8m_html_a6f6ccfcf58b31cb6412107d9d5281426"><div class="ttname"><a href="_read_d_m3___matlab_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div><div class="ttdeci">for i</div><div class="ttdef"><b>Definition:</b> <a href="_read_d_m3___matlab_8m_source.html#l00117">ReadDM3_Matlab.m:117</a></div></div>
<div class="ttc" id="image_sim_8m_html_a6504436723c396eecb451acabced8531"><div class="ttname"><a href="image_sim_8m.html#a6504436723c396eecb451acabced8531">numWaves</a></div><div class="ttdeci">end end handles numWaves</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00445">imageSim.m:445</a></div></div>
<div class="ttc" id="image_sim_8m_html_acf66413b59082c95cc095f3e1373f608"><div class="ttname"><a href="image_sim_8m.html#acf66413b59082c95cc095f3e1373f608">uigetfile</a></div><div class="ttdeci">'*.img', 'Select set of wave functions','MultiSelect','on' uigetfile()</div></div>
<div class="ttc" id="binwrite2_d_8m_html_ae26e11ce032ccbede51aab16318e9ac8"><div class="ttname"><a href="binwrite2_d_8m.html#ae26e11ce032ccbede51aab16318e9ac8">doubleFlag</a></div><div class="ttdeci">function doubleFlag</div><div class="ttdef"><b>Definition:</b> <a href="binwrite2_d_8m_source.html#l00005">binwrite2D.m:5</a></div></div>
<div class="ttc" id="qstem_8m_html_aa6941f884e278157f98a91b064426421"><div class="ttname"><a href="qstem_8m.html#aa6941f884e278157f98a91b064426421">selected</a></div><div class="ttdeci">end if a valid file has been selected</div><div class="ttdef"><b>Definition:</b> <a href="qstem_8m_source.html#l00160">qstem.m:160</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa51cad2115521e3fbf79721e9f49ddf2"><div class="ttname"><a href="image_sim_8m.html#aa51cad2115521e3fbf79721e9f49ddf2">guidata</a></div><div class="ttdeci">Update handles structure guidata(hObject, handles)</div></div>
<div class="ttc" id="image_sim_8m_html_aea4cc4bd8e43a7f8ebf9b0ee3da8d681"><div class="ttname"><a href="image_sim_8m.html#aea4cc4bd8e43a7f8ebf9b0ee3da8d681">comment</a></div><div class="ttdeci">comment</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00413">imageSim.m:413</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa3518eaf6d0d3b885cc34b5174c49be5"><div class="ttname"><a href="image_sim_8m.html#aa3518eaf6d0d3b885cc34b5174c49be5">fprintf</a></div><div class="ttdeci">end end fprintf('Pixel size:%g x%g\n', dx, dy)</div></div>
<div class="ttc" id="image_sim_8m_html_ab964b27abe11b74fda54cae6e1a89e85"><div class="ttname"><a href="image_sim_8m.html#ab964b27abe11b74fda54cae6e1a89e85">axes</a></div><div class="ttdeci">end axes(handles.axesPhase)</div></div>
<div class="ttc" id="image_sim_8m_html_a20dc037394f2773f476c77746b20881b"><div class="ttname"><a href="image_sim_8m.html#a20dc037394f2773f476c77746b20881b">wave</a></div><div class="ttdeci">handles wave</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00115">imageSim.m:115</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac16e8fafe8788f3b927b805b701ed99c"><div class="ttname"><a href="image_sim_8m.html#ac16e8fafe8788f3b927b805b701ed99c">ObjApertureTheta</a></div><div class="ttdeci">end Read objective aperture Value convert angle from mrad to rad handles ObjApertureTheta</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00523">imageSim.m:523</a></div></div>
<div class="ttc" id="image_sim_8m_html_a2a5a93dafb68c266fe1beb6116fb0ce5"><div class="ttname"><a href="image_sim_8m.html#a2a5a93dafb68c266fe1beb6116fb0ce5">envelopes</a></div><div class="ttdeci">clear ind end Compute the damping envelopes</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00205">imageSim.m:205</a></div></div>
<div class="ttc" id="image_sim_8m_html_a0953e540f68f10487a54cbd0c1486018"><div class="ttname"><a href="image_sim_8m.html#a0953e540f68f10487a54cbd0c1486018">editDelta_Callback</a></div><div class="ttdeci">end function editDelta_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="convert2cfg_8m_html_aea8eee85d5cbb354554d5625d1bbc2ad"><div class="ttname"><a href="convert2cfg_8m.html#aea8eee85d5cbb354554d5625d1bbc2ad">pathname</a></div><div class="ttdeci">function pathname</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00003">convert2cfg.m:3</a></div></div>
<div class="ttc" id="image_sim_8m_html_a064c4bb1964142fe511cd6590ef1f595"><div class="ttname"><a href="image_sim_8m.html#a064c4bb1964142fe511cd6590ef1f595">dkx</a></div><div class="ttdeci">handles dkx</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00452">imageSim.m:452</a></div></div>
<div class="ttc" id="convert2cfg_8m_html_ab8735b00764542f758cab8113c52b8ec"><div class="ttname"><a href="convert2cfg_8m.html#ab8735b00764542f758cab8113c52b8ec">index</a></div><div class="ttdeci">end Sort the current array and return the new index[ix, ix]</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00291">convert2cfg.m:291</a></div></div>
<div class="ttc" id="image_sim_8m_html_aaa93f32e31a2b6945d6aa1acbf541f0e"><div class="ttname"><a href="image_sim_8m.html#aaa93f32e31a2b6945d6aa1acbf541f0e">uigetdir</a></div><div class="ttdeci">'', 'Select the target folder' uigetdir()</div></div>
<div class="ttc" id="image_sim_8m_html_aeca129b3426664b5ad5ebd74f269705c"><div class="ttname"><a href="image_sim_8m.html#aeca129b3426664b5ad5ebd74f269705c">else</a></div><div class="ttdeci">clear img1 img2 else[filename, pathname]</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00404">imageSim.m:404</a></div></div>
<div class="ttc" id="image_sim_8m_html_a391e34f2de441d79152a7b3d6e4c9c86"><div class="ttname"><a href="image_sim_8m.html#a391e34f2de441d79152a7b3d6e4c9c86">figure</a></div><div class="ttdeci">figure</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00213">imageSim.m:213</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa86513d9e6380d2aa6e86ed5fa4bd86a"><div class="ttname"><a href="image_sim_8m.html#aa86513d9e6380d2aa6e86ed5fa4bd86a">Astig</a></div><div class="ttdeci">handles Astig</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00424">imageSim.m:424</a></div></div>
<div class="ttc" id="image_sim_8m_html_af6e37fae559389af2ef17f22db79e85c"><div class="ttname"><a href="image_sim_8m.html#af6e37fae559389af2ef17f22db79e85c">disp</a></div><div class="ttdeci">if disp('User pressed cancel') else filename</div></div>
<div class="ttc" id="image_sim_8m_html_ab34ab196d1d4f7db2100619c4b5c852a"><div class="ttname"><a href="image_sim_8m.html#ab34ab196d1d4f7db2100619c4b5c852a">idString</a></div><div class="ttdeci">if(handles.numWaves &gt; 1)%extract thickness index from wave name idString</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01187">imageSim.m:1187</a></div></div>
<div class="ttc" id="image_sim_8m_html_a75771f4355963bc839fe36db8e2a5321"><div class="ttname"><a href="image_sim_8m.html#a75771f4355963bc839fe36db8e2a5321">function</a></div><div class="ttdeci">Main drawing function</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00092">imageSim.m:92</a></div></div>
<div class="ttc" id="fftw__allocator_8hpp_html_a4b67f0883b07b3e879fc8c8481e3d393"><div class="ttname"><a href="fftw__allocator_8hpp.html#a4b67f0883b07b3e879fc8c8481e3d393">imag</a></div><div class="ttdeci">R imag(const FFTWComplex&lt; R &gt; &amp;a)</div><div class="ttdoc">imaginary part </div><div class="ttdef"><b>Definition:</b> <a href="fftw__allocator_8hpp_source.html#l00580">fftw_allocator.hpp:580</a></div></div>
<div class="ttc" id="image_sim_8m_html_aebf487f5d315cb61f0bd86455edff1fd"><div class="ttname"><a href="image_sim_8m.html#aebf487f5d315cb61f0bd86455edff1fd">theta</a></div><div class="ttdeci">theta</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00129">imageSim.m:129</a></div></div>
<div class="ttc" id="image_sim_8m_html_aff5b347ee7496bd631093b761e4a1316"><div class="ttname"><a href="image_sim_8m.html#aff5b347ee7496bd631093b761e4a1316">editComa_Callback</a></div><div class="ttdeci">end function editComa_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a9a300d81a25b0524f2c4b35e8187849b"><div class="ttname"><a href="image_sim_8m.html#a9a300d81a25b0524f2c4b35e8187849b">isequal</a></div><div class="ttdeci">if isequal(filename, 0)||isequal(pathname</div></div>
<div class="ttc" id="image_sim_8m_html_a08244d156689b3ad5a7c2c2c6e5c7a7c"><div class="ttname"><a href="image_sim_8m.html#a08244d156689b3ad5a7c2c2c6e5c7a7c">cla</a></div><div class="ttdeci">cla</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00244">imageSim.m:244</a></div></div>
<div class="ttc" id="image_sim_8m_html_a37910ddf751768ef7b70134a17ebaf4d"><div class="ttname"><a href="image_sim_8m.html#a37910ddf751768ef7b70134a17ebaf4d">editSpiral_Callback</a></div><div class="ttdeci">end function editSpiral_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_aa3e9a9a20b3870b903b32566274f83d2"><div class="ttname"><a href="image_sim_8m.html#aa3e9a9a20b3870b903b32566274f83d2">set</a></div><div class="ttdeci">set(gca,'YDir','normal')</div></div>
<div class="ttc" id="image_sim_8m_html_a8c4d9ee8d4f82d724070b97e70b9c4e5"><div class="ttname"><a href="image_sim_8m.html#a8c4d9ee8d4f82d724070b97e70b9c4e5">answer</a></div><div class="ttdeci">answer</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01118">imageSim.m:1118</a></div></div>
<div class="ttc" id="image_sim_8m_html_a86f0cd0012491485fb7a7a97b224e03f"><div class="ttname"><a href="image_sim_8m.html#a86f0cd0012491485fb7a7a97b224e03f">edit_DefStep_CreateFcn</a></div><div class="ttdeci">end function after setting all properties function edit_DefStep_CreateFcn(hObject, eventdata, handles) if ispc &amp;&amp;isequal(get(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a902996ad1133218c2e0fb07ae14f43e1"><div class="ttname"><a href="image_sim_8m.html#a902996ad1133218c2e0fb07ae14f43e1">edit_ObjApertTheta_Callback</a></div><div class="ttdeci">end function edit_ObjApertTheta_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_ae86f2475cbf92be6cf5f5c266451d828"><div class="ttname"><a href="image_sim_8m.html#ae86f2475cbf92be6cf5f5c266451d828">ampl</a></div><div class="ttdeci">else ampl</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00111">imageSim.m:111</a></div></div>
<div class="ttc" id="image_sim_8m_html_adcbf6818ca1a5f06faf47e9f23063dc5"><div class="ttname"><a href="image_sim_8m.html#adcbf6818ca1a5f06faf47e9f23063dc5">k2</a></div><div class="ttdeci">k2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00127">imageSim.m:127</a></div></div>
<div class="ttc" id="qstem_8m_html_aeee9d3c55cddc06149a5f9799cd5232d"><div class="ttname"><a href="qstem_8m.html#aeee9d3c55cddc06149a5f9799cd5232d">value</a></div><div class="ttdeci">value</div><div class="ttdef"><b>Definition:</b> <a href="qstem_8m_source.html#l00187">qstem.m:187</a></div></div>
<div class="ttc" id="qmb_8m_html_a14139799dd4b2fc41ecb6cb14936322f"><div class="ttname"><a href="qmb_8m.html#a14139799dd4b2fc41ecb6cb14936322f">button</a></div><div class="ttdeci">button</div><div class="ttdef"><b>Definition:</b> <a href="qmb_8m_source.html#l01063">qmb.m:1063</a></div></div>
<div class="ttc" id="image_sim_8m_html_af7022c931e47482f063cae1ddf540e7e"><div class="ttname"><a href="image_sim_8m.html#af7022c931e47482f063cae1ddf540e7e">iscell</a></div><div class="ttdeci">filename find the number of files that has been selected if iscell(filename) handles.numWaves</div></div>
<div class="ttc" id="image_sim_8m_html_a589b13a90e011e72db96b891b65da911"><div class="ttname"><a href="image_sim_8m.html#a589b13a90e011e72db96b891b65da911">initialized</a></div><div class="ttdeci">handles initialized</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00059">imageSim.m:59</a></div></div>
<div class="ttc" id="image_sim_8m_html_ae07f845786f7290b6eb093f5e8670d10"><div class="ttname"><a href="image_sim_8m.html#ae07f845786f7290b6eb093f5e8670d10">img</a></div><div class="ttdeci">img</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01037">imageSim.m:1037</a></div></div>
<div class="ttc" id="image_sim_8m_html_a920bb92dcd2234f3cba6326ad8ff5067"><div class="ttname"><a href="image_sim_8m.html#a920bb92dcd2234f3cba6326ad8ff5067">edit_Vibration_Axis2_Callback</a></div><div class="ttdeci">end function edit_Vibration_Axis2_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_aa1a517e3e42b3d109bc480c74e3a655c"><div class="ttname"><a href="image_sim_8m.html#aa1a517e3e42b3d109bc480c74e3a655c">ind</a></div><div class="ttdeci">ind</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00197">imageSim.m:197</a></div></div>
<div class="ttc" id="draw_xtal_8m_html_abc26c33960c3103b4dade478795ea82b"><div class="ttname"><a href="draw_xtal_8m.html#abc26c33960c3103b4dade478795ea82b">h</a></div><div class="ttdeci">base radius of spheres h</div><div class="ttdef"><b>Definition:</b> <a href="draw_xtal_8m_source.html#l00012">drawXtal.m:12</a></div></div>
<div class="ttc" id="_displacement_params_8m_html_aae9af2e7ae27ed31a08ec6a73ee7c424"><div class="ttname"><a href="_displacement_params_8m.html#aae9af2e7ae27ed31a08ec6a73ee7c424">ones</a></div><div class="ttdeci">sort the neighbors by distance and take only the closest ones</div><div class="ttdef"><b>Definition:</b> <a href="_displacement_params_8m_source.html#l00198">DisplacementParams.m:198</a></div></div>
<div class="ttc" id="image_sim_8m_html_a86295a41493349acbc59eb5d3a0c22f9"><div class="ttname"><a href="image_sim_8m.html#a86295a41493349acbc59eb5d3a0c22f9">Nx2</a></div><div class="ttdeci">end end resample the if Value Nx2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01174">imageSim.m:1174</a></div></div>
<div class="ttc" id="image_sim_8m_html_af0885de31bc1b9a18428f7b51eac166f"><div class="ttname"><a href="image_sim_8m.html#af0885de31bc1b9a18428f7b51eac166f">edit_ImgCounts_Callback</a></div><div class="ttdeci">function edit_ImgCounts_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a251a4ef16ae9f055ad88c14c2597ca43"><div class="ttname"><a href="image_sim_8m.html#a251a4ef16ae9f055ad88c14c2597ca43">realFlag</a></div><div class="ttdeci">realFlag</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00412">imageSim.m:412</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa75144726b375b93ecfc08810e5b5f09"><div class="ttname"><a href="image_sim_8m.html#aa75144726b375b93ecfc08810e5b5f09">args</a></div><div class="ttdeci">see VARARGOUT args()</div></div>
<div class="ttc" id="image_sim_8m_html_af2f323caad11c790b60b05a6916887c3"><div class="ttname"><a href="image_sim_8m.html#af2f323caad11c790b60b05a6916887c3">numlines</a></div><div class="ttdeci">numlines</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01115">imageSim.m:1115</a></div></div>
<div class="ttc" id="image_sim_8m_html_aeadc3c4bb8c4d028b7ff79c58f5038e6"><div class="ttname"><a href="image_sim_8m.html#aeadc3c4bb8c4d028b7ff79c58f5038e6">edit3foldAstigAngle_Callback</a></div><div class="ttdeci">end function edit3foldAstigAngle_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a29e8f69ee879d91442e854b359650abe"><div class="ttname"><a href="image_sim_8m.html#a29e8f69ee879d91442e854b359650abe">edit3foldAstig_Callback</a></div><div class="ttdeci">function edit3foldAstig_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="read_c_f_g__qstem_8m_html_a85162b5d5e6736f5aa8616580d4e8a75"><div class="ttname"><a href="read_c_f_g__qstem_8m.html#a85162b5d5e6736f5aa8616580d4e8a75">sum</a></div><div class="ttdeci">end if nargin&lt; 3 mode=1;endcoords=[];aType=[];DW=[];occ=[];charge=[];Mm=eye(3);if(1) clear readCFG_mex[pathname, filen, ext]=fileparts(fileName);filename2=[filen, ext];oldPath=pwd();cd(pathname);[a, Mm]=readCFG_mex(filename2);if sum(sum(isnan(a))) &gt; sum(sum(isnan(Mm))) &gt; 0 clear readCFG_mex fprintf('reading file a second time!\n')</div></div>
<div class="ttc" id="image_sim_8m_html_a2395da3867a3f43663814ab85c3aabe5"><div class="ttname"><a href="image_sim_8m.html#a2395da3867a3f43663814ab85c3aabe5">def</a></div><div class="ttdeci">else def</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01204">imageSim.m:1204</a></div></div>
<div class="ttc" id="image_sim_8m_html_a0a3b9908c77f6f19ea7070d9600de1b4"><div class="ttname"><a href="image_sim_8m.html#a0a3b9908c77f6f19ea7070d9600de1b4">xlabel</a></div><div class="ttdeci">xlabel('x in nm')</div></div>
<div class="ttc" id="qmb_8m_html_a4dd6f73f98b7876577fd0d041b94d968"><div class="ttname"><a href="qmb_8m.html#a4dd6f73f98b7876577fd0d041b94d968">offset</a></div><div class="ttdeci">calculate locations offset</div><div class="ttdef"><b>Definition:</b> <a href="qmb_8m_source.html#l00695">qmb.m:695</a></div></div>
<div class="ttc" id="image_sim_8m_html_ae6a8f507df688e26ad528cf6d4cbfe75"><div class="ttname"><a href="image_sim_8m.html#ae6a8f507df688e26ad528cf6d4cbfe75">get</a></div><div class="ttdeci">if get(handles.checkbox_IncludeHigherOrders,'Value') chi</div></div>
<div class="ttc" id="image_sim_8m_html_abded2f650c4628bd791ebe1e3b0dab43"><div class="ttname"><a href="image_sim_8m.html#abded2f650c4628bd791ebe1e3b0dab43">vib2</a></div><div class="ttdeci">vib2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00322">imageSim.m:322</a></div></div>
<div class="ttc" id="fileio__fftw3_8cpp_html_a955f504eccf76b4eb2489c0adab03121"><div class="ttname"><a href="fileio__fftw3_8cpp.html#a955f504eccf76b4eb2489c0adab03121">A</a></div><div class="ttdeci">#define A</div><div class="ttdef"><b>Definition:</b> <a href="fileio__fftw3_8cpp_source.html#l00222">fileio_fftw3.cpp:222</a></div></div>
<div class="ttc" id="image_sim_8m_html_a853e5b0b247b39e9e25c549e4963311a"><div class="ttname"><a href="image_sim_8m.html#a853e5b0b247b39e9e25c549e4963311a">coma3a</a></div><div class="ttdeci">coma3a</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00135">imageSim.m:135</a></div></div>
<div class="ttc" id="image_sim_8m_html_aba04d96942cca2760ed9cf11b382c352"><div class="ttname"><a href="image_sim_8m.html#aba04d96942cca2760ed9cf11b382c352">dy</a></div><div class="ttdeci">handles dy</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00416">imageSim.m:416</a></div></div>
<div class="ttc" id="image_sim_8m_html_a28e5a7d765c6f5094ae1e07079195c41"><div class="ttname"><a href="image_sim_8m.html#a28e5a7d765c6f5094ae1e07079195c41">Nthickness</a></div><div class="ttdeci">Nthickness</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01111">imageSim.m:1111</a></div></div>
<div class="ttc" id="_read_d_m3___matlab_8m_html_a9b0b6d24f95658a64d11e8d57d2c1c7d"><div class="ttname"><a href="_read_d_m3___matlab_8m.html#a9b0b6d24f95658a64d11e8d57d2c1c7d">printFlag</a></div><div class="ttdeci">id printFlag()</div></div>
<div class="ttc" id="aberrations___t_e_m_8m_html_aef29541a06b7f933d32a804307db13af"><div class="ttname"><a href="aberrations___t_e_m_8m.html#aef29541a06b7f933d32a804307db13af">s</a></div><div class="ttdeci">v &gt; 0 s()</div></div>
<div class="ttc" id="image_sim_8m_html_a491b666333e689144e868595f1fdee9b"><div class="ttname"><a href="image_sim_8m.html#a491b666333e689144e868595f1fdee9b">dchi_dphi</a></div><div class="ttdeci">if(get(handles.checkboxConvAngle,'Value'))%I will use dchi_dphi</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00163">imageSim.m:163</a></div></div>
<div class="ttc" id="_read_d_m3___matlab_8m_html_aa8ef7bba54ee37a8beab56f5091c552f"><div class="ttname"><a href="_read_d_m3___matlab_8m.html#aa8ef7bba54ee37a8beab56f5091c552f">open</a></div><div class="ttdeci">open</div><div class="ttdef"><b>Definition:</b> <a href="_read_d_m3___matlab_8m_source.html#l00115">ReadDM3_Matlab.m:115</a></div></div>
<div class="ttc" id="image_sim_8m_html_a533ceb9f1e84fa11ea7109b5be40f26e"><div class="ttname"><a href="image_sim_8m.html#a533ceb9f1e84fa11ea7109b5be40f26e">editTiltX_Callback</a></div><div class="ttdeci">end function editTiltX_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_ab7f9e5712021c7e4807a0692ff01fd35"><div class="ttname"><a href="image_sim_8m.html#ab7f9e5712021c7e4807a0692ff01fd35">MaxPhase</a></div><div class="ttdeci">handles MaxPhase</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00472">imageSim.m:472</a></div></div>
<div class="ttc" id="image_sim_8m_html_acc4c9367cff2473d08ec9910547865f6"><div class="ttname"><a href="image_sim_8m.html#acc4c9367cff2473d08ec9910547865f6">white</a></div><div class="ttdeci">end function after setting all properties function white</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00908">imageSim.m:908</a></div></div>
<div class="ttc" id="qmb_8m_html_acb0bf34e5a38d0484b1e3e24b8106f52"><div class="ttname"><a href="qmb_8m.html#acb0bf34e5a38d0484b1e3e24b8106f52">strcmp</a></div><div class="ttdeci">if strcmp(ext,'.img')[img</div></div>
<div class="ttc" id="image_sim_8m_html_ad1e3f2cce958f10b9f27e568964658f2"><div class="ttname"><a href="image_sim_8m.html#ad1e3f2cce958f10b9f27e568964658f2">Astig3</a></div><div class="ttdeci">handles Astig3</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00502">imageSim.m:502</a></div></div>
<div class="ttc" id="qmb_8m_html_aa32473e7c2134539f1ba31d78099a876"><div class="ttname"><a href="qmb_8m.html#aa32473e7c2134539f1ba31d78099a876">find</a></div><div class="ttdeci">find((handles.atomPos(:, 1) &gt; x1)&amp;(handles.atomPos(:, 1)&lt; x2)&amp;(handles.atomPos(:, 2) &gt; y1)&amp;(handles.atomPos(:, 2)&lt; y2)&amp;(handles.atomPos(:, 4)==Zsel))]</div></div>
<div class="ttc" id="image_sim_8m_html_a1a479ccf79f439ab6d3cda93f70137bd"><div class="ttname"><a href="image_sim_8m.html#a1a479ccf79f439ab6d3cda93f70137bd">length</a></div><div class="ttdeci">if length(params) &gt; 1 handles.highVoltage</div></div>
<div class="ttc" id="image_sim_8m_html_acab7fb886236454279b8a82dffe94cf2"><div class="ttname"><a href="image_sim_8m.html#acab7fb886236454279b8a82dffe94cf2">editComaAngle_Callback</a></div><div class="ttdeci">end function editComaAngle_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_aec0a4fa5ed0e46b2a0a8fb27d295274d"><div class="ttname"><a href="image_sim_8m.html#aec0a4fa5ed0e46b2a0a8fb27d295274d">colorbar</a></div><div class="ttdeci">end colorbar</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01352">imageSim.m:1352</a></div></div>
<div class="ttc" id="aberrations_8m_html_ae814a4b95d0215118e1ea731ae41185b"><div class="ttname"><a href="aberrations_8m.html#ae814a4b95d0215118e1ea731ae41185b">fftshift</a></div><div class="ttdeci">abs(ifft2(ifftshift(handles.probe fftshift()</div></div>
<div class="ttc" id="image_sim_8m_html_a7dd200a5828d901e0b3b7a938a70fb51"><div class="ttname"><a href="image_sim_8m.html#a7dd200a5828d901e0b3b7a938a70fb51">editConvAngle_Callback</a></div><div class="ttdeci">end function editConvAngle_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="aberrations_8m_html_a5eb8d5664fde7892dc80f5dbe5218568"><div class="ttname"><a href="aberrations_8m.html#a5eb8d5664fde7892dc80f5dbe5218568">xlim</a></div><div class="ttdeci">xlim(0.5 *x)</div></div>
<div class="ttc" id="aberrations_8m_html_add6b7c5f8447a629106b3fae4a009eb8"><div class="ttname"><a href="aberrations_8m.html#add6b7c5f8447a629106b3fae4a009eb8">aberration</a></div><div class="ttdeci">end end Spherical aberration</div><div class="ttdef"><b>Definition:</b> <a href="aberrations_8m_source.html#l01116">aberrations.m:1116</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa84a9429840c054e4ef7d2f2f452548a"><div class="ttname"><a href="image_sim_8m.html#aa84a9429840c054e4ef7d2f2f452548a">ctfc</a></div><div class="ttdeci">ctfc</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00154">imageSim.m:154</a></div></div>
<div class="ttc" id="image_sim_8m_html_a80b398999219b6c8dbf6d4b08751ae12"><div class="ttname"><a href="image_sim_8m.html#a80b398999219b6c8dbf6d4b08751ae12">ctf</a></div><div class="ttdeci">ctf</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00137">imageSim.m:137</a></div></div>
<div class="ttc" id="aberrations_8m_html_a84c455b54a16f1c540f6abcc5b858393"><div class="ttname"><a href="aberrations_8m.html#a84c455b54a16f1c540f6abcc5b858393">x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="aberrations_8m_source.html#l01231">aberrations.m:1231</a></div></div>
<div class="ttc" id="image_sim_8m_html_a938f8aa70d7f49a21679ad582b6d4ffb"><div class="ttname"><a href="image_sim_8m.html#a938f8aa70d7f49a21679ad582b6d4ffb">thickness</a></div><div class="ttdeci">handles thickness</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00417">imageSim.m:417</a></div></div>
<div class="ttc" id="image_sim_8m_html_a837e322e5bcd0af2fa93e632f61dd918"><div class="ttname"><a href="image_sim_8m.html#a837e322e5bcd0af2fa93e632f61dd918">a</a></div><div class="ttdeci">handles a</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00066">imageSim.m:66</a></div></div>
<div class="ttc" id="image_sim_8m_html_aea0f936671f7f4f8fdb0dd293e4d6489"><div class="ttname"><a href="image_sim_8m.html#aea0f936671f7f4f8fdb0dd293e4d6489">Amorph</a></div><div class="ttdeci">handles Amorph</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00102">imageSim.m:102</a></div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_aedd72202f5fa11b5b301b347617895bb"><div class="ttname"><a href="sim_image_from_wave_8m.html#aedd72202f5fa11b5b301b347617895bb">idf</a></div><div class="ttdeci">additional images fro alignment for idf</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00067">simImageFromWave.m:67</a></div></div>
<div class="ttc" id="image_sim_8m_html_a1a71f5e406b211ed616173276484b78b"><div class="ttname"><a href="image_sim_8m.html#a1a71f5e406b211ed616173276484b78b">tight</a></div><div class="ttdeci">axis tight</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00250">imageSim.m:250</a></div></div>
<div class="ttc" id="image_sim_8m_html_a095451ad095fab975004df8fa1925cb8"><div class="ttname"><a href="image_sim_8m.html#a095451ad095fab975004df8fa1925cb8">Defocus</a></div><div class="ttdeci">handles Defocus</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00423">imageSim.m:423</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6"><div class="ttname"><a href="image_sim_8m.html#ac95d3ae2bb0e3a2c84b6e1a47eb2e7d6">ylabel</a></div><div class="ttdeci">ylabel('y in nm')</div></div>
<div class="ttc" id="image_sim_8m_html_ab8c03968936310630f03221eee0b647f"><div class="ttname"><a href="image_sim_8m.html#ab8c03968936310630f03221eee0b647f">Espat</a></div><div class="ttdeci">Espat</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00168">imageSim.m:168</a></div></div>
<div class="ttc" id="virtual_goniometer_8m_html_a658ea266fd3baee1bdd483b9117e9f54"><div class="ttname"><a href="virtual_goniometer_8m.html#a658ea266fd3baee1bdd483b9117e9f54">zeros</a></div><div class="ttdeci">3 zeros()</div></div>
<div class="ttc" id="image_sim_8m_html_a07be7620fe0b9f26017a975773b41995"><div class="ttname"><a href="image_sim_8m.html#a07be7620fe0b9f26017a975773b41995">str2num</a></div><div class="ttdeci">get(handles.editCs,'String' str2num()</div></div>
<div class="ttc" id="qmb_8m_html_a0afda3603b043ac6b7362fdee225631e"><div class="ttname"><a href="qmb_8m.html#a0afda3603b043ac6b7362fdee225631e">file</a></div><div class="ttdeci">end if disp('User pressed cancel') return end end%get the current grain index read the file[coords, aType, Mm, DW, occ, charge]</div><div class="ttdef"><b>Definition:</b> <a href="qmb_8m_source.html#l01122">qmb.m:1122</a></div></div>
<div class="ttc" id="image_sim_8m_html_a7ae766fd74a0a4159d106a3d0647fb49"><div class="ttname"><a href="image_sim_8m.html#a7ae766fd74a0a4159d106a3d0647fb49">XLimMode</a></div><div class="ttdeci">XLimMode</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00801">imageSim.m:801</a></div></div>
<div class="ttc" id="image_sim_8m_html_a617e69bc47c08413dff023b0d0d9d5c6"><div class="ttname"><a href="image_sim_8m.html#a617e69bc47c08413dff023b0d0d9d5c6">vibration_Axis1</a></div><div class="ttdeci">handles vibration_Axis1</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00062">imageSim.m:62</a></div></div>
<div class="ttc" id="image_sim_8m_html_a64b52c93bb6e3c8debb644b626e7efab"><div class="ttname"><a href="image_sim_8m.html#a64b52c93bb6e3c8debb644b626e7efab">fields</a></div><div class="ttdeci">Edit fields</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00588">imageSim.m:588</a></div></div>
<div class="ttc" id="image_sim_8m_html_a9453345457e3f32823308485e91ea707"><div class="ttname"><a href="image_sim_8m.html#a9453345457e3f32823308485e91ea707">TiltX</a></div><div class="ttdeci">illumination convergence angle handles TiltX</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00427">imageSim.m:427</a></div></div>
<div class="ttc" id="image_sim_8m_html_a8fa675eb2fcec5b95d9d21c670da7f30"><div class="ttname"><a href="image_sim_8m.html#a8fa675eb2fcec5b95d9d21c670da7f30">ax</a></div><div class="ttdeci">ax</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01289">imageSim.m:1289</a></div></div>
<div class="ttc" id="image_sim_8m_html_ab029181f933cd68b26ce33b582c8f99d"><div class="ttname"><a href="image_sim_8m.html#ab029181f933cd68b26ce33b582c8f99d">Psi2</a></div><div class="ttdeci">Psi2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01549">imageSim.m:1549</a></div></div>
<div class="ttc" id="image_sim_8m_html_a6e69a2e6c16546a1aba75e0422487e55"><div class="ttname"><a href="image_sim_8m.html#a6e69a2e6c16546a1aba75e0422487e55">hObject</a></div><div class="ttdeci">see VARARGIN hObject()</div></div>
<div class="ttc" id="image_sim_8m_html_a454532bd4d96c4531eb16b4052fefbe4"><div class="ttname"><a href="image_sim_8m.html#a454532bd4d96c4531eb16b4052fefbe4">on</a></div><div class="ttdeci">Read if the corresponding checkbox is on</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00477">imageSim.m:477</a></div></div>
<div class="ttc" id="qmb_8m_html_ab68aa604d0cbafb60d37e13d919f3cbb"><div class="ttname"><a href="qmb_8m.html#ab68aa604d0cbafb60d37e13d919f3cbb">str2double</a></div><div class="ttdeci">get(handles.edit_ImageDx,'String' str2double()</div></div>
<div class="ttc" id="qmb_8m_html_a76d164d39acada2c40fd4397c2715217"><div class="ttname"><a href="qmb_8m.html#a76d164d39acada2c40fd4397c2715217">pixels</a></div><div class="ttdeci">create image index pixels</div><div class="ttdef"><b>Definition:</b> <a href="qmb_8m_source.html#l00432">qmb.m:432</a></div></div>
<div class="ttc" id="image_sim_8m_html_a58f7f5bb8af524fdfac53ec31e329e3f"><div class="ttname"><a href="image_sim_8m.html#a58f7f5bb8af524fdfac53ec31e329e3f">gui_mainfcn</a></div><div class="ttdeci">else gui_mainfcn(gui_State, varargin{:})</div></div>
<div class="ttc" id="qstem_8m_html_a94410fa84a6efa7c64c1f760371d51d1"><div class="ttname"><a href="qstem_8m.html#a94410fa84a6efa7c64c1f760371d51d1">q</a></div><div class="ttdeci">return end s q</div><div class="ttdef"><b>Definition:</b> <a href="qstem_8m_source.html#l00178">qstem.m:178</a></div></div>
<div class="ttc" id="image_sim_8m_html_a596c211f92d4c3c92f8f3789ca67a0cc"><div class="ttname"><a href="image_sim_8m.html#a596c211f92d4c3c92f8f3789ca67a0cc">fileName</a></div><div class="ttdeci">else fileName</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01191">imageSim.m:1191</a></div></div>
<div class="ttc" id="image_sim_8m_html_af5e7b6b3888b7ff1427978d360412fe7"><div class="ttname"><a href="image_sim_8m.html#af5e7b6b3888b7ff1427978d360412fe7">pause</a></div><div class="ttdeci">pause(0.1)</div></div>
<div class="ttc" id="image_sim_8m_html_a05d251ea28c5be9426611a121db0c92a"><div class="ttname"><a href="image_sim_8m.html#a05d251ea28c5be9426611a121db0c92a">fa</a></div><div class="ttdeci">fa</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00134">imageSim.m:134</a></div></div>
<div class="ttc" id="image_sim_8m_html_a644b142716abd6ef5332df6ba0cc3796"><div class="ttname"><a href="image_sim_8m.html#a644b142716abd6ef5332df6ba0cc3796">yl</a></div><div class="ttdeci">yl</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00244">imageSim.m:244</a></div></div>
<div class="ttc" id="image_sim_8m_html_a75180f3a56b12e0ea7561b96f5583f33"><div class="ttname"><a href="image_sim_8m.html#a75180f3a56b12e0ea7561b96f5583f33">defaultanswer</a></div><div class="ttdeci">defaultanswer</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01116">imageSim.m:1116</a></div></div>
<div class="ttc" id="image_sim_8m_html_a75871acd33bd071349a6f2d6cd0aa6b8"><div class="ttname"><a href="image_sim_8m.html#a75871acd33bd071349a6f2d6cd0aa6b8">String</a></div><div class="ttdeci">if String</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01362">imageSim.m:1362</a></div></div>
<div class="ttc" id="_read_d_m3___matlab_8m_html_a788f12e84a4147fbec966d469221fb80"><div class="ttname"><a href="_read_d_m3___matlab_8m.html#a788f12e84a4147fbec966d469221fb80">cell</a></div><div class="ttdeci">1, 10 cell()</div></div>
<div class="ttc" id="image_sim_8m_html_a4c08b2f6798f294d143d8b233985c10f"><div class="ttname"><a href="image_sim_8m.html#a4c08b2f6798f294d143d8b233985c10f">Convergence</a></div><div class="ttdeci">end Read Convergence if the corresponding checkbox is set it to Value convert Cs from mm to A handles Convergence</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00518">imageSim.m:518</a></div></div>
<div class="ttc" id="image_sim_8m_html_af2c8c919140a0d23b4967a00d67821a8"><div class="ttname"><a href="image_sim_8m.html#af2c8c919140a0d23b4967a00d67821a8">end</a></div><div class="ttdeci">let the user define number of thicknesses and TDS runs end[img, t, dx, dy, params, comment]</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01010">imageSim.m:1010</a></div></div>
<div class="ttc" id="qmb_8m_html_ada985816ea79ac4451f0f552d48090e5"><div class="ttname"><a href="qmb_8m.html#ada985816ea79ac4451f0f552d48090e5">e3</a></div><div class="ttdeci">hObject, eventdata, handles e3()</div></div>
<div class="ttc" id="image_sim_8m_html_a3c53fbdcb4e4034433f7fb548430436d"><div class="ttname"><a href="image_sim_8m.html#a3c53fbdcb4e4034433f7fb548430436d">xl</a></div><div class="ttdeci">end end handles Cs or the CTF if get(handles.radiobuttonWave,'Value')%show the wave function xl</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00244">imageSim.m:244</a></div></div>
<div class="ttc" id="image_sim_8m_html_a861663adf18d48ac8dec574d9dbf4c6e"><div class="ttname"><a href="image_sim_8m.html#a861663adf18d48ac8dec574d9dbf4c6e">editMaxPhase_Callback</a></div><div class="ttdeci">end function editMaxPhase_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a916cff68d78d7f25dd9a2c684ca8d4f6"><div class="ttname"><a href="image_sim_8m.html#a916cff68d78d7f25dd9a2c684ca8d4f6">editTiltY_Callback</a></div><div class="ttdeci">end function editTiltY_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a82c07d7e6b41700d9b12774e3f7b7e1a"><div class="ttname"><a href="image_sim_8m.html#a82c07d7e6b41700d9b12774e3f7b7e1a">amorph</a></div><div class="ttdeci">amorph</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00114">imageSim.m:114</a></div></div>
<div class="ttc" id="image_sim_8m_html_a9a0c48d58e082211052c49509165f1db"><div class="ttname"><a href="image_sim_8m.html#a9a0c48d58e082211052c49509165f1db">c</a></div><div class="ttdeci">handles c</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00065">imageSim.m:65</a></div></div>
<div class="ttc" id="_read_d_m3___matlab_8m_html_a1aabac6d068eef6a7bad3fdf50a05cc8"><div class="ttname"><a href="_read_d_m3___matlab_8m.html#a1aabac6d068eef6a7bad3fdf50a05cc8">d</a></div><div class="ttdeci">d</div><div class="ttdef"><b>Definition:</b> <a href="_read_d_m3___matlab_8m_source.html#l00067">ReadDM3_Matlab.m:67</a></div></div>
<div class="ttc" id="image_sim_8m_html_a2fd56ce4970b3332e6c626b31607b782"><div class="ttname"><a href="image_sim_8m.html#a2fd56ce4970b3332e6c626b31607b782">well</a></div><div class="ttdeci">Apply the damping envelopes as well</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00215">imageSim.m:215</a></div></div>
<div class="ttc" id="image_sim_8m_html_ac80029094c1ea036985b1b9c9834e0eb"><div class="ttname"><a href="image_sim_8m.html#ac80029094c1ea036985b1b9c9834e0eb">vib1</a></div><div class="ttdeci">vib1</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01044">imageSim.m:1044</a></div></div>
<div class="ttc" id="image_sim_8m_html_acc89f64219ddae53243030f2c645fc06"><div class="ttname"><a href="image_sim_8m.html#acc89f64219ddae53243030f2c645fc06">varargout</a></div><div class="ttdeci">function varargout</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00001">imageSim.m:1</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa8f31224617f37bdccf7d77eef73a4a3"><div class="ttname"><a href="image_sim_8m.html#aa8f31224617f37bdccf7d77eef73a4a3">Psi</a></div><div class="ttdeci">else handles Psi</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00225">imageSim.m:225</a></div></div>
<div class="ttc" id="image_sim_8m_html_a179337ab4a7025901f7997d2b6f0388a"><div class="ttname"><a href="image_sim_8m.html#a179337ab4a7025901f7997d2b6f0388a">editAccVoltage_Callback</a></div><div class="ttdeci">end function editAccVoltage_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a6fbdf18a87d576fd409fa5a5718ea427"><div class="ttname"><a href="image_sim_8m.html#a6fbdf18a87d576fd409fa5a5718ea427">t</a></div><div class="ttdeci">read the wave t</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01127">imageSim.m:1127</a></div></div>
<div class="ttc" id="image_sim_8m_html_a529ce1661545042cd74576fc13f3aff5"><div class="ttname"><a href="image_sim_8m.html#a529ce1661545042cd74576fc13f3aff5">filenameT</a></div><div class="ttdeci">elseif handles numWaves&lt; 0 fprintf('Thickness index:%d\n', it);end for idf=0:defCount-1 def=defocus0+idf *defStep;set(handles.editDefocus,'String', def);handles.Defocus=10 *def;for itds=0:max(Ntds-1, 0) if Ntds &gt; filenameT</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01144">imageSim.m:1144</a></div></div>
<div class="ttc" id="image_sim_8m_html_a329ccef1a106d8025fe3b4af6820142e"><div class="ttname"><a href="image_sim_8m.html#a329ccef1a106d8025fe3b4af6820142e">img2</a></div><div class="ttdeci">A few utility img2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00396">imageSim.m:396</a></div></div>
<div class="ttc" id="image_sim_8m_html_a7cfce9e4244a1936557979efaaa3882a"><div class="ttname"><a href="image_sim_8m.html#a7cfce9e4244a1936557979efaaa3882a">handles</a></div><div class="ttdeci">Read the wave function from disk handles</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00070">imageSim.m:70</a></div></div>
<div class="ttc" id="image_sim_8m_html_a89d8aed5fbb472f6199ce54ecd7a31bc"><div class="ttname"><a href="image_sim_8m.html#a89d8aed5fbb472f6199ce54ecd7a31bc">legend</a></div><div class="ttdeci">hold on if(get(handles.checkboxDelta,'Value')&amp;&amp;get(handles.checkboxConvAngle,'Value')) plot(handles.dky *10 * legend[-Ny/2 Etemp(:, 1)])*[fftshift(Espat(('E_{spat}','E_{temp}')</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00292">imageSim.m:292</a></div></div>
<div class="ttc" id="image_sim_8m_html_af2ea9d844bcc07ae8b56c5dd36b439ea"><div class="ttname"><a href="image_sim_8m.html#af2ea9d844bcc07ae8b56c5dd36b439ea">lambda</a></div><div class="ttdeci">handles lambda</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00475">imageSim.m:475</a></div></div>
<div class="ttc" id="image_sim_8m_html_a4a2e2b343b3a5f8000463076dd452198"><div class="ttname"><a href="image_sim_8m.html#a4a2e2b343b3a5f8000463076dd452198">defCount</a></div><div class="ttdeci">defCount</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01100">imageSim.m:1100</a></div></div>
<div class="ttc" id="image_sim_8m_html_a94d03d7f5c98718b4dd57dc8207046bd"><div class="ttname"><a href="image_sim_8m.html#a94d03d7f5c98718b4dd57dc8207046bd">edit_Vibration_Angle_Callback</a></div><div class="ttdeci">end function edit_Vibration_Angle_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_aae2323afde46f03e269fa200b961ee3e"><div class="ttname"><a href="image_sim_8m.html#aae2323afde46f03e269fa200b961ee3e">editMinAmplitude_Callback</a></div><div class="ttdeci">function editMinAmplitude_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="advanced_settings_8m_html_a05ceb1cc3b74082a4c5ce7f459a483d4"><div class="ttname"><a href="advanced_settings_8m.html#a05ceb1cc3b74082a4c5ce7f459a483d4">floor</a></div><div class="ttdeci">str2num(get(handles.edit_SaveLevel,'String' floor()</div></div>
<div class="ttc" id="image_sim_8m_html_a2803ba463bca7c8908d43ab19e23b23d"><div class="ttname"><a href="image_sim_8m.html#a2803ba463bca7c8908d43ab19e23b23d">if</a></div><div class="ttdeci">if(get(handles.checkboxConvAngle,'Value')) dchi_dq</div></div>
<div class="ttc" id="image_sim_8m_html_a0c37f92496b0fdd29568d2891e681bad"><div class="ttname"><a href="image_sim_8m.html#a0c37f92496b0fdd29568d2891e681bad">listbox1</a></div><div class="ttdeci">returns selected item from listbox1[Ny, Nx]</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00929">imageSim.m:929</a></div></div>
<div class="ttc" id="image_sim_8m_html_a4cab01967e6dc75a4286ba256777ac55"><div class="ttname"><a href="image_sim_8m.html#a4cab01967e6dc75a4286ba256777ac55">phi</a></div><div class="ttdeci">handles phi</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00067">imageSim.m:67</a></div></div>
<div class="ttc" id="image_sim_8m_html_a55decb3992eb3fe116b673a079cbc0fe"><div class="ttname"><a href="image_sim_8m.html#a55decb3992eb3fe116b673a079cbc0fe">Etemp</a></div><div class="ttdeci">Etemp(find(Etemp &gt; 3))</div></div>
<div class="ttc" id="aberrations_8m_html_aa2fa5ea275f5d08a1f7ca407861c4be1"><div class="ttname"><a href="aberrations_8m.html#aa2fa5ea275f5d08a1f7ca407861c4be1">No</a></div><div class="ttdeci">get(hObject,'CurrentKey' No()</div></div>
<div class="ttc" id="convert2cfg_8m_html_a7b9c3d619ad7365ec6434713e76142e8"><div class="ttname"><a href="convert2cfg_8m.html#a7b9c3d619ad7365ec6434713e76142e8">fid</a></div><div class="ttdeci">fid</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00116">convert2cfg.m:116</a></div></div>
<div class="ttc" id="image_sim_8m_html_a734abb80403ebc18458d4672fa1b1ce0"><div class="ttname"><a href="image_sim_8m.html#a734abb80403ebc18458d4672fa1b1ce0">editPincushion_Callback</a></div><div class="ttdeci">end function editPincushion_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_ae15d993d8cc0c455c702fb01a1ab2190"><div class="ttname"><a href="image_sim_8m.html#ae15d993d8cc0c455c702fb01a1ab2190">imagesc</a></div><div class="ttdeci">imagesc(handles.dx/10 *[0:Nx-1], handles.dy/10 *[0:Ny-1], abs(handles.wave))</div></div>
<div class="ttc" id="_displacement_params_8m_html_aad05f78187c942f9dd521605fa81f1ba"><div class="ttname"><a href="_displacement_params_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a></div><div class="ttdeci">M</div><div class="ttdef"><b>Definition:</b> <a href="_displacement_params_8m_source.html#l00263">DisplacementParams.m:263</a></div></div>
<div class="ttc" id="image_sim_8m_html_af14d03723ec22be0994af92b83f1d134"><div class="ttname"><a href="image_sim_8m.html#af14d03723ec22be0994af92b83f1d134">p_l</a></div><div class="ttdeci">p_l</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00133">imageSim.m:133</a></div></div>
<div class="ttc" id="image_sim_8m_html_ad73a4d380561ec4b316f4532b70d90a2"><div class="ttname"><a href="image_sim_8m.html#ad73a4d380561ec4b316f4532b70d90a2">auto</a></div><div class="ttdeci">auto</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00801">imageSim.m:801</a></div></div>
<div class="ttc" id="image_sim_8m_html_a1c1d709803182885f995cc060aceb008"><div class="ttname"><a href="image_sim_8m.html#a1c1d709803182885f995cc060aceb008">abs</a></div><div class="ttdeci">if abs(handles.Defocus) &gt; 1 set(handles.editDefocus</div></div>
<div class="ttc" id="image_sim_8m_html_a3c8582bd540c65d79e214b39ca67b9ca"><div class="ttname"><a href="image_sim_8m.html#a3c8582bd540c65d79e214b39ca67b9ca">dky</a></div><div class="ttdeci">handles dky</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00453">imageSim.m:453</a></div></div>
<div class="ttc" id="image_sim_8m_html_a787cec617b71bf75857c96fc694b0ea4"><div class="ttname"><a href="image_sim_8m.html#a787cec617b71bf75857c96fc694b0ea4">img1</a></div><div class="ttdeci">img1</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00933">imageSim.m:933</a></div></div>
<div class="ttc" id="image_sim_8m_html_a4f22a4b4bcbe105cc8a7bbeb24eaa0dc"><div class="ttname"><a href="image_sim_8m.html#a4f22a4b4bcbe105cc8a7bbeb24eaa0dc">ty</a></div><div class="ttdeci">ty</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00221">imageSim.m:221</a></div></div>
<div class="ttc" id="image_sim_8m_html_a37ab591fb85a1c67556fa5187eb197e1"><div class="ttname"><a href="image_sim_8m.html#a37ab591fb85a1c67556fa5187eb197e1">sprintf</a></div><div class="ttdeci">if sprintf('%.1f', handles.Defocus))</div></div>
<div class="ttc" id="convert2cfg_8m_html_a9717e7bbecb906637e86cef6da3d83c2"><div class="ttname"><a href="convert2cfg_8m.html#a9717e7bbecb906637e86cef6da3d83c2">return</a></div><div class="ttdeci">if return</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00005">convert2cfg.m:5</a></div></div>
<div class="ttc" id="image_sim_8m_html_a34b20e3956ba06c0f792cff638706a9b"><div class="ttname"><a href="image_sim_8m.html#a34b20e3956ba06c0f792cff638706a9b">tx</a></div><div class="ttdeci">end else tx</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00229">imageSim.m:229</a></div></div>
<div class="ttc" id="image_sim_8m_html_a4357641c4f125d612ab547b6379afee7"><div class="ttname"><a href="image_sim_8m.html#a4357641c4f125d612ab547b6379afee7">kx2</a></div><div class="ttdeci">handles kx2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00456">imageSim.m:456</a></div></div>
<div class="ttc" id="image_sim_8m_html_a0d5f64d7b88fb6a504daba91fde8e4d1"><div class="ttname"><a href="image_sim_8m.html#a0d5f64d7b88fb6a504daba91fde8e4d1">waveNames</a></div><div class="ttdeci">handles waveNames</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00998">imageSim.m:998</a></div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_ac11faa037dc9050b7db352519f8f8440"><div class="ttname"><a href="sim_image_from_wave_8m.html#ac11faa037dc9050b7db352519f8f8440">aperture</a></div><div class="ttdeci">clear kx ky aperture</div><div class="ttdef"><b>Definition:</b> <a href="sim_image_from_wave_8m_source.html#l00057">simImageFromWave.m:57</a></div></div>
<div class="ttc" id="image_sim_8m_html_a489e6c7c5e937f378873d423394fa972"><div class="ttname"><a href="image_sim_8m.html#a489e6c7c5e937f378873d423394fa972">vibration_Axis2</a></div><div class="ttdeci">handles vibration_Axis2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00063">imageSim.m:63</a></div></div>
<div class="ttc" id="image_sim_8m_html_af56c95f61621bf9779137b38fcb3e0fd"><div class="ttname"><a href="image_sim_8m.html#af56c95f61621bf9779137b38fcb3e0fd">colormap</a></div><div class="ttdeci">end colormap('gray')</div></div>
<div class="ttc" id="sim_image_from_wave_8m_html_a656d5e61939acabefd422775c5d110f1"><div class="ttname"><a href="sim_image_from_wave_8m.html#a656d5e61939acabefd422775c5d110f1">defocus</a></div><div class="ttdeci">basis of defocus(Scherzer) defStep</div></div>
<div class="ttc" id="fftw__allocator_8hpp_html_a6db901743a0e6a777646d9b285e25780"><div class="ttname"><a href="fftw__allocator_8hpp.html#a6db901743a0e6a777646d9b285e25780">real</a></div><div class="ttdeci">R real(const FFTWComplex&lt; R &gt; &amp;a)</div><div class="ttdoc">real part </div><div class="ttdef"><b>Definition:</b> <a href="fftw__allocator_8hpp_source.html#l00573">fftw_allocator.hpp:573</a></div></div>
<div class="ttc" id="image_sim_8m_html_aa41b1781d4d006be54ec02382c747522"><div class="ttname"><a href="image_sim_8m.html#aa41b1781d4d006be54ec02382c747522">Ntds</a></div><div class="ttdeci">Ntds</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01110">imageSim.m:1110</a></div></div>
<div class="ttc" id="image_sim_8m_html_afea0c4a03f459c8c41c713425e9ab0f9"><div class="ttname"><a href="image_sim_8m.html#afea0c4a03f459c8c41c713425e9ab0f9">Ny2</a></div><div class="ttdeci">Ny2</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01061">imageSim.m:1061</a></div></div>
<div class="ttc" id="image_sim_8m_html_a2bc2c45f22146a64d1dc561fac7e60c1"><div class="ttname"><a href="image_sim_8m.html#a2bc2c45f22146a64d1dc561fac7e60c1">it</a></div><div class="ttdeci">end for it</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01123">imageSim.m:1123</a></div></div>
<div class="ttc" id="image_sim_8m_html_a3b10b856cdebdd00a5e23fbacb4244d2"><div class="ttname"><a href="image_sim_8m.html#a3b10b856cdebdd00a5e23fbacb4244d2">eventdata</a></div><div class="ttdeci">Edit eventdata</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00588">imageSim.m:588</a></div></div>
<div class="ttc" id="image_sim_8m_html_a24b987307bb82f91264d32abf349fae3"><div class="ttname"><a href="image_sim_8m.html#a24b987307bb82f91264d32abf349fae3">Nx</a></div><div class="ttdeci">Main drawing Nx</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00101">imageSim.m:101</a></div></div>
<div class="ttc" id="image_sim_8m_html_a4980ffdb4105ec5cb708d21491f752a1"><div class="ttname"><a href="image_sim_8m.html#a4980ffdb4105ec5cb708d21491f752a1">AccVoltage</a></div><div class="ttdeci">handles AccVoltage</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01358">imageSim.m:1358</a></div></div>
<div class="ttc" id="_read_d_m3___matlab_8m_html_a6ef5fcb21bae737d3cf018fa9185009b"><div class="ttname"><a href="_read_d_m3___matlab_8m.html#a6ef5fcb21bae737d3cf018fa9185009b">version</a></div><div class="ttdeci">read the whole file as bytes Pick up the header version</div><div class="ttdef"><b>Definition:</b> <a href="_read_d_m3___matlab_8m_source.html#l00072">ReadDM3_Matlab.m:72</a></div></div>
<div class="ttc" id="namespacepython_1_1fileio_1_1read__img_html_a3ffec208a1fe92342eafab85c08961a0"><div class="ttname"><a href="namespacepython_1_1fileio_1_1read__img.html#a3ffec208a1fe92342eafab85c08961a0">python.fileio.read_img.binread2D</a></div><div class="ttdeci">def binread2D</div><div class="ttdef"><b>Definition:</b> <a href="read__img_8py_source.html#l00043">read_img.py:43</a></div></div>
<div class="ttc" id="image_sim_8m_html_a6c61c47a014d6a5cdfaf5f90d77d2954"><div class="ttname"><a href="image_sim_8m.html#a6c61c47a014d6a5cdfaf5f90d77d2954">otherwise</a></div><div class="ttdeci">Read if the corresponding checkbox is set it to otherwise</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00477">imageSim.m:477</a></div></div>
<div class="ttc" id="image_sim_8m_html_a59b957ee37120fefdb602bc6a0cd242e"><div class="ttname"><a href="image_sim_8m.html#a59b957ee37120fefdb602bc6a0cd242e">editAmorph_Callback</a></div><div class="ttdeci">end function editAmorph_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="convert2cfg_8m_html_a1a3091fb7347c8f640f7b03687dadd44"><div class="ttname"><a href="convert2cfg_8m.html#a1a3091fb7347c8f640f7b03687dadd44">filename</a></div><div class="ttdeci">filename</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00011">convert2cfg.m:11</a></div></div>
<div class="ttc" id="image_sim_8m_html_aea744f16da952a9326dc0cfb579ea16c"><div class="ttname"><a href="image_sim_8m.html#aea744f16da952a9326dc0cfb579ea16c">response</a></div><div class="ttdeci">UIWAIT makes imageSim wait for user response(see UIRESUME)%uiwait(handles.figure1)</div></div>
<div class="ttc" id="image_sim_8m_html_aca46b83ec8f21353a4ff43eb667cd2b6"><div class="ttname"><a href="image_sim_8m.html#aca46b83ec8f21353a4ff43eb667cd2b6">params</a></div><div class="ttdeci">read the wave params</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01127">imageSim.m:1127</a></div></div>
<div class="ttc" id="convert2cfg_8m_html_a7cec22fd326288e5df0dadf886d5d919"><div class="ttname"><a href="convert2cfg_8m.html#a7cec22fd326288e5df0dadf886d5d919">array</a></div><div class="ttdeci">end Get the dimensions of the input cell array[nrows, ncols]</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00259">convert2cfg.m:259</a></div></div>
<div class="ttc" id="image_sim_8m_html_a26f9d2ec21a10a798d9d570aacf4ac76"><div class="ttname"><a href="image_sim_8m.html#a26f9d2ec21a10a798d9d570aacf4ac76">editAstig2_Callback</a></div><div class="ttdeci">end function editAstig2_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a755ee719849d88e42e4f90faa502db02"><div class="ttname"><a href="image_sim_8m.html#a755ee719849d88e42e4f90faa502db02">diffg</a></div><div class="ttdeci">diffg</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00337">imageSim.m:337</a></div></div>
<div class="ttc" id="image_sim_8m_html_afd622fdcc9bd74c4ed8747bf95ead848"><div class="ttname"><a href="image_sim_8m.html#afd622fdcc9bd74c4ed8747bf95ead848">editDefocus_Callback</a></div><div class="ttdeci">end function editDefocus_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="image_sim_8m_html_a9b07119da70fc4a54e0d1cb5751d69aa"><div class="ttname"><a href="image_sim_8m.html#a9b07119da70fc4a54e0d1cb5751d69aa">nargout</a></div><div class="ttdeci">end if nargout[varargout{1:nargout}]</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00042">imageSim.m:42</a></div></div>
<div class="ttc" id="image_sim_8m_html_accfa32fc89ba0b38e0504d8b8a0a6f54"><div class="ttname"><a href="image_sim_8m.html#accfa32fc89ba0b38e0504d8b8a0a6f54">requested</a></div><div class="ttdeci">end end resample the if requested</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01172">imageSim.m:1172</a></div></div>
<div class="ttc" id="image_sim_8m_html_af1b232e0b8fff58d7cb6ab24987002b4"><div class="ttname"><a href="image_sim_8m.html#af1b232e0b8fff58d7cb6ab24987002b4">chi</a></div><div class="ttdeci">end else chi</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l00173">imageSim.m:173</a></div></div>
<div class="ttc" id="_display_model_properties_8m_html_ab15b62bce31d4d4d1314fd7533fce833"><div class="ttname"><a href="_display_model_properties_8m.html#ab15b62bce31d4d4d1314fd7533fce833">nm</a></div><div class="ttdeci">k2(1, 1)%Smoothen the 2D array The scaling should also relate the area of a single unit cell with that of the whole array the scale defines how many pixels are in nm</div><div class="ttdef"><b>Definition:</b> <a href="_display_model_properties_8m_source.html#l00466">DisplayModelProperties.m:466</a></div></div>
<div class="ttc" id="_displacement_params_8m_html_ac0005745f18f3ed5d3e2f7943e5243c4"><div class="ttname"><a href="_displacement_params_8m.html#ac0005745f18f3ed5d3e2f7943e5243c4">First</a></div><div class="ttdeci">First</div><div class="ttdef"><b>Definition:</b> <a href="_displacement_params_8m_source.html#l00060">DisplacementParams.m:60</a></div></div>
<div class="ttc" id="image_sim_8m_html_aea1b44d9b8123c5ea535c9ca422b9422"><div class="ttname"><a href="image_sim_8m.html#aea1b44d9b8123c5ea535c9ca422b9422">sampling</a></div><div class="ttdeci">sampling</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01030">imageSim.m:1030</a></div></div>
<div class="ttc" id="convert2cfg_8m_html_a7f9b12e953d2678415a3d421f36ae4d6"><div class="ttname"><a href="convert2cfg_8m.html#a7f9b12e953d2678415a3d421f36ae4d6">nargin</a></div><div class="ttdeci">end end function if no dimension array is supplied Note that this function has only been tested on mixed cell arrays containing character strings and numeric values Documentation DFO Canada Creation Last Check to see if no input arguments were supplied If this is the stop execution and output an error message to the user if nargin</div><div class="ttdef"><b>Definition:</b> <a href="convert2cfg_8m_source.html#l00221">convert2cfg.m:221</a></div></div>
<div class="ttc" id="image_sim_8m_html_a1540bbd753c65267f505c582c9aeeea3"><div class="ttname"><a href="image_sim_8m.html#a1540bbd753c65267f505c582c9aeeea3">editAstig1_Callback</a></div><div class="ttdeci">end function editAstig1_Callback(hObject, eventdata, handles) pushbuttonUpdate_Callback(hObject</div></div>
<div class="ttc" id="convert2cfg_8m_html_a5f84f51058cdb4f43c29d2c875659f42"><div class="ttname"><a href="convert2cfg_8m.html#a5f84f51058cdb4f43c29d2c875659f42">fclose</a></div><div class="ttdeci">end fclose(fid)</div></div>
<div class="ttc" id="image_sim_8m_html_aa68874ba31f8ae452ff865792a1961b7"><div class="ttname"><a href="image_sim_8m.html#aa68874ba31f8ae452ff865792a1961b7">pushbutton_FocSeries_Callback</a></div><div class="ttdeci">end pushbutton_FocSeries_Callback(hObject, eventdata, handles)</div></div>
<div class="ttc" id="image_sim_8m_html_afae9c1ba68a4a4b4cbdc4b36f2e0afe6"><div class="ttname"><a href="image_sim_8m.html#afae9c1ba68a4a4b4cbdc4b36f2e0afe6">image</a></div><div class="ttdeci">end end resample the image</div><div class="ttdef"><b>Definition:</b> <a href="image_sim_8m_source.html#l01172">imageSim.m:1172</a></div></div>
<div class="ttc" id="image_sim_8m_html_a66d20fd880e878337de280676c45ba43"><div class="ttname"><a href="image_sim_8m.html#a66d20fd880e878337de280676c45ba43">max</a></div><div class="ttdeci">end end handles Cs * max(max(theta2)).^2%The radiobutton 'Wave'decides whether to plot the wave</div></div>
<div class="ttc" id="aberrations_8m_html_a3e9abce732c52a887bbe428e87d894c1"><div class="ttname"><a href="aberrations_8m.html#a3e9abce732c52a887bbe428e87d894c1">isempty</a></div><div class="ttdeci">if isempty(gcbf) ScreenUnits</div></div>
<div class="ttc" id="image_sim_8m_html_a924408856d2b35b39987e1b0cd0aed63"><div class="ttname"><a href="image_sim_8m.html#a924408856d2b35b39987e1b0cd0aed63">edit_DefCount_CreateFcn</a></div><div class="ttdeci">end function after setting all properties function edit_DefCount_CreateFcn(hObject, eventdata, handles) if ispc &amp;&amp;isequal(get(hObject</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e82970921ac3c6c3e512b9c67e4ee58d.html">GUI_Matlab</a></li><li class="navelem"><a class="el" href="image_sim_8m.html">imageSim.m</a></li>
    <li class="footer">Generated on Fri Jul 4 2014 10:51:36 for qstem by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
