\hypertarget{write_fields2_file_8m}{\section{G\-U\-I\-\_\-\-Matlab/write\-Fields2\-File.m File Reference}
\label{write_fields2_file_8m}\index{G\-U\-I\-\_\-\-Matlab/write\-Fields2\-File.\-m@{G\-U\-I\-\_\-\-Matlab/write\-Fields2\-File.\-m}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{showimage_8m_aa70d913bbaaadbcc10dbf2f8f2416e1c}{function} \hyperlink{write_fields2_file_8m_a79499b523dd8dff45cb559e070ca9b60}{write\-Fields2\-File} (\hyperlink{qmb_8m_a7a230f02bdffebd1357e3c0b49e01271}{file\-Name}, \hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles}) \hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid}
\item 
\hyperlink{_display_model_properties_8m_a8fb2b6b4a03427466839a9e801f3c491}{return} \hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{write_fields2_file_8m_a33cb655be2efe92f3ccc934075162b3a}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_af801c33848ca382739f11125cc8bf485}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\%\%\hyperlink{stemtypes__fftw3_8hpp_ae37055f0823281ce47997ab6602bb607}{S\-T\-E\-M} configuration \hyperlink{write_fields2_file_8m_a75658b9c899229893bf0bc9d90e97d93}{file} generated by qstem\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_ae5ccf64abc5b28d25d428d8c8394c6e0}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n\textbackslash{}n')
\item 
\hyperlink{draw_xtal_8m_a097da1a4e072a25b17f4eb06d5c4ab1d}{switch} \hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles} \hyperlink{qstem_8m_ae5457ac188407029525dae0d288f5060}{mode\-Num} \hyperlink{xyz2cfg_8m_a4120e7c19c5d82f60cfc57fb6e34665a}{case} \hyperlink{write_fields2_file_8m_a792ade792b76a3a87e61853b7589acd6}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'mode\-:\-C\-B\-E\-D\textbackslash{}n')
\item 
\hyperlink{xyz2cfg_8m_a4120e7c19c5d82f60cfc57fb6e34665a}{case} \hyperlink{write_fields2_file_8m_af3da4e84e910e09e0ad8ecc7a7b35350}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'mode\-:\-S\-T\-E\-M\textbackslash{}n')
\item 
\hyperlink{xyz2cfg_8m_a4120e7c19c5d82f60cfc57fb6e34665a}{case} \hyperlink{write_fields2_file_8m_a5b4339af933d1454537ca5a1d7a223ce}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'mode\-:\-T\-E\-M\textbackslash{}n')
\item 
\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{write_fields2_file_8m_a1092f59a6db37358a9c28d10bd1af47d}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'print level\-:\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%\%indicates how much \hyperlink{_read_d_m3___matlab_8m_aa4f42c0d3275c58153f3d1af1dda3edf}{information} \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} output\textbackslash{}n', \hyperlink{qstem_8m_a24e096d96b8b76611e893ddd6c372ae5}{handles.\-print\-Level})
\item 
\hyperlink{write_fields2_file_8m_a71ff71561cd7cbb4ed69826b39d691df}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'save level\-:\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%\%indicates how much \hyperlink{_read_d_m3___matlab_8m_aa4f42c0d3275c58153f3d1af1dda3edf}{information} shall be saved\textbackslash{}n', \hyperlink{qstem_8m_a5a7a04041b8d36231b865f8c9b07cd40}{handles.\-save\-Level})
\item 
\hyperlink{write_fields2_file_8m_a998c38403f8a2f5e6759fe4e7866f6f1}{strcmp} (pos\-Path, \hyperlink{write_fields2_file_8m_acb640f59b6e17119f3af32eb9f911d59}{cfg\-Path}) \hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} strcmp(pos\-Path
\item 
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{write_fields2_file_8m_aff5839ae6f09c1d39ab26468374a5357}{isempty} (first\-Char) \hyperlink{write_fields2_file_8m_a659f44d5663a2bb4581f2749601e2c1c}{fprintf}(\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid}
\item 
\hyperlink{qmb_8m_a2d9568f50e74214c48513c91bf8f143a}{else} \hyperlink{write_fields2_file_8m_a8c90de0f7ac5f0547376cd364c04d553}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'filename\-:\%s\textbackslash{}n', \hyperlink{write_fields2_file_8m_a62237b40e0bf78587fcc5d0e6cf4ce8b}{handles.\-pos\-File\-Name}(first\-Char(\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end})+1\-:\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end}))
\item 
\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{qmb_8m_a2d9568f50e74214c48513c91bf8f143a}{else} \hyperlink{write_fields2_file_8m_a92dec9ceb893c03171473b367a7b7894}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'filename\-:\char`\"{}\%s\char`\"{}\textbackslash{}n', \hyperlink{write_fields2_file_8m_a62237b40e0bf78587fcc5d0e6cf4ce8b}{handles.\-pos\-File\-Name})
\item 
\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{write_fields2_file_8m_a7d7265d399df662c370c9472752e53c1}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'resolution\-X\-:\%f\textbackslash{}n', handles.\-Probe\-Resolution\-X)
\item 
\hyperlink{write_fields2_file_8m_aed7026e2b386e492508c53aa9e59fea5}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'resolution\-Y\-:\%f\textbackslash{}n', handles.\-Probe\-Resolution\-Y)
\item 
\hyperlink{write_fields2_file_8m_a8e7d79e4756d233b35680c5cdd931437}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'N\-C\-E\-L\-L\-X\-:\%d\textbackslash{}n', handles.\-Ncell\-X)
\item 
\hyperlink{write_fields2_file_8m_a4adf462d6b74790229eb04dd7968b9b9}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'N\-C\-E\-L\-L\-Y\-:\%d\textbackslash{}n', handles.\-Ncell\-Y)
\item 
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles} Nsub\-Slabs\\*
$<$=1 fprintf(\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'N\-C\-E\-L\-L\-Z\-:\%d\textbackslash{}n', \\*
handles.\-Ncell\-Z);\hyperlink{qmb_8m_a2d9568f50e74214c48513c91bf8f143a}{else} fprintf(\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'N\-C\-E\-L\-L\-Z\-:\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}/\%d\textbackslash{}n', \\*
handles.\-Ncell\-Z, \\*
handles.\-Nsub\-Slabs);\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end}\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%Box \\*
confinement\-:if \hyperlink{qmb_8m_a179ba7444e14ce32dec620c6c3ce25dc}{isfield}(\hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles},'radiobutton\-\_\-\-Box') \\*
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{showimage_8m_a11214dca6c394abde47b5f968409433e}{get}(handles.\-radiobutton\-\_\-\-Box,'\hyperlink{image_sim_8m_a896c037a32087c5c20d97e64a1786880}{Value}') \\*
fprintf(\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'Cube\-:\%.\-3f\%.\-3f\%.\-3f\textbackslash{}n', handles.\-Box\-X, handles.\-Box\-Y, handles.\-Box\-Z);endelse if handles.\-Box\-Mode fprintf(fid,'\-Cube\-:\%.\-3f\%.\-3f\%.\-3f\textbackslash{}n', handles.\-Box\-X, handles.\-Box\-Y, handles.\-Box\-Z);endendfprintf(fid,'v0\-:\%f\%\%beam energy\textbackslash{}n', handles.\-High\-Voltage);if isfield(handles,'checkbox\-\_\-\-T\-D\-S') handles.\-T\-D\-S=get(handles.\-checkbox\-\_\-\-T\-D\-S,'\-Value');end\%fprintf('\-T\-D\-S is set to\%d\textbackslash{}n', handles.\-T\-D\-S);if handles.\-T\-D\-S==1 fprintf(fid,'tds\-:yes\%\%include thermal diffuse scattering\textbackslash{}n');else fprintf(fid,'tds\-:no\%\%do N\-O\-T include thermal diffuse scattering\textbackslash{}n');end fprintf(fid,'temperature\-:\%f\%\%temperature in Kelvin\textbackslash{}n', handles.\-Temperature);fprintf(fid,'slice-\/thickness\-:\%f\%\%slice thckness in A\textbackslash{}n', handles.\-Slice\-Thickness);fprintf(fid,'slices\-:\%d\%\%number of different slices per slab in z-\/direction\textbackslash{}n', handles.\-Nslice);if handles.\-Center\-Slices fprintf(fid,'center slices\-:yes\%\%center slices\textbackslash{}n');else fprintf(fid,'center slices\-:no\%\%do not center slices\textbackslash{}n');endfprintf(fid,'slices between outputs\-:\%d\%\%give intermediate results after every\%d slices\textbackslash{}n',...\-handles.\-Slices\-Between\-Outputs, handles.\-Slices\-Between\-Outputs);fprintf(fid,'x\-Offset\-:\%f\%\%x-\/position offset in cartesian coords\textbackslash{}n', handles.\-Potential\-Offset\-X);fprintf(fid,'y\-Offset\-:\%f\%\%y-\/position offset in cartesian coords\textbackslash{}n', handles.\-Potential\-Offset\-Y);fprintf(fid,'z\-Offset\-:\%f\%\%slize z-\/position offset in cartesian coords\textbackslash{}n', handles.\-Potential\-Offset\-Z);if handles.\-Periodic\-X\-Y fprintf(fid,'periodic\-X\-Y\-:yes\%\%periodic in x-\/and y-\/direction\textbackslash{}n');else fprintf(fid,'periodic\-X\-Y\-:no\%\%not periodic in x-\/and y-\/direction\textbackslash{}n');endif handles.\-Periodic\-Z fprintf(fid,'periodic\-Z\-:yes\%\%periodic in z-\/direction\textbackslash{}n');else fprintf(fid,'periodic\-Z\-:no\%\%not periodic in z-\/direction\textbackslash{}n');endif(handles.\-mode\-Num==1)$\vert$$\vert$(handles.\-mode\-Num==2) fprintf(fid,'\textbackslash{}n\%\%\-Scanning window\textbackslash{}n');fprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n\textbackslash{}n');fprintf(fid,'scan\-\_\-x\-\_\-start\-:\%f\%\%\-X position of top left corner of scan window\textbackslash{}n', handles.\-Xstart);fprintf(fid,'scan\-\_\-x\-\_\-stop\-:\%f\%\%\-X position of bottom right corner of scan window\textbackslash{}n', handles.\-Xstop);fprintf(fid,'scan\-\_\-x\-\_\-pixels\-:\%d\%\%number of pixels in X-\/direction\textbackslash{}n', handles.\-Xpixels);fprintf(fid,'scan\-\_\-y\-\_\-start\-:\%f\textbackslash{}n', handles.\-Ystart);fprintf(fid,'scan\-\_\-y\-\_\-stop\-:\%f\textbackslash{}n', handles.\-Ystop);fprintf(fid,'scan\-\_\-y\-\_\-pixels\-:\%d\textbackslash{}n', handles.\-Ypixels);endif handles.\-mode\-Num==1 fprintf(fid,'\textbackslash{}n\%\%\-S\-T\-E\-M detectors\textbackslash{}n');fprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n');fprintf(fid,'\%\%syntax\-:r\-Inside r\-Outside name(name will be used to store images under)\textbackslash{}n\textbackslash{}n');for jd=1\-:size(handles.\-Detectors, 1) fprintf(fid,'detector\-:\%f\%f detector\%d\%f\%f\textbackslash{}n', handles.\-Detectors(jd, 1), handles.\-Detectors(jd, 2), jd,...\-handles.\-Detectors(jd, 3), handles.\-Detectors(jd, 4));endendfprintf(fid,'\textbackslash{}n\%\%\-Geometrical properties\textbackslash{}n');fprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n\textbackslash{}n');fprintf(fid,'\-Crystal tilt X\-:\%f\%\%tilt in rad\textbackslash{}n', handles.\-Tilt\-X);fprintf(fid,'\-Crystal tilt Y\-:\%f\textbackslash{}n', handles.\-Tilt\-Y);fprintf(fid,'\-Crystal tilt Z\-:\%f\textbackslash{}n', handles.\-Tilt\-Z);fprintf(fid,'\-Beam tilt X\-:\%f deg\%\%beam tilt deg\textbackslash{}n', handles.\-Beam\-Tilt\-X);fprintf(fid,'\-Beam tilt Y\-:\%f deg\textbackslash{}n', handles.\-Beam\-Tilt\-Y);if(handles.\-Tilt\-Back) fprintf(fid,'\-Tilt back\-:yes\textbackslash{}n');else fprintf(fid,'\-Tilt back\-:no\textbackslash{}n');end\%model confined in box\-:\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%ax=160.\-146\-A, by=53.\-8081\-A, cz=189.\-059\-Aswitch handles.\-mode\-Num case 2 fprintf(fid,'\textbackslash{}n\%\%\-C\-B\-E\-D probe parameters\textbackslash{}n');case 1 fprintf(fid,'\textbackslash{}n\%\%\-S\-T\-E\-M probe parameters\textbackslash{}n');case 0 fprintf(fid,'\textbackslash{}n\%\%\-T\-E\-M imaging parameters\textbackslash{}n');endfprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n\textbackslash{}n');fprintf(fid,'nx\-:\%d\%\%array size used for probe\textbackslash{}n', handles.\-Probe\-Nx);fprintf(fid,'ny\-:\%d\%\%ny=nx, if not specified\textbackslash{}n', handles.\-Probe\-Ny);fprintf(fid,'\-Cs\-:\%f\%\%\-Spherical abberation in mm\textbackslash{}n', handles.\-C3);if$\sim$isfield(handles,'\-C5') handles.\-C5=0;endfprintf(fid,'\-C5\-:\%f\%\%\-C\-\_\-5 abberation in mm\textbackslash{}n', handles.\-C5);fprintf(fid,'\-Cc\-:\%f\%\%\-Chromatic abberation in mm\textbackslash{}n', handles.\-Cc);fprintf(fid,'d\-V/\-V\-:\%f\%\%energy spread in e\-V(\-F\-W\-H\-M)\textbackslash{}n', 1e-\/3 $\ast$handles.\-d\-E/handles.\-High\-Voltage);fprintf(fid,'alpha\-:\%f\%\%\-Illumination angle in mrad\textbackslash{}n', handles.\-alpha);fprintf(fid,'defocus\-:\%f\textbackslash{}n', handles.\-Defocus);fprintf(fid,'astigmatism\-:\%f\textbackslash{}n', handles.\-Astig\-Mag);fprintf(fid,'astigmatism angle\-:\%f\textbackslash{}n', handles.\-Astig\-Angle);\%\-Write all the other aberrations as well\-:for ix=3\-:6 for iy=1\-:6 if abs(handles.\-a(ix, iy)) $>$ \hyperlink{write_fields2_file_8m_a153557e925ab11207d6e17eefc1d65db}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'a\-\_\-\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%d\-:\%f\textbackslash{}n', \hyperlink{_display_model_properties_8m_a76b405b72b88bde9488209ac06ddb714}{ix}, \hyperlink{_display_model_properties_8m_af4c5cec9fce175f73b7da5ecd33c2af6}{iy}, \hyperlink{image_sim_8m_aa9c57d86c53f86ed6afc6339a0476363}{handles.\-a}(\hyperlink{_display_model_properties_8m_a76b405b72b88bde9488209ac06ddb714}{ix}, \hyperlink{_display_model_properties_8m_af4c5cec9fce175f73b7da5ecd33c2af6}{iy}))
\item 
\hyperlink{write_fields2_file_8m_a3e67bf2b890464bdaa205cfb867b90c1}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'phi\-\_\-\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%d\-:\%f\textbackslash{}n', \hyperlink{_display_model_properties_8m_a76b405b72b88bde9488209ac06ddb714}{ix}, \hyperlink{_display_model_properties_8m_af4c5cec9fce175f73b7da5ecd33c2af6}{iy}, 180/pi $\ast$\hyperlink{image_sim_8m_a06cb4ec95553375c06ca596fe1352937}{handles.\-phi}(\hyperlink{_display_model_properties_8m_a76b405b72b88bde9488209ac06ddb714}{ix}, \hyperlink{_display_model_properties_8m_af4c5cec9fce175f73b7da5ecd33c2af6}{iy}))
\item 
\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{write_fields2_file_8m_af10e7b30331e8812f3ad46d69908e931}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\textbackslash{}n\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_aabc03523e1c070e4c8510803bff95bce}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'Source Size(diameter)\-:0\%\%source \hyperlink{qmb_8m_a34efcbeb95e7c3e7e0050034d30c01cd}{size} \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} A\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a605530845fe43a82495bc623d874d659}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'beam current\-:1\%\%beam current \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} p\-A(default\-:1)\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a5d4260f8936f5ec925005320af50fe82}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'dwell time\-:1.\-6021773e-\/4\%\%dwell \hyperlink{qmb_8m_ab9b4db1a30bf6ecb9f97291227b98b79}{time} \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} msec(default\-:1)\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a43f511ec8224f5628321d5076ce131e2}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'smooth\-:yes\%\%smoothen edge of probe \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} rec.\-space\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a114e7bb0ca33adb9fda9df49fcbb472f}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'gaussian\-:no\%Apply gaussian smoothing \hyperlink{image_sim_8m_a454532bd4d96c4531eb16b4052fefbe4}{on} \hyperlink{stemtypes__fftw3_8hpp_a26fa01bb4b36ffed75910f878e99cadc}{C\-B\-E\-D} probe\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_acb86cdcb8bc76c57fe8ef807771a7c0b}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\textbackslash{}n\%\%Parameters for potential calculation\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_af884e0cdce4d917ccf68360c5b56b083}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'potential3\-D\-:yes\%\%\hyperlink{showimage_8m_ac1b7f512a0fa5c0b7d1d056a07969aa2}{use} 3\-D or 2\-D potential(3\-D realistically simulates z-\/motion of atoms)\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_abef69fc3e1264b13a4c9329db8f864f0}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\hyperlink{qmb_8m_ad5a54bc5a2abedf790cf00f7c63f6235}{atom} radius\-:\%.\-1f\%\%radius used for calculation of proj potential V\-\_\-proj(r)\textbackslash{}n', handles.\-atom\-Radius)
\item 
\hyperlink{write_fields2_file_8m_aa36bc48b57a09930d909b1d26fd2d70c}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\hyperlink{sim_image_from_wave_8m_a3341a2f8b0a2b23e6ee1c562cf5a0cc1}{plot} V(\hyperlink{_read_d_m3___matlab_8m_a514f1b439f404f86f77090fa9edc96ce}{r})$\ast$r\-:no\%\%will create \hyperlink{image_sim_8m_aa9c57d86c53f86ed6afc6339a0476363}{a} \hyperlink{sim_image_from_wave_8m_a3341a2f8b0a2b23e6ee1c562cf5a0cc1}{plot} for V\-\_\-proj(\hyperlink{_read_d_m3___matlab_8m_a514f1b439f404f86f77090fa9edc96ce}{r})$\ast$\hyperlink{_read_d_m3___matlab_8m_a514f1b439f404f86f77090fa9edc96ce}{r} \hyperlink{_read_d_m3___matlab_8m_a514f1b439f404f86f77090fa9edc96ce}{vs.\-r} for all slices and 1st atom\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a6f8c18192967ca345d73828617394912}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'bandlimit f\-\_\-trans\-:no\%\%indicate whether to band limit transmission \hyperlink{showimage_8m_aa70d913bbaaadbcc10dbf2f8f2416e1c}{function} or not\textbackslash{}n')
\item 
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles} \hyperlink{qstem_8m_a2627b1fe484f7e86e38deba8dabb27ed}{save\-Potential} \hyperlink{write_fields2_file_8m_a38fd10f1fe7b2472c0c7c3caec653bba}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'save potential\-:yes\%\%whether we want to save the projected potential \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} files\textbackslash{}n')
\item 
\hyperlink{qmb_8m_a2d9568f50e74214c48513c91bf8f143a}{else} \hyperlink{write_fields2_file_8m_aaa240b56974b1c7775f5d846c045ebf4}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'save potential\-:no\%\%whether we want to save the projected potential \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} files\textbackslash{}n')
\item 
\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles} \hyperlink{qstem_8m_ab6c80af39fbd1e06e09585d244dc28ce}{save\-Total\-Potential} \hyperlink{write_fields2_file_8m_a38f489c4541f884eca6be3f03c822751}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'save projected potential\-:yes\%\%whether we want to save the total projected potential\textbackslash{}n')
\item 
\hyperlink{qmb_8m_a2d9568f50e74214c48513c91bf8f143a}{else} \hyperlink{write_fields2_file_8m_a0a7ab87fc27072a80fbb75e945896b6f}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'save projected potential\-:no\%\%whether we want to save the total projected potential\textbackslash{}n')
\item 
\hyperlink{scale_s_t_e_m_image_8m_a201589b538fc56729422d4773c8b0cfe}{end} \hyperlink{write_fields2_file_8m_a68e30a1071e75f9ab6a634e93b23a0dc}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'one \hyperlink{qmb_8m_ab9b4db1a30bf6ecb9f97291227b98b79}{time} integration\-:yes\%\%calculate V\-\_\-proj once and then copy(much faster)\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a18876154c3d6326876cf21cc327e8239}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'\hyperlink{qmb_8m_ad589399858397b7c05877f34c359ed55}{Display} Gamma\-:0\%\%Gamma \hyperlink{read_config_file_8m_afcc7a4b78ecd8fa7e713f8cfa0f51017}{value} for \hyperlink{image_sim_8m_afae9c1ba68a4a4b4cbdc4b36f2e0afe6}{image} scaling(0=logarithmic)\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_aa3362773680d14bffd32f8f4665f98ca}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'Folder\-:\char`\"{}\%s\char`\"{}\textbackslash{}n', handles.\-Output\-Folder)
\item 
\hyperlink{write_fields2_file_8m_aa34f573e17738fa24c5e439a41ab0287}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'Runs for averaging\-:\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%\%averaging over\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d} images for T\-D\-S simulation\textbackslash{}n',...handles.\-T\-D\-Sruns, handles.\-T\-D\-Sruns)
\item 
\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'Structure Factors\-:\-W\-K\textbackslash{}n' \hyperlink{write_fields2_file_8m_aac7b888da3c215f89c81679d1977afe4}{fprintf} ()
\item 
\hyperlink{write_fields2_file_8m_a623ce6ef7aee46ea2405ff1cf5e225fb}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'show Probe\-:no\%\%displays \hyperlink{image_sim_8m_aa9c57d86c53f86ed6afc6339a0476363}{a} graph of the crosssection of the inc.\-e-\/beam\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a2e85e1c6cccae769dfb1ddbaf4df7a0d}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'propagation progress interval\-:\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%\%show progress every N\-\_\-prop\-\_\-prog beam positions\textbackslash{}n', \hyperlink{qstem_8m_a05446d3838f219de184194c1dca0dc0e}{handles.\-prop\-Prog\-Interval})
\item 
\hyperlink{write_fields2_file_8m_a35d1ae2981e5d13b3f0103587841e082}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'potential progress interval\-:\%\hyperlink{_read_d_m3___matlab_8m_a1aabac6d068eef6a7bad3fdf50a05cc8}{d}\%\%show progress every N\-\_\-pot\-\_\-prog atoms\textbackslash{}n', \hyperlink{qstem_8m_a286321d6d000730b555812c3c9ae8645}{handles.\-pot\-Prog\-Interval})
\item 
\hyperlink{write_fields2_file_8m_a6fc21d24cfb975209b23f94807254b6d}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'update Web\-:no\%\%put results \hyperlink{image_sim_8m_a454532bd4d96c4531eb16b4052fefbe4}{on} web page\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a659f44d5663a2bb4581f2749601e2c1c}{fprintf} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid},'sequence\-:1 1\textbackslash{}n')
\item 
\hyperlink{write_fields2_file_8m_a5e769bbbabcaddc548203741c7100228}{fclose} (\hyperlink{xyz2cfg_8m_aa2ccff2cba62991c1532b3a4cb80523c}{fid})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{write_fields2_file_8m_a7b9c3d619ad7365ec6434713e76142e8}{fid}
\item 
Now we need to know whether \\*
the cfg file is saved \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} the \\*
same \hyperlink{sim_image_from_wave_8m_aedf03b9517092eee7dae1588bbc00e19}{directory} as the config \hyperlink{write_fields2_file_8m_a75658b9c899229893bf0bc9d90e97d93}{file}
\item 
Now we need to know whether \\*
the cfg \hyperlink{write_fields2_file_8m_a75658b9c899229893bf0bc9d90e97d93}{file} is saved \hyperlink{_displacement_params_8m_abae9a3ce1348fc8b6ab1330584bd5bea}{in} the \\*
same \hyperlink{sim_image_from_wave_8m_aedf03b9517092eee7dae1588bbc00e19}{directory} as the config \hyperlink{write_fields2_file_8m_a214a58d5e93b2df6f2c1242de633e92d}{pos\-Name} = \hyperlink{qmb_8m_a3f5148a2cb27e0bbf68da5bed91b82e0}{fileparts}(\hyperlink{write_fields2_file_8m_a62237b40e0bf78587fcc5d0e6cf4ce8b}{handles.\-pos\-File\-Name})
\item 
\hyperlink{write_fields2_file_8m_acb640f59b6e17119f3af32eb9f911d59}{cfg\-Path}
\item 
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{write_fields2_file_8m_af3723aa817dbb65282d5e1db81f08ad8}{filename}
\item 
\hyperlink{virtual_goniometer_8m_a4dc2538540fbdf026d9a93aec8af9423}{if} \hyperlink{scale_s_t_e_m_image_8m_a7cfce9e4244a1936557979efaaa3882a}{handles} \hyperlink{write_fields2_file_8m_a62237b40e0bf78587fcc5d0e6cf4ce8b}{pos\-File\-Name}
\item 
Multislice \hyperlink{write_fields2_file_8m_aa3839127fd474e7ce063aa98e8eb4bc8}{procedure}
\item 
Multislice Pendelloesung \hyperlink{write_fields2_file_8m_a5721db6a5476fc84e41a010cccaae846}{plot}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{write_fields2_file_8m_a5e769bbbabcaddc548203741c7100228}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fclose@{fclose}}
\index{fclose@{fclose}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fclose}]{\setlength{\rightskip}{0pt plus 5cm}fclose (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a5e769bbbabcaddc548203741c7100228}
\hypertarget{write_fields2_file_8m_a33cb655be2efe92f3ccc934075162b3a}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf return} {\bf end} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a33cb655be2efe92f3ccc934075162b3a}
\hypertarget{write_fields2_file_8m_af801c33848ca382739f11125cc8bf485}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'\%\%{\bf S\-T\-E\-M} configuration {\bf file} generated by qstem\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_af801c33848ca382739f11125cc8bf485}
\hypertarget{write_fields2_file_8m_ae5ccf64abc5b28d25d428d8c8394c6e0}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\textbackslash{}n\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_ae5ccf64abc5b28d25d428d8c8394c6e0}
\hypertarget{write_fields2_file_8m_a792ade792b76a3a87e61853b7589acd6}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf switch} {\bf handles} {\bf mode\-Num} {\bf case} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'mode\-:\-C\-B\-E\-D\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a792ade792b76a3a87e61853b7589acd6}
\hypertarget{write_fields2_file_8m_af3da4e84e910e09e0ad8ecc7a7b35350}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf case} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'mode\-:\-S\-T\-E\-M\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_af3da4e84e910e09e0ad8ecc7a7b35350}
\hypertarget{write_fields2_file_8m_a5b4339af933d1454537ca5a1d7a223ce}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf case} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'mode\-:\-T\-E\-M\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a5b4339af933d1454537ca5a1d7a223ce}
\hypertarget{write_fields2_file_8m_a1092f59a6db37358a9c28d10bd1af47d}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'print level\-:\%{\bf d}\%\%indicates how much {\bf information} {\bf in} output\textbackslash{}n'}]{, }
\item[{handles.}]{print\-Level}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a1092f59a6db37358a9c28d10bd1af47d}
\hypertarget{write_fields2_file_8m_a71ff71561cd7cbb4ed69826b39d691df}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'save level\-:\%{\bf d}\%\%indicates how much {\bf information} shall be saved\textbackslash{}n'}]{, }
\item[{handles.}]{save\-Level}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a71ff71561cd7cbb4ed69826b39d691df}
\hypertarget{write_fields2_file_8m_a8c90de0f7ac5f0547376cd364c04d553}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf else} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'filename\-:\%s\textbackslash{}n'}]{, }
\item[{handles.}]{pos\-File\-Namefirst\-Char(end)+1\-:end}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a8c90de0f7ac5f0547376cd364c04d553}
\hypertarget{write_fields2_file_8m_a92dec9ceb893c03171473b367a7b7894}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} {\bf else} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'filename\-:\char`\"{}\%s\char`\"{}\textbackslash{}n'}]{, }
\item[{handles.}]{pos\-File\-Name}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a92dec9ceb893c03171473b367a7b7894}
\hypertarget{write_fields2_file_8m_a7d7265d399df662c370c9472752e53c1}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'resolution\-X\-:\%f\textbackslash{}n'}]{, }
\item[{handles.}]{Probe\-Resolution\-X}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a7d7265d399df662c370c9472752e53c1}
\hypertarget{write_fields2_file_8m_aed7026e2b386e492508c53aa9e59fea5}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'resolution\-Y\-:\%f\textbackslash{}n'}]{, }
\item[{handles.}]{Probe\-Resolution\-Y}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aed7026e2b386e492508c53aa9e59fea5}
\hypertarget{write_fields2_file_8m_a8e7d79e4756d233b35680c5cdd931437}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'N\-C\-E\-L\-L\-X\-:\%d\textbackslash{}n'}]{, }
\item[{handles.}]{Ncell\-X}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a8e7d79e4756d233b35680c5cdd931437}
\hypertarget{write_fields2_file_8m_a4adf462d6b74790229eb04dd7968b9b9}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'N\-C\-E\-L\-L\-Y\-:\%d\textbackslash{}n'}]{, }
\item[{handles.}]{Ncell\-Y}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a4adf462d6b74790229eb04dd7968b9b9}
\hypertarget{write_fields2_file_8m_a153557e925ab11207d6e17eefc1d65db}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} {\bf handles} Nsub\-Slabs$<$= 1 fprintf({\bf fid},'N\-C\-E\-L\-L\-Z\-: \%d\textbackslash{}n',handles.\-Ncell\-Z);{\bf else} fprintf({\bf fid},'N\-C\-E\-L\-L\-Z\-: \%{\bf d}/\%d\textbackslash{}n',handles.\-Ncell\-Z,handles.\-Nsub\-Slabs); {\bf end}\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\% Box confinement\-:if {\bf isfield}({\bf handles},'radiobutton\-\_\-\-Box') {\bf if} {\bf get}(handles.\-radiobutton\-\_\-\-Box,'{\bf Value}') fprintf({\bf fid},'Cube\-: \%.\-3f \%.\-3f \%.\-3f\textbackslash{}n',handles.\-Box\-X,handles.\-Box\-Y,handles.\-Box\-Z); endelse if handles.\-Box\-Mode fprintf(fid,'\-Cube\-: \%.\-3f \%.\-3f \%.\-3f\textbackslash{}n',handles.\-Box\-X,handles.\-Box\-Y,handles.\-Box\-Z); endendfprintf(fid,'v0\-: \%f \%\% beam energy\textbackslash{}n',handles.\-High\-Voltage);if isfield(handles,'checkbox\-\_\-\-T\-D\-S') handles.\-T\-D\-S = get(handles.\-checkbox\-\_\-\-T\-D\-S,'\-Value');end\% fprintf('\-T\-D\-S is set to \%d\textbackslash{}n',handles.\-T\-D\-S);if handles.\-T\-D\-S == 1 fprintf(fid,'tds\-: yes \%\% include thermal diffuse scattering\textbackslash{}n');else fprintf(fid,'tds\-: no \%\% do N\-O\-T include thermal diffuse scattering\textbackslash{}n');end fprintf(fid,'temperature\-: \%f \%\% temperature in Kelvin \textbackslash{}n',handles.\-Temperature);fprintf(fid,'slice-\/thickness\-: \%f \%\% slice thckness in A\textbackslash{}n',handles.\-Slice\-Thickness);fprintf(fid,'slices\-: \%d \%\% number of different slices per slab in z-\/direction\textbackslash{}n',handles.\-Nslice);if handles.\-Center\-Slices fprintf(fid,'center slices\-: yes \%\% center slices\textbackslash{}n');else fprintf(fid,'center slices\-: no \%\% do not center slices\textbackslash{}n'); endfprintf(fid,'slices between outputs\-: \%d \%\% give intermediate results after every \%d slices\textbackslash{}n',... handles.\-Slices\-Between\-Outputs,handles.\-Slices\-Between\-Outputs);fprintf(fid,'x\-Offset\-: \%f \%\% x-\/position offset in cartesian coords \textbackslash{}n',handles.\-Potential\-Offset\-X);fprintf(fid,'y\-Offset\-: \%f \%\% y-\/position offset in cartesian coords \textbackslash{}n',handles.\-Potential\-Offset\-Y);fprintf(fid,'z\-Offset\-: \%f \%\% slize z-\/position offset in cartesian coords \textbackslash{}n',handles.\-Potential\-Offset\-Z);if handles.\-Periodic\-X\-Y fprintf(fid,'periodic\-X\-Y\-: yes \%\% periodic in x-\/ and y-\/direction\textbackslash{}n');else fprintf(fid,'periodic\-X\-Y\-: no \%\% not periodic in x-\/ and y-\/direction\textbackslash{}n');endif handles.\-Periodic\-Z fprintf(fid,'periodic\-Z\-: yes \%\% periodic in z-\/direction\textbackslash{}n');else fprintf(fid,'periodic\-Z\-: no \%\% not periodic in z-\/direction\textbackslash{}n');endif (handles.\-mode\-Num == 1) $\vert$$\vert$ (handles.\-mode\-Num == 2) fprintf(fid,'\textbackslash{}n\%\% Scanning window \textbackslash{}n'); fprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\% \textbackslash{}n\textbackslash{}n'); fprintf(fid,'scan\-\_\-x\-\_\-start\-: \%f \%\% X position of top left corner of scan window \textbackslash{}n',handles.\-Xstart); fprintf(fid,'scan\-\_\-x\-\_\-stop\-: \%f \%\% X position of bottom right corner of scan window \textbackslash{}n',handles.\-Xstop); fprintf(fid,'scan\-\_\-x\-\_\-pixels\-: \%d \%\% number of pixels in X-\/direction \textbackslash{}n',handles.\-Xpixels); fprintf(fid,'scan\-\_\-y\-\_\-start\-: \%f \textbackslash{}n',handles.\-Ystart); fprintf(fid,'scan\-\_\-y\-\_\-stop\-: \%f \textbackslash{}n',handles.\-Ystop); fprintf(fid,'scan\-\_\-y\-\_\-pixels\-: \%d \textbackslash{}n',handles.\-Ypixels);endif handles.\-mode\-Num == 1 fprintf(fid,'\textbackslash{}n\%\% S\-T\-E\-M detectors \textbackslash{}n'); fprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\% \textbackslash{}n'); fprintf(fid,'\%\% syntax\-: r\-Inside r\-Outside name (name will be used to store images under) \textbackslash{}n\textbackslash{}n'); for jd = 1\-:size(handles.\-Detectors,1) fprintf(fid,'detector\-: \%f \%f detector\%d \%f \%f\textbackslash{}n',handles.\-Detectors(jd,1),handles.\-Detectors(jd,2),jd,... handles.\-Detectors(jd,3),handles.\-Detectors(jd,4)); endendfprintf(fid,'\textbackslash{}n\%\% Geometrical properties \textbackslash{}n');fprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\% \textbackslash{}n\textbackslash{}n');fprintf(fid,'\-Crystal tilt X\-: \%f \%\% tilt in rad \textbackslash{}n',handles.\-Tilt\-X);fprintf(fid,'\-Crystal tilt Y\-: \%f \textbackslash{}n',handles.\-Tilt\-Y);fprintf(fid,'\-Crystal tilt Z\-: \%f \textbackslash{}n',handles.\-Tilt\-Z);fprintf(fid,'\-Beam tilt X\-: \%f deg \%\% beam tilt deg \textbackslash{}n',handles.\-Beam\-Tilt\-X);fprintf(fid,'\-Beam tilt Y\-: \%f deg \textbackslash{}n',handles.\-Beam\-Tilt\-Y);if (handles.\-Tilt\-Back) fprintf(fid,'\-Tilt back\-: yes \textbackslash{}n');else fprintf(fid,'\-Tilt back\-: no \textbackslash{}n'); end\% model confined in box\-:\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\% ax=160.\-146\-A, by=53.\-8081\-A, cz=189.\-059\-Aswitch handles.\-mode\-Num case 2 fprintf(fid,'\textbackslash{}n\%\% C\-B\-E\-D probe parameters \textbackslash{}n'); case 1 fprintf(fid,'\textbackslash{}n\%\% S\-T\-E\-M probe parameters \textbackslash{}n'); case 0 fprintf(fid,'\textbackslash{}n\%\% T\-E\-M imaging parameters \textbackslash{}n'); endfprintf(fid,'\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\% \textbackslash{}n\textbackslash{}n');fprintf(fid,'nx\-: \%d \%\% array size used for probe \textbackslash{}n',handles.\-Probe\-Nx);fprintf(fid,'ny\-: \%d \%\% ny = nx, if not specified\textbackslash{}n',handles.\-Probe\-Ny);fprintf(fid,'\-Cs\-: \%f \%\% Spherical abberation in mm\textbackslash{}n',handles.\-C3);if $\sim$isfield(handles,'\-C5') handles.\-C5 = 0;endfprintf(fid,'\-C5\-: \%f \%\% C\-\_\-5 abberation in mm\textbackslash{}n',handles.\-C5); fprintf(fid,'\-Cc\-: \%f \%\% Chromatic abberation in mm\textbackslash{}n',handles.\-Cc);fprintf(fid,'d\-V/\-V\-: \%f \%\% energy spread in e\-V (\-F\-W\-H\-M)\textbackslash{}n',1e-\/3$\ast$handles.\-d\-E/handles.\-High\-Voltage);fprintf(fid,'alpha\-: \%f \%\% Illumination angle in mrad\textbackslash{}n',handles.\-alpha);fprintf(fid,'defocus\-: \%f \textbackslash{}n',handles.\-Defocus); fprintf(fid,'astigmatism\-: \%f \textbackslash{}n',handles.\-Astig\-Mag); fprintf(fid,'astigmatism angle\-: \%f \textbackslash{}n',handles.\-Astig\-Angle); \% Write all the other aberrations as well\-:for ix=3\-:6 for iy=1\-:6 if abs(handles.\-a(ix,iy)) $>$ fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'a\-\_\-\%{\bf d}\%d\-:\%f\textbackslash{}n'}]{, }
\item[{{\bf ix}}]{, }
\item[{{\bf iy}}]{, }
\item[{handles.}]{aix, iy}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a153557e925ab11207d6e17eefc1d65db}
\hypertarget{write_fields2_file_8m_a3e67bf2b890464bdaa205cfb867b90c1}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'phi\-\_\-\%{\bf d}\%d\-:\%f\textbackslash{}n'}]{, }
\item[{{\bf ix}}]{, }
\item[{{\bf iy}}]{, }
\item[{180/pi $\ast$handles.}]{phiix, iy}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a3e67bf2b890464bdaa205cfb867b90c1}
\hypertarget{write_fields2_file_8m_af10e7b30331e8812f3ad46d69908e931}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} {\bf end} {\bf end} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'\textbackslash{}n\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_af10e7b30331e8812f3ad46d69908e931}
\hypertarget{write_fields2_file_8m_aabc03523e1c070e4c8510803bff95bce}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'Source Size(diameter)\-:0\%\%source {\bf size} {\bf in} A\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aabc03523e1c070e4c8510803bff95bce}
\hypertarget{write_fields2_file_8m_a605530845fe43a82495bc623d874d659}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'beam current\-:1\%\%beam current {\bf in} p\-A(default\-:1)\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a605530845fe43a82495bc623d874d659}
\hypertarget{write_fields2_file_8m_a5d4260f8936f5ec925005320af50fe82}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'dwell time\-:1.\-6021773e-\/4\%\%dwell {\bf time} {\bf in} msec(default\-:1)\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a5d4260f8936f5ec925005320af50fe82}
\hypertarget{write_fields2_file_8m_a43f511ec8224f5628321d5076ce131e2}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'smooth\-:yes\%\%smoothen edge of probe {\bf in} rec.\-space\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a43f511ec8224f5628321d5076ce131e2}
\hypertarget{write_fields2_file_8m_a114e7bb0ca33adb9fda9df49fcbb472f}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'gaussian\-:no\%Apply gaussian smoothing {\bf on} {\bf C\-B\-E\-D} probe\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a114e7bb0ca33adb9fda9df49fcbb472f}
\hypertarget{write_fields2_file_8m_acb86cdcb8bc76c57fe8ef807771a7c0b}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'\textbackslash{}n\%\%Parameters for potential calculation\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_acb86cdcb8bc76c57fe8ef807771a7c0b}
\hypertarget{write_fields2_file_8m_af884e0cdce4d917ccf68360c5b56b083}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'potential3\-D\-:yes\%\%{\bf use} 3\-D or 2\-D potential(3\-D realistically simulates z-\/motion of atoms)\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_af884e0cdce4d917ccf68360c5b56b083}
\hypertarget{write_fields2_file_8m_abef69fc3e1264b13a4c9329db8f864f0}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'{\bf atom} radius\-:\%.\-1f\%\%radius used for calculation of proj potential V\-\_\-proj(r)\textbackslash{}n'}]{, }
\item[{handles.}]{atom\-Radius}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_abef69fc3e1264b13a4c9329db8f864f0}
\hypertarget{write_fields2_file_8m_aa36bc48b57a09930d909b1d26fd2d70c}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'{\bf plot} V({\bf r})$\ast$r\-:no\%\%will create {\bf a} {\bf plot} for V\-\_\-proj({\bf r})$\ast${\bf r} {\bf vs.\-r} for all slices and 1st atom\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aa36bc48b57a09930d909b1d26fd2d70c}
\hypertarget{write_fields2_file_8m_a6f8c18192967ca345d73828617394912}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'bandlimit f\-\_\-trans\-:no\%\%indicate whether to band limit transmission {\bf function} or not\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a6f8c18192967ca345d73828617394912}
\hypertarget{write_fields2_file_8m_a38fd10f1fe7b2472c0c7c3caec653bba}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} {\bf handles} {\bf save\-Potential} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'save potential\-:yes\%\%whether we want to save the projected potential {\bf in} files\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a38fd10f1fe7b2472c0c7c3caec653bba}
\hypertarget{write_fields2_file_8m_aaa240b56974b1c7775f5d846c045ebf4}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf else} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'save potential\-:no\%\%whether we want to save the projected potential {\bf in} files\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aaa240b56974b1c7775f5d846c045ebf4}
\hypertarget{write_fields2_file_8m_a38f489c4541f884eca6be3f03c822751}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} {\bf if} {\bf handles} {\bf save\-Total\-Potential} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'save projected potential\-:yes\%\%whether we want to save the total projected potential\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a38f489c4541f884eca6be3f03c822751}
\hypertarget{write_fields2_file_8m_a0a7ab87fc27072a80fbb75e945896b6f}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf else} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'save projected potential\-:no\%\%whether we want to save the total projected potential\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a0a7ab87fc27072a80fbb75e945896b6f}
\hypertarget{write_fields2_file_8m_a68e30a1071e75f9ab6a634e93b23a0dc}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf end} fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'one {\bf time} integration\-:yes\%\%calculate V\-\_\-proj once and then copy(much faster)\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a68e30a1071e75f9ab6a634e93b23a0dc}
\hypertarget{write_fields2_file_8m_a18876154c3d6326876cf21cc327e8239}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'{\bf Display} Gamma\-:0\%\%Gamma {\bf value} for {\bf image} scaling(0=logarithmic)\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a18876154c3d6326876cf21cc327e8239}
\hypertarget{write_fields2_file_8m_aa3362773680d14bffd32f8f4665f98ca}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'Folder\-:\char`\"{}\%s\char`\"{}\textbackslash{}n'}]{, }
\item[{handles.}]{Output\-Folder}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aa3362773680d14bffd32f8f4665f98ca}
\hypertarget{write_fields2_file_8m_aa34f573e17738fa24c5e439a41ab0287}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'Runs for averaging\-:\%{\bf d}\%\%averaging over\%{\bf d} images for T\-D\-S simulation\textbackslash{}n'}]{, }
\item[{...handles.}]{T\-D\-Sruns, }
\item[{handles.}]{T\-D\-Sruns}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aa34f573e17738fa24c5e439a41ab0287}
\hypertarget{write_fields2_file_8m_aac7b888da3c215f89c81679d1977afe4}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}{\bf fid},'Structure Factors\-: W\-K\textbackslash{}n' fprintf (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{write_fields2_file_8m_aac7b888da3c215f89c81679d1977afe4}
\hypertarget{write_fields2_file_8m_a623ce6ef7aee46ea2405ff1cf5e225fb}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'show Probe\-:no\%\%displays {\bf a} graph of the crosssection of the inc.\-e-\/beam\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a623ce6ef7aee46ea2405ff1cf5e225fb}
\hypertarget{write_fields2_file_8m_a2e85e1c6cccae769dfb1ddbaf4df7a0d}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'propagation progress interval\-:\%{\bf d}\%\%show progress every N\-\_\-prop\-\_\-prog beam positions\textbackslash{}n'}]{, }
\item[{handles.}]{prop\-Prog\-Interval}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a2e85e1c6cccae769dfb1ddbaf4df7a0d}
\hypertarget{write_fields2_file_8m_a35d1ae2981e5d13b3f0103587841e082}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'potential progress interval\-:\%{\bf d}\%\%show progress every N\-\_\-pot\-\_\-prog atoms\textbackslash{}n'}]{, }
\item[{handles.}]{pot\-Prog\-Interval}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a35d1ae2981e5d13b3f0103587841e082}
\hypertarget{write_fields2_file_8m_a6fc21d24cfb975209b23f94807254b6d}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'update Web\-:no\%\%put results {\bf on} web page\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a6fc21d24cfb975209b23f94807254b6d}
\hypertarget{write_fields2_file_8m_a659f44d5663a2bb4581f2749601e2c1c}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fprintf@{fprintf}}
\index{fprintf@{fprintf}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fprintf}]{\setlength{\rightskip}{0pt plus 5cm}fprintf (
\begin{DoxyParamCaption}
\item[{{\bf fid}}]{, }
\item[{'sequence\-:1 1\textbackslash{}n'}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a659f44d5663a2bb4581f2749601e2c1c}
\hypertarget{write_fields2_file_8m_aff5839ae6f09c1d39ab26468374a5357}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!isempty@{isempty}}
\index{isempty@{isempty}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{isempty}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} isempty (
\begin{DoxyParamCaption}
\item[{first\-Char}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_aff5839ae6f09c1d39ab26468374a5357}
\hypertarget{write_fields2_file_8m_a998c38403f8a2f5e6759fe4e7866f6f1}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!strcmp@{strcmp}}
\index{strcmp@{strcmp}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{strcmp}]{\setlength{\rightskip}{0pt plus 5cm}strcmp (
\begin{DoxyParamCaption}
\item[{pos\-Path}]{, }
\item[{{\bf cfg\-Path}}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a998c38403f8a2f5e6759fe4e7866f6f1}
\hypertarget{write_fields2_file_8m_a79499b523dd8dff45cb559e070ca9b60}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!write\-Fields2\-File@{write\-Fields2\-File}}
\index{write\-Fields2\-File@{write\-Fields2\-File}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{write\-Fields2\-File}]{\setlength{\rightskip}{0pt plus 5cm}{\bf function} write\-Fields2\-File (
\begin{DoxyParamCaption}
\item[{{\bf file\-Name}}]{, }
\item[{{\bf handles}}]{}
\end{DoxyParamCaption}
)}}\label{write_fields2_file_8m_a79499b523dd8dff45cb559e070ca9b60}


\subsection{Variable Documentation}
\hypertarget{write_fields2_file_8m_acb640f59b6e17119f3af32eb9f911d59}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!cfg\-Path@{cfg\-Path}}
\index{cfg\-Path@{cfg\-Path}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{cfg\-Path}]{\setlength{\rightskip}{0pt plus 5cm}cfg\-Path}}\label{write_fields2_file_8m_acb640f59b6e17119f3af32eb9f911d59}
{\bfseries Initial value\-:}
\begin{DoxyCode}
== 1
    firstChar = findstr(\hyperlink{aberrations___t_e_m_8m_a7cfce9e4244a1936557979efaaa3882a}{handles}.posFileName,\textcolor{charliteral}{'\(\backslash\)'})
\end{DoxyCode}


Definition at line 29 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_a7b9c3d619ad7365ec6434713e76142e8}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!fid@{fid}}
\index{fid@{fid}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{fid}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} fid}}\label{write_fields2_file_8m_a7b9c3d619ad7365ec6434713e76142e8}
{\bfseries Initial value\-:}
\begin{DoxyCode}
== -1
    \hyperlink{convert2cfg_8m_adaf2296b0af0af8d6d31aa11f288b107}{msgbox}(\hyperlink{aberrations_8m_a9d64efc26f20183fa57b389757578c0c}{sprintf}('Could not \hyperlink{_read_d_m3___matlab_8m_aa8ef7bba54ee37a8beab56f5091c552f}{open} \hyperlink{write_fields2_file_8m_a75658b9c899229893bf0bc9d90e97d93}{file} %\hyperlink{aberrations___t_e_m_8m_aef29541a06b7f933d32a804307db13af}{s}!',\hyperlink{binwrite2_d_8m_a7a230f02bdffebd1357e3c0b49e01271}{fileName}))
\end{DoxyCode}


Definition at line 4 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_a75658b9c899229893bf0bc9d90e97d93}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!file@{file}}
\index{file@{file}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{file}]{\setlength{\rightskip}{0pt plus 5cm}Now we need to know whether the cfg file is saved {\bf in} the same {\bf directory} as the config file}}\label{write_fields2_file_8m_a75658b9c899229893bf0bc9d90e97d93}


Definition at line 26 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_af3723aa817dbb65282d5e1db81f08ad8}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!filename@{filename}}
\index{filename@{filename}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{filename}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} filename}}\label{write_fields2_file_8m_af3723aa817dbb65282d5e1db81f08ad8}


Definition at line 32 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_a5721db6a5476fc84e41a010cccaae846}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!plot@{plot}}
\index{plot@{plot}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{plot}]{\setlength{\rightskip}{0pt plus 5cm}Multislice Pendelloesung plot}}\label{write_fields2_file_8m_a5721db6a5476fc84e41a010cccaae846}


Definition at line 205 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_a62237b40e0bf78587fcc5d0e6cf4ce8b}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!pos\-File\-Name@{pos\-File\-Name}}
\index{pos\-File\-Name@{pos\-File\-Name}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{pos\-File\-Name}]{\setlength{\rightskip}{0pt plus 5cm}{\bf if} {\bf handles} pos\-File\-Name}}\label{write_fields2_file_8m_a62237b40e0bf78587fcc5d0e6cf4ce8b}


Definition at line 32 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_a214a58d5e93b2df6f2c1242de633e92d}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!pos\-Name@{pos\-Name}}
\index{pos\-Name@{pos\-Name}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{pos\-Name}]{\setlength{\rightskip}{0pt plus 5cm}Now we need to know whether the cfg {\bf file} is saved {\bf in} the same {\bf directory} as the config pos\-Name = {\bf fileparts}({\bf handles.\-pos\-File\-Name})}}\label{write_fields2_file_8m_a214a58d5e93b2df6f2c1242de633e92d}


Definition at line 26 of file write\-Fields2\-File.\-m.

\hypertarget{write_fields2_file_8m_aa3839127fd474e7ce063aa98e8eb4bc8}{\index{write\-Fields2\-File.\-m@{write\-Fields2\-File.\-m}!procedure@{procedure}}
\index{procedure@{procedure}!writeFields2File.m@{write\-Fields2\-File.\-m}}
\subsubsection[{procedure}]{\setlength{\rightskip}{0pt plus 5cm}Multislice procedure}}\label{write_fields2_file_8m_aa3839127fd474e7ce063aa98e8eb4bc8}


Definition at line 205 of file write\-Fields2\-File.\-m.

